<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>biglovewheat</title>
  
  
  <link href="https://biglovewheat.gihub.io/atom.xml" rel="self"/>
  
  <link href="https://biglovewheat.gihub.io/"/>
  <updated>2023-06-01T23:23:21.742Z</updated>
  <id>https://biglovewheat.gihub.io/</id>
  
  <author>
    <name>biglovewheat</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>SonarQube代码检测工具安装</title>
    <link href="https://biglovewheat.gihub.io/2023/05/30/SonarQube%E4%BB%A3%E7%A0%81%E6%A3%80%E6%B5%8B%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85/"/>
    <id>https://biglovewheat.gihub.io/2023/05/30/SonarQube%E4%BB%A3%E7%A0%81%E6%A3%80%E6%B5%8B%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85/</id>
    <published>2023-05-29T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.742Z</updated>
    
    <content type="html"><![CDATA[<h2 id="SonarQube代码检测工具安装"><a href="#SonarQube代码检测工具安装" class="headerlink" title="SonarQube代码检测工具安装"></a>SonarQube代码检测工具安装</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>SonarQube是一个代码质量和安全分析工具，支持java、python、go、c等30+种语言。<br>SonarQube is a self-managed, automatic code review tool that systematically helps you deliver clean code. As a core element of our Sonar solution, SonarQube integrates into your existing workflow and detects issues in your code to help you perform continuous code inspections of your projects. The tool analyses 30+ different programming languages and integrates into your CI pipeline and DevOps platform to ensure that your code meets high-quality standards.</p><h3 id="安装配置"><a href="#安装配置" class="headerlink" title="安装配置"></a>安装配置</h3><p>下载链接：<br><a href="https://binaries.sonarsource.com/Distribution/sonarqube/sonarqube-9.9.1.69595.zip">https://binaries.sonarsource.com/Distribution/sonarqube/sonarqube-9.9.1.69595.zip</a><br>安装文档：<br><a href="https://docs.sonarqube.org/latest/try-out-sonarqube/">https://docs.sonarqube.org/latest/try-out-sonarqube/</a></p><p>需要java17支持，先安装java17</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 下载安装包</span></span><br><span class="line">wget https://binaries.sonarsource.com/Distribution/sonarqube/sonarqube-9.9.1.69595.zip</span><br><span class="line"></span><br><span class="line"><span class="comment">## 解压</span></span><br><span class="line">unzip sonarqube-9.9.1.69595.zip</span><br><span class="line"></span><br><span class="line"><span class="comment">## 修改默认web端口</span></span><br><span class="line">vim conf/sonar.properties</span><br><span class="line"></span><br><span class="line">sonar.web.port=39000</span><br><span class="line"></span><br><span class="line"><span class="comment">## 默认使用h2本地数据库，可以配置采用外部数据库，支持mysql、pg、oracle</span></span><br></pre></td></tr></table></figure><h3 id="启动和登录"><a href="#启动和登录" class="headerlink" title="启动和登录"></a>启动和登录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">su - sonarqube -c <span class="string">&quot;java -version;/data/sonarqube-9.9.1.69595/bin/linux-x86-64/sonar.sh console&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>启动后登录，默认密码admin&#x2F;admin</p><h3 id="新建gitlab-porject"><a href="#新建gitlab-porject" class="headerlink" title="新建gitlab-porject"></a>新建gitlab-porject</h3><p><img src="/../images/sonar_01.jpg"></p><h3 id="选择分析的方式"><a href="#选择分析的方式" class="headerlink" title="选择分析的方式"></a>选择分析的方式</h3><p>目前支持jenkins&#x2F;gitlab-ci等，这里采用最简单的本地分析<br><img src="/../images/sonar_02.jpg"></p><h3 id="本地运行分析"><a href="#本地运行分析" class="headerlink" title="本地运行分析"></a>本地运行分析</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 在代码下载到本地，并运行此命令即可（这里用的mvn的java项目）</span></span><br><span class="line"></span><br><span class="line">mvn clean verify sonar:sonar \</span><br><span class="line">  -Dsonar.projectKey=jenkins_test0627_AYhHS6JcYC282dGxCGTK \</span><br><span class="line">  -Dsonar.host.url=http://hxkj07:39000 \</span><br><span class="line">  -Dsonar.login=sqp_230323b5e2ba00a211b48cf5d857ba45287ef667</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/../images/sonar_03.jpg"></p><h3 id="返回页面查看结果"><a href="#返回页面查看结果" class="headerlink" title="返回页面查看结果"></a>返回页面查看结果</h3><p>页面可以看到项目的疑似bug，安全漏洞等，点击可以定位到具体代码<br><img src="/../images/sonar_04.jpg"><br><img src="/../images/sonar_05.jpg"></p><h3 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h3><p>配置使用外部数据库（略）</p><p>配置持续集成工具jenkins或gitlab-ci（略）</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;SonarQube代码检测工具安装&quot;&gt;&lt;a href=&quot;#SonarQube代码检测工具安装&quot; class=&quot;headerlink&quot; title=&quot;SonarQube代码检测工具安装&quot;&gt;&lt;/a&gt;SonarQube代码检测工具安装&lt;/h2&gt;&lt;h3 id=&quot;简介&quot;&gt;&lt;</summary>
      
    
    
    
    <category term="测试" scheme="https://biglovewheat.gihub.io/categories/%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="测试" scheme="https://biglovewheat.gihub.io/tags/%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>vscode+python+venv设置</title>
    <link href="https://biglovewheat.gihub.io/2023/05/30/vscode+python+venv%E8%AE%BE%E7%BD%AE/"/>
    <id>https://biglovewheat.gihub.io/2023/05/30/vscode+python+venv%E8%AE%BE%E7%BD%AE/</id>
    <published>2023-05-29T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.742Z</updated>
    
    <content type="html"><![CDATA[<h2 id="vscode-python-venv设置"><a href="#vscode-python-venv设置" class="headerlink" title="vscode+python+venv设置"></a>vscode+python+venv设置</h2><h3 id="安装python"><a href="#安装python" class="headerlink" title="安装python"></a>安装python</h3><p>下载python安装包，右击以管理员运行，记得选添加到path</p><p>pip install virtualenv</p><h3 id="安装vscode"><a href="#安装vscode" class="headerlink" title="安装vscode"></a>安装vscode</h3><p>安装vscode</p><p>安装python插件</p><p>Ctrl+Shift+P 输入 python interpreter 选择python.exe</p><p>Ctrl+Shift+P 输入 python create environment 选择venv</p><h3 id="创建并激活虚拟环境"><a href="#创建并激活虚拟环境" class="headerlink" title="创建并激活虚拟环境"></a>创建并激活虚拟环境</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python -m venv myproject\<span class="built_in">env</span></span><br><span class="line">myprojetc\Scripts\activate</span><br></pre></td></tr></table></figure><p>done</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;vscode-python-venv设置&quot;&gt;&lt;a href=&quot;#vscode-python-venv设置&quot; class=&quot;headerlink&quot; title=&quot;vscode+python+venv设置&quot;&gt;&lt;/a&gt;vscode+python+venv设置&lt;/h2&gt;&lt;</summary>
      
    
    
    
    <category term="python" scheme="https://biglovewheat.gihub.io/categories/python/"/>
    
    
    <category term="python" scheme="https://biglovewheat.gihub.io/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>Doris+Datax数据备份与恢复</title>
    <link href="https://biglovewheat.gihub.io/2023/05/04/Doris+datax%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D/"/>
    <id>https://biglovewheat.gihub.io/2023/05/04/Doris+datax%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D/</id>
    <published>2023-05-03T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.724Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Doris-Datax数据备份与恢复"><a href="#Doris-Datax数据备份与恢复" class="headerlink" title="Doris+Datax数据备份与恢复"></a>Doris+Datax数据备份与恢复</h2><h3 id="datax下载"><a href="#datax下载" class="headerlink" title="datax下载"></a>datax下载</h3><p><a href="https://github.com/alibaba/DataX">https://github.com/alibaba/DataX</a></p><p>下载最新版本，本测试使用202303版本</p><p><a href="https://datax-opensource.oss-cn-hangzhou.aliyuncs.com/202303/datax.tar.gz">https://datax-opensource.oss-cn-hangzhou.aliyuncs.com/202303/datax.tar.gz</a></p><h3 id="Doris测试数据创建"><a href="#Doris测试数据创建" class="headerlink" title="Doris测试数据创建"></a>Doris测试数据创建</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--创建数据库</span></span><br><span class="line"><span class="keyword">create</span> database test1;</span><br><span class="line"></span><br><span class="line"><span class="comment">--创建测试表,以data_partition作为分区字段，并启用动态分区</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> if <span class="keyword">not</span> <span class="keyword">exists</span> test1.test_work_log  (</span><br><span class="line">message_deviceId <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">NULL</span> ,</span><br><span class="line">message_taskId <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">NULL</span> ,</span><br><span class="line">date_partition <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NULL</span> COMMENT &quot;时间分区&quot;,</span><br><span class="line">message_txt string <span class="keyword">NULL</span> </span><br><span class="line">) ENGINE<span class="operator">=</span>OLAP</span><br><span class="line"><span class="keyword">UNIQUE</span> KEY(message_deviceId,message_taskId, date_partition)</span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(date_partition)(</span><br><span class="line"><span class="keyword">PARTITION</span> p_other <span class="keyword">VALUES</span> LESS THAN (&quot;1&quot;),</span><br><span class="line"><span class="keyword">PARTITION</span> p_history_20220714 <span class="keyword">VALUES</span> LESS THAN (&quot;20220714&quot;),</span><br><span class="line"><span class="keyword">PARTITION</span> p20230501 <span class="keyword">VALUES</span> [(&quot;20230501&quot;), (&quot;20230502&quot;)),</span><br><span class="line"><span class="keyword">PARTITION</span> p20230502 <span class="keyword">VALUES</span> [(&quot;20230502&quot;), (&quot;20230503&quot;)),</span><br><span class="line"><span class="keyword">PARTITION</span> p20230503 <span class="keyword">VALUES</span> [(&quot;20230503&quot;), (&quot;20230504&quot;)),</span><br><span class="line"><span class="keyword">PARTITION</span> p20230504 <span class="keyword">VALUES</span> [(&quot;20230504&quot;), (&quot;20230505&quot;)),</span><br><span class="line"><span class="keyword">PARTITION</span> p20230505 <span class="keyword">VALUES</span> [(&quot;20230505&quot;), (&quot;20230506&quot;)),</span><br><span class="line"><span class="keyword">PARTITION</span> p20230506 <span class="keyword">VALUES</span> [(&quot;20230506&quot;), (&quot;20230507&quot;))</span><br><span class="line">)</span><br><span class="line">DISTRIBUTED <span class="keyword">BY</span> HASH( message_deviceId,message_taskId) BUCKETS <span class="number">16</span></span><br><span class="line">PROPERTIES (</span><br><span class="line">&quot;replication_num&quot; <span class="operator">=</span> &quot;1&quot;,</span><br><span class="line">&quot;dynamic_partition.enable&quot; <span class="operator">=</span> &quot;true&quot;,</span><br><span class="line">&quot;dynamic_partition.time_unit&quot; <span class="operator">=</span> &quot;DAY&quot;,</span><br><span class="line">&quot;dynamic_partition.time_zone&quot; <span class="operator">=</span> &quot;Asia/Shanghai&quot;,</span><br><span class="line">&quot;dynamic_partition.start&quot; <span class="operator">=</span> &quot;-2147483648&quot;,</span><br><span class="line">&quot;dynamic_partition.end&quot; <span class="operator">=</span> &quot;3&quot;,</span><br><span class="line">&quot;dynamic_partition.prefix&quot; <span class="operator">=</span> &quot;p&quot;,</span><br><span class="line">&quot;dynamic_partition.replication_allocation&quot; <span class="operator">=</span> &quot;tag.location.default: 3&quot;,</span><br><span class="line">&quot;dynamic_partition.buckets&quot; <span class="operator">=</span> &quot;16&quot;,</span><br><span class="line">&quot;dynamic_partition.create_history_partition&quot; <span class="operator">=</span> &quot;true&quot;,</span><br><span class="line">&quot;dynamic_partition.history_partition_num&quot; <span class="operator">=</span> &quot;36&quot;,</span><br><span class="line">&quot;dynamic_partition.hot_partition_num&quot; <span class="operator">=</span> &quot;0&quot;,</span><br><span class="line">&quot;dynamic_partition.reserved_history_periods&quot; <span class="operator">=</span> &quot;NULL&quot;,</span><br><span class="line">&quot;in_memory&quot; <span class="operator">=</span> &quot;false&quot;,</span><br><span class="line">&quot;storage_format&quot; <span class="operator">=</span> &quot;V2&quot;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">--插入测试数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> test1.test_work_log <span class="keyword">VALUES</span> (<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="number">-1</span>,<span class="string">&#x27;aaa&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> test1.test_work_log <span class="keyword">VALUES</span> (<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="number">20230504</span>,<span class="string">&#x27;aaa&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> test1.test_work_log <span class="keyword">VALUES</span> (<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="number">20230505</span>,<span class="string">&#x27;bbb&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--查看所有数据</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test1.test_work_log;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查看分区情况</span></span><br><span class="line"><span class="keyword">show</span> partitions <span class="keyword">from</span> test1.test_work_log;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查看某分区数据</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test1.test_work_log <span class="keyword">PARTITION</span> p20230504;</span><br></pre></td></tr></table></figure><h3 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">2023-05-04 14:27:08.179 [main] ERROR Engine - </span><br><span class="line"></span><br><span class="line">经DataX智能分析,该任务最可能的错误原因是:</span><br><span class="line">com.alibaba.datax.common.exception.DataXException: Code:[Common-00], Describe:[您提供的配置文件存在错误信息，请检查您的作业配置 .] - 配置信息错误. 您提供的配置信息不是合法的JSON格式: syntax error, string . 请按照标准json格式提供配置信息. </span><br><span class="line">        at com.alibaba.datax.common.exception.DataXException.asDataXException(DataXException.java:26)</span><br><span class="line">        at com.alibaba.datax.common.util.Configuration.&lt;init&gt;(Configuration.java:1066)</span><br><span class="line">        at com.alibaba.datax.common.util.Configuration.from(Configuration.java:79)</span><br><span class="line">        at com.alibaba.datax.core.util.ConfigParser.parseJobConfig(ConfigParser.java:75)</span><br><span class="line">        at com.alibaba.datax.core.util.ConfigParser.parse(ConfigParser.java:26)</span><br><span class="line">        at com.alibaba.datax.core.Engine.entry(Engine.java:137)</span><br><span class="line">        at com.alibaba.datax.core.Engine.main(Engine.java:204)</span><br><span class="line"></span><br><span class="line"><span class="comment">## 解决办法</span></span><br><span class="line">find /home/mqxdata/datax/plugin/reader -<span class="built_in">type</span> f -name <span class="string">&quot;._*er&quot;</span>  |xargs <span class="built_in">rm</span> -f </span><br><span class="line">find /home/mqxdata/datax/plugin/writer -<span class="built_in">type</span> f -name <span class="string">&quot;._*er&quot;</span>  |xargs <span class="built_in">rm</span> -f </span><br></pre></td></tr></table></figure><h3 id="doris导出到csv"><a href="#doris导出到csv" class="headerlink" title="doris导出到csv"></a>doris导出到csv</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;job&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;reader&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mysqlreader&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;root&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;root&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;connection&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                                                <span class="attr">&quot;querySql&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;SELECT * from test1.test_work_log where date_partition=20230504;&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;jdbcUrl&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                     <span class="string">&quot;jdbc:mysql://hxkj07:19030/test1&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;txtfilewriter&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                        <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">&quot;fileName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test_work_log.csv.gz&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">&quot;writeMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;append&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">&quot;dateFormat&quot;</span><span class="punctuation">:</span> <span class="string">&quot;yyyy-MM-dd&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">&quot;fileFormat&quot;</span><span class="punctuation">:</span> <span class="string">&quot;csv&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;setting&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;channel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1&quot;</span></span><br><span class="line">                        <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="导出效果"><a href="#导出效果" class="headerlink" title="导出效果"></a>导出效果</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> test_work_log.csv.gz__ca303326_6445_4443_9e17_6c973ca5efa4 </span><br><span class="line">2,1,20230504,aaa</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="csv导入到doris"><a href="#csv导入到doris" class="headerlink" title="csv导入到doris"></a>csv导入到doris</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;job&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;reader&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;txtfilereader&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;./&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;encoding&quot;</span><span class="punctuation">:</span> <span class="string">&quot;UTF-8&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;String&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;String&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;fieldDelimiter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;,&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;doriswriter&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;loadUrl&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;hxkj07:18030&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;loadProps&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;message_deviceId&quot;</span><span class="punctuation">,</span> <span class="string">&quot;message_taskId&quot;</span><span class="punctuation">,</span> <span class="string">&quot;date_partition&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_txt&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;root&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;root&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;postSql&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;preSql&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;flushInterval&quot;</span><span class="punctuation">:</span><span class="number">30000</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;connection&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;jdbcUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jdbc:mysql://hxkj07:19030/test1&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;selectedDatabase&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test1&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;table&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;test_work_log&quot;</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;loadProps&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;format&quot;</span><span class="punctuation">:</span> <span class="string">&quot;json&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;strip_outer_array&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;setting&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;channel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="导入效果"><a href="#导入效果" class="headerlink" title="导入效果"></a>导入效果</h3><p>修改csv，把aaa改成new，再导入<br><img src="/../images/Doris+Datax%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D_01.jpg"></p><h3 id="生产环境配置-doris–-gt-hdfs"><a href="#生产环境配置-doris–-gt-hdfs" class="headerlink" title="生产环境配置(doris–&gt;hdfs)"></a>生产环境配置(doris–&gt;hdfs)</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;job&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;reader&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mysqlreader&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;root&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxx&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;connection&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                                                <span class="attr">&quot;querySql&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                    <span class="string">&quot;SELECT message_deviceId,message_taskId,message_generateTime,date_partition,message_realSpeed,message_driverMode,message_reportTime,message_taskIndex,message_curPathNum,message_impleWorkState,message_chassisType,message_chassisInfo_chassisType,message_chassisInfo_engineSpeed,message_chassisInfo_fuelOilLevel,message_chassisInfo_remainFuel,message_chassisInfo_engineInstantaneousFuelEconomy,message_chassisInfo_ptoGearSta,message_chassisInfo_ptoRotationRate,message_chassisInfo_upgradeSysSta,message_chassisInfo_hydraulicOilLevel,message_chassisInfo_hydraulicOilTemp,message_chassisInfo_hydraulicOilPressure,message_chassisInfo_engOilTemp,message_chassisInfo_grainTankWeightKg,message_chassisInfo_grainTankFullSts,message_chassisInfo_unloadClutchSts,message_chassisInfo_grainUnloadTubLvl,message_chassisInfo_oilPressure,message_chassisInfo_coolantTemperature,message_chassisInfo_realOil,message_chassisInfo_remainingOil,message_chassisInfo_currentWheelAngle,message_chassisInfo_steerMotorState,message_chassisInfo_remainingOilPercent,message_chassisInfo_threePointPromote,message_chassisInfo_tillingDepthFb,message_positionInfo_yaw,message_positionInfo_rtkStatus,message_positionInfo_pitchAngle,message_positionInfo_rollAngle,message_positionInfo_position_longitude,message_positionInfo_position_latitude,message_positionInfo_xyPosition_longitude,message_positionInfo_xyPosition_latitude,message_positionInfo_xyImpl_longitude,message_positionInfo_xyImpl_latitude,message_positionInfo_gnssNum,message_positionInfo_networkSignal,message_controlTaskInfo_fieldId,message_controlTaskInfo_fieldName,message_controlTaskInfo_fieldCode,message_controlTaskInfo_typeName,message_controlTaskInfo_totalArea,message_controlTaskInfo_operatedArea,message_controlTaskInfo_noOperateArea,message_controlTaskInfo_totalUsedTime,message_controlTaskInfo_percent,message_controlTaskInfo_widthOfCloth,message_controlTaskInfo_totalMileage,message_controlTaskInfo_operatedMileage,message_controlTaskInfo_noOperatedMileage,message_controlTaskInfo_speedPerHour,message_controlTaskInfo_operatedOffset,message_controlTaskInfo_operatedOffsetDirection,message_controlTaskInfo_needLastTime,message_controlTaskInfo_machineName,message_controlTaskInfo_implementName,message_controlTaskInfo_startTime,message_controlTaskInfo_operateStatus,message_controlTaskInfo_segmentPercent,message_statusInfo_deviceId,message_statusInfo_taskId,message_statusInfo_connected,message_statusInfo_ready,message_statusInfo_canTask,message_statusInfo_status,gis_farmcode,gis_farmlandcode,message_gsmStatusInfo_signalRssi,message_gsmStatusInfo_optGsm,message_gsmStatusInfo_networkType,message_gsmStatusInfo_simNumber,message_gsmStatusInfo_cardStatus,gis_is_exception FROM hx_farm_sit.ods_machine_work_log_uq where date_partition=20230503;&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;jdbcUrl&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                     <span class="string">&quot;jdbc:mysql://bigdata01:9030/hx_farm_sit&quot;</span></span><br><span class="line">                                <span class="punctuation">]</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfswriter&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                        <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_deviceId&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_taskId&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_generateTime&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bigint&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;date_partition&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_realSpeed&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_driverMode&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_reportTime&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_taskIndex&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_curPathNum&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_impleWorkState&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisType&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_chassisType&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_engineSpeed&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_fuelOilLevel&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_remainFuel&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_engineInstantaneousFuelEconomy&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_ptoGearSta&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_ptoRotationRate&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_upgradeSysSta&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_hydraulicOilLevel&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_hydraulicOilTemp&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_hydraulicOilPressure&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_engOilTemp&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_grainTankWeightKg&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_grainTankFullSts&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_unloadClutchSts&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_grainUnloadTubLvl&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_oilPressure&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_coolantTemperature&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_realOil&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_remainingOil&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_currentWheelAngle&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_steerMotorState&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_remainingOilPercent&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_threePointPromote&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_chassisInfo_tillingDepthFb&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_positionInfo_yaw&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_positionInfo_rtkStatus&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_positionInfo_pitchAngle&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_positionInfo_rollAngle&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_positionInfo_position_longitude&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_positionInfo_position_latitude&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_positionInfo_xyPosition_longitude&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_positionInfo_xyPosition_latitude&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_positionInfo_xyImpl_longitude&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_positionInfo_xyImpl_latitude&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_positionInfo_gnssNum&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_positionInfo_networkSignal&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_fieldId&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bigint&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_fieldName&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_fieldCode&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_typeName&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_totalArea&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_operatedArea&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_noOperateArea&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_totalUsedTime&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_percent&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_widthOfCloth&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_totalMileage&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_operatedMileage&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_noOperatedMileage&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_speedPerHour&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_operatedOffset&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_operatedOffsetDirection&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_needLastTime&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_machineName&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_implementName&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_startTime&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_operateStatus&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_controlTaskInfo_segmentPercent&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_statusInfo_deviceId&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_statusInfo_taskId&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_statusInfo_connected&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_statusInfo_ready&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_statusInfo_canTask&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_statusInfo_status&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gis_farmcode&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gis_farmlandcode&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_gsmStatusInfo_signalRssi&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_gsmStatusInfo_optGsm&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_gsmStatusInfo_networkType&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_gsmStatusInfo_simNumber&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;message_gsmStatusInfo_cardStatus&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gis_is_exception&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">                                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">&quot;defaultFS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfs://nameservice1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">&quot;fieldDelimiter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">&quot;compress&quot;</span><span class="punctuation">:</span><span class="string">&quot;SNAPPY&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">&quot;fileName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ods_machine_work_log_uq.orc&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">&quot;fileType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;orc&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/bigdata/doris/hx_farm_sit.db/ods_machine_work_log_uq/dt=20230503/&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                        <span class="attr">&quot;writeMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;append&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                         <span class="attr">&quot;hadoopConfig&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">                                                                <span class="attr">&quot;dfs.nameservices&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;nameservice1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;dfs.ha.namenodes.nameservice1&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;bigdata01,bigdata02&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;dfs.namenode.rpc-address.nameservice1.bigdata01&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;bigdata01:8020&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;dfs.namenode.rpc-address.nameservice1.bigdata02&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;bigdata02:8020&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                                                <span class="attr">&quot;dfs.client.failover.proxy.provider.nameservice1&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider&quot;</span></span><br><span class="line">                                                                        <span class="punctuation">&#125;</span></span><br><span class="line">                                <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;setting&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;channel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1&quot;</span></span><br><span class="line">                        <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="生产环境配置-hdfs–-gt-doris"><a href="#生产环境配置-hdfs–-gt-doris" class="headerlink" title="生产环境配置(hdfs–&gt;doris)"></a>生产环境配置(hdfs–&gt;doris)</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;job&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;setting&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;channel&quot;</span><span class="punctuation">:</span> <span class="number">3</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;reader&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfsreader&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/bigdata/doris/hx_farm_sit.db/ods_machine_work_log_uq/*/*&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;defaultFS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfs://nameservice1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                                <span class="attr">&quot;fileType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;orc&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                                <span class="attr">&quot;fieldDelimiter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;encoding&quot;</span><span class="punctuation">:</span> <span class="string">&quot;UTF-8&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                                <span class="attr">&quot;hadoopConfig&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">                                                                <span class="attr">&quot;dfs.nameservices&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;nameservice1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;dfs.ha.namenodes.nameservice1&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;bigdata01,bigdata02&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;dfs.namenode.rpc-address.nameservice1.bigdata01&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;bigdata01:8020&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;dfs.namenode.rpc-address.nameservice1.bigdata02&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;bigdata02:8020&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                                                <span class="attr">&quot;dfs.client.failover.proxy.provider.nameservice1&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider&quot;</span></span><br><span class="line">                                                                        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                        <span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;5&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;6&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;7&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;8&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;9&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;10&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;11&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;12&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;13&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;14&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;15&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;16&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;17&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;18&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;21&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;22&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;23&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;24&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;25&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;26&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;27&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;28&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;29&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;30&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;31&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;32&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;33&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;34&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;35&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;36&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;37&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;38&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;39&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;40&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;41&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;42&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;43&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;44&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;45&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;46&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;47&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;48&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;49&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;50&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;51&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;52&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;53&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;54&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;55&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;56&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;57&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;58&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;59&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;60&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;61&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;62&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;63&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;64&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;65&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;66&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;67&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;68&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;69&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;70&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;71&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;72&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;73&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;74&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;75&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;76&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;77&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;78&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;79&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;80&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;81&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;82&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="string">&quot;83&quot;</span><span class="punctuation">,</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;long&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;doriswriter&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;root&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxx&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;database&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hx_farm_sit&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;table&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ods_machine_work_log_uq_load&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                                <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;message_deviceId&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_taskId&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_generateTime&quot;</span><span class="punctuation">,</span><span class="string">&quot;date_partition&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_realSpeed&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_driverMode&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_reportTime&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_taskIndex&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_curPathNum&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_impleWorkState&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisType&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_chassisType&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_engineSpeed&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_fuelOilLevel&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_remainFuel&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_engineInstantaneousFuelEconomy&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_ptoGearSta&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_ptoRotationRate&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_upgradeSysSta&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_hydraulicOilLevel&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_hydraulicOilTemp&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_hydraulicOilPressure&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_engOilTemp&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_grainTankWeightKg&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_grainTankFullSts&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_unloadClutchSts&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_grainUnloadTubLvl&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_oilPressure&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_coolantTemperature&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_realOil&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_remainingOil&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_currentWheelAngle&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_steerMotorState&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_remainingOilPercent&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_threePointPromote&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_chassisInfo_tillingDepthFb&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_positionInfo_yaw&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_positionInfo_rtkStatus&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_positionInfo_pitchAngle&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_positionInfo_rollAngle&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_positionInfo_position_longitude&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_positionInfo_position_latitude&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_positionInfo_xyPosition_longitude&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_positionInfo_xyPosition_latitude&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_positionInfo_xyImpl_longitude&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_positionInfo_xyImpl_latitude&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_positionInfo_gnssNum&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_positionInfo_networkSignal&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_fieldId&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_fieldName&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_fieldCode&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_typeName&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_totalArea&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_operatedArea&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_noOperateArea&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_totalUsedTime&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_percent&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_widthOfCloth&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_totalMileage&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_operatedMileage&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_noOperatedMileage&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_speedPerHour&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_operatedOffset&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_operatedOffsetDirection&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_needLastTime&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_machineName&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_implementName&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_startTime&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_operateStatus&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_controlTaskInfo_segmentPercent&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_statusInfo_deviceId&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_statusInfo_taskId&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_statusInfo_connected&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_statusInfo_ready&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_statusInfo_canTask&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_statusInfo_status&quot;</span><span class="punctuation">,</span><span class="string">&quot;gis_farmcode&quot;</span><span class="punctuation">,</span><span class="string">&quot;gis_farmlandcode&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_gsmStatusInfo_signalRssi&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_gsmStatusInfo_optGsm&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_gsmStatusInfo_networkType&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_gsmStatusInfo_simNumber&quot;</span><span class="punctuation">,</span><span class="string">&quot;message_gsmStatusInfo_cardStatus&quot;</span><span class="punctuation">,</span><span class="string">&quot;gis_is_exception&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;preSql&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;postSql&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;jdbcUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jdbc:mysql://bigdata01:9030/&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;loadUrl&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;bigdata01:18030&quot;</span><span class="punctuation">,</span> <span class="string">&quot;bigdata02:18030&quot;</span><span class="punctuation">,</span> <span class="string">&quot;bigdata03:18030&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;loadProps&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;maxBatchRows&quot;</span><span class="punctuation">:</span> <span class="number">10000</span><span class="punctuation">,</span></span><br><span class="line">                                                <span class="attr">&quot;maxBatchByteSize&quot;</span><span class="punctuation">:</span> <span class="number">10857600</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Doris-Datax数据备份与恢复&quot;&gt;&lt;a href=&quot;#Doris-Datax数据备份与恢复&quot; class=&quot;headerlink&quot; title=&quot;Doris+Datax数据备份与恢复&quot;&gt;&lt;/a&gt;Doris+Datax数据备份与恢复&lt;/h2&gt;&lt;h3 id=&quot;d</summary>
      
    
    
    
    <category term="bigdata" scheme="https://biglovewheat.gihub.io/categories/bigdata/"/>
    
    
    <category term="bigdata" scheme="https://biglovewheat.gihub.io/tags/bigdata/"/>
    
  </entry>
  
  <entry>
    <title>Canal将mysql变化数据投送（同步）到MQ</title>
    <link href="https://biglovewheat.gihub.io/2023/04/25/Canal%E5%B0%86mysql%E5%8F%98%E5%8C%96%E6%95%B0%E6%8D%AE%E6%8A%95%E9%80%81%EF%BC%88%E5%90%8C%E6%AD%A5%EF%BC%89%E5%88%B0MQ/"/>
    <id>https://biglovewheat.gihub.io/2023/04/25/Canal%E5%B0%86mysql%E5%8F%98%E5%8C%96%E6%95%B0%E6%8D%AE%E6%8A%95%E9%80%81%EF%BC%88%E5%90%8C%E6%AD%A5%EF%BC%89%E5%88%B0MQ/</id>
    <published>2023-04-24T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.722Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Canal将mysql变化数据投送（同步）到MQ"><a href="#Canal将mysql变化数据投送（同步）到MQ" class="headerlink" title="Canal将mysql变化数据投送（同步）到MQ"></a>Canal将mysql变化数据投送（同步）到MQ</h2><h3 id="清单"><a href="#清单" class="headerlink" title="清单"></a>清单</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">192.168.8.221 bigdata1  <span class="comment">## admin,deployer</span></span><br><span class="line">192.168.8.222 bigdata2  <span class="comment">## deployer</span></span><br><span class="line">192.168.8.223 bigdata3  <span class="comment">## deployer</span></span><br><span class="line"></span><br><span class="line">canal.admin-1.1.5.tar.gz</span><br><span class="line">canal.deployer-1.1.5.tar.gz</span><br></pre></td></tr></table></figure><h3 id="集群安装前提"><a href="#集群安装前提" class="headerlink" title="集群安装前提"></a>集群安装前提</h3><p>java 1.8 （安装略）</p><p>zookeeper （安装略）</p><p>mysql（安装略）</p><h3 id="mysql配置"><a href="#mysql配置" class="headerlink" title="mysql配置"></a>mysql配置</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--集群安装需要mysql存储集群数据</span></span><br><span class="line"></span><br><span class="line">mysql <span class="operator">-</span>u root <span class="operator">-</span>p  <span class="operator">&lt;</span> <span class="operator">/</span>data<span class="operator">/</span>canal<span class="operator">/</span>admin<span class="operator">/</span>conf<span class="operator">/</span>canal_manager.sql</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;canal&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;Abc123!!!&#x27;</span>;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> canal_manager.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;canal&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h3 id="需复制的mysql配置"><a href="#需复制的mysql配置" class="headerlink" title="需复制的mysql配置"></a>需复制的mysql配置</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">需要给canal用户赋予复制的权限</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;canal&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;Abc123@!!!&#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, REPLICATION SLAVE, REPLICATION CLIENT <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;canal&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h3 id="安装admin"><a href="#安装admin" class="headerlink" title="安装admin"></a>安装admin</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 解压</span></span><br><span class="line">vi conf/application.yml</span><br><span class="line"></span><br><span class="line">server:</span><br><span class="line">  port: 18089</span><br><span class="line">spring:</span><br><span class="line">  jackson:</span><br><span class="line">    date-format: yyyy-MM-<span class="built_in">dd</span> HH:mm:ss</span><br><span class="line">    time-zone: GMT+8</span><br><span class="line"></span><br><span class="line">spring.datasource:</span><br><span class="line">  address: 192.168.8.211:3306</span><br><span class="line">  database: canal_manager</span><br><span class="line">  username: canal</span><br><span class="line">  password: Abc123!!!</span><br><span class="line">  driver-class-name: com.mysql.jdbc.Driver</span><br><span class="line">  url: jdbc:mysql://<span class="variable">$&#123;spring.datasource.address&#125;</span>/<span class="variable">$&#123;spring.datasource.database&#125;</span>?useUnicode=<span class="literal">true</span>&amp;characterEncoding=UTF-8&amp;useSSL=<span class="literal">false</span>&amp;allowPublicKeyRetrieval=<span class="literal">true</span></span><br><span class="line">  hikari:</span><br><span class="line">    maximum-pool-size: 30</span><br><span class="line">    minimum-idle: 1</span><br><span class="line"></span><br><span class="line">canal:</span><br><span class="line">  adminUser: admin</span><br><span class="line">  adminPasswd: 123456</span><br><span class="line"></span><br><span class="line"><span class="comment">## 启动admin</span></span><br><span class="line">./startup_admin.sh</span><br><span class="line"><span class="comment"># 启动脚本</span></span><br><span class="line"><span class="built_in">cat</span> startup_admin.sh </span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/data/soft/jdk1.8.0_301</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> CLASSPATH=.:<span class="variable">$JAVA_HOME</span>/lib/dt.jar:<span class="variable">$JAVA_HOME</span>/lib/tools.jar</span><br><span class="line"></span><br><span class="line">/data/canal/admin/bin/startup.sh</span><br></pre></td></tr></table></figure><h3 id="登录控制台"><a href="#登录控制台" class="headerlink" title="登录控制台"></a>登录控制台</h3><p><a href="http://192.168.8.211/">http://192.168.8.211</a> admin&#x2F;admin123</p><p>新建一个集群</p><h3 id="配置并启动deployer"><a href="#配置并启动deployer" class="headerlink" title="配置并启动deployer"></a>配置并启动deployer</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">vi deployer/conf/canal_local.properties</span><br><span class="line"></span><br><span class="line"><span class="comment"># register ip</span></span><br><span class="line">canal.register.ip = </span><br><span class="line"></span><br><span class="line"><span class="comment"># canal admin config</span></span><br><span class="line">canal.admin.manager = 192.168.8.221:18089</span><br><span class="line">canal.admin.port = 11110</span><br><span class="line">canal.admin.user = admin</span><br><span class="line">canal.admin.passwd = 6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9</span><br><span class="line"><span class="comment"># admin auto register</span></span><br><span class="line">canal.admin.register.auto = <span class="literal">true</span></span><br><span class="line">canal.admin.register.cluster = canal-cluster</span><br><span class="line">canal.admin.register.name =  </span><br><span class="line"></span><br><span class="line"><span class="comment">## 启动脚本</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/data/soft/jdk1.8.0_301</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> CLASSPATH=.:<span class="variable">$JAVA_HOME</span>/lib/dt.jar:<span class="variable">$JAVA_HOME</span>/lib/tools.jar</span><br><span class="line"></span><br><span class="line">/data/canal/deployer/bin/startup.sh  <span class="built_in">local</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 启动正常的话，控制台就能看到3台server，否则请看log排错。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="控制台配置server-集群配置"><a href="#控制台配置server-集群配置" class="headerlink" title="控制台配置server(集群配置)"></a>控制台配置server(集群配置)</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#################################################</span></span><br><span class="line"><span class="comment">#########               common argument         #############</span></span><br><span class="line"><span class="comment">#################################################</span></span><br><span class="line"><span class="comment"># tcp bind ip</span></span><br><span class="line"><span class="attr">canal.ip</span> =<span class="string"></span></span><br><span class="line"><span class="comment"># register ip to zookeeper</span></span><br><span class="line"><span class="attr">canal.register.ip</span> = <span class="string"></span></span><br><span class="line"><span class="attr">canal.port</span> = <span class="string">11111</span></span><br><span class="line"><span class="attr">canal.metrics.pull.port</span> = <span class="string">11112</span></span><br><span class="line"><span class="comment"># canal instance user/passwd</span></span><br><span class="line"><span class="comment"># canal.user = canal</span></span><br><span class="line"><span class="comment"># canal.passwd = E3619321C1A937C46A0D8BD1DAC39F93B27D4458</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># canal admin config</span></span><br><span class="line"><span class="attr">canal.admin.manager</span> = <span class="string">192.168.8.221:18089</span></span><br><span class="line"><span class="attr">canal.admin.port</span> = <span class="string">11110</span></span><br><span class="line"><span class="attr">canal.admin.user</span> = <span class="string">admin</span></span><br><span class="line"><span class="attr">canal.admin.passwd</span> = <span class="string">6BB4837EB74329105EE4568DDA7DC67ED2CA2AD9</span></span><br><span class="line"><span class="comment"># admin auto register</span></span><br><span class="line"><span class="attr">canal.admin.register.auto</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">canal.admin.register.cluster</span> = <span class="string">canal-cluster</span></span><br><span class="line"><span class="comment">#canal.admin.register.name = bigdata01</span></span><br><span class="line"></span><br><span class="line"><span class="attr">canal.zkServers</span> = <span class="string">192.168.8.221:12181,192.168.8.222:12181,192.168.8.223:12181</span></span><br><span class="line"><span class="comment"># flush data to zk</span></span><br><span class="line"><span class="attr">canal.zookeeper.flush.period</span> = <span class="string">1000</span></span><br><span class="line"><span class="attr">canal.withoutNetty</span> = <span class="string">false</span></span><br><span class="line"><span class="comment"># tcp, kafka, rocketMQ, rabbitMQ</span></span><br><span class="line"><span class="attr">canal.serverMode</span> = <span class="string">rocketMQ</span></span><br><span class="line"><span class="comment"># flush meta cursor/parse position to file</span></span><br><span class="line"><span class="attr">canal.file.data.dir</span> = <span class="string">$&#123;canal.conf.dir&#125;</span></span><br><span class="line"><span class="attr">canal.file.flush.period</span> = <span class="string">1000</span></span><br><span class="line"><span class="comment">## memory store RingBuffer size, should be Math.pow(2,n)</span></span><br><span class="line"><span class="attr">canal.instance.memory.buffer.size</span> = <span class="string">16384</span></span><br><span class="line"><span class="comment">## memory store RingBuffer used memory unit size , default 1kb</span></span><br><span class="line"><span class="attr">canal.instance.memory.buffer.memunit</span> = <span class="string">1024 </span></span><br><span class="line"><span class="comment">## meory store gets mode used MEMSIZE or ITEMSIZE</span></span><br><span class="line"><span class="attr">canal.instance.memory.batch.mode</span> = <span class="string">MEMSIZE</span></span><br><span class="line"><span class="attr">canal.instance.memory.rawEntry</span> = <span class="string">true</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">## detecing config</span></span><br><span class="line"><span class="attr">canal.instance.detecting.enable</span> = <span class="string">false</span></span><br><span class="line"><span class="comment">#canal.instance.detecting.sql = insert into retl.xdual values(1,now()) on duplicate key update x=now()</span></span><br><span class="line"><span class="attr">canal.instance.detecting.sql</span> = <span class="string">select 1</span></span><br><span class="line"><span class="attr">canal.instance.detecting.interval.time</span> = <span class="string">3</span></span><br><span class="line"><span class="attr">canal.instance.detecting.retry.threshold</span> = <span class="string">3</span></span><br><span class="line"><span class="attr">canal.instance.detecting.heartbeatHaEnable</span> = <span class="string">false</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># support maximum transaction size, more than the size of the transaction will be cut into multiple transactions delivery</span></span><br><span class="line"><span class="attr">canal.instance.transaction.size</span> =  <span class="string">1024</span></span><br><span class="line"><span class="comment"># mysql fallback connected to new master should fallback times</span></span><br><span class="line"><span class="attr">canal.instance.fallbackIntervalInSeconds</span> = <span class="string">60</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># network config</span></span><br><span class="line"><span class="attr">canal.instance.network.receiveBufferSize</span> = <span class="string">16384</span></span><br><span class="line"><span class="attr">canal.instance.network.sendBufferSize</span> = <span class="string">16384</span></span><br><span class="line"><span class="attr">canal.instance.network.soTimeout</span> = <span class="string">30</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># binlog filter config</span></span><br><span class="line"><span class="attr">canal.instance.filter.druid.ddl</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">canal.instance.filter.query.dcl</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">canal.instance.filter.query.dml</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">canal.instance.filter.query.ddl</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">canal.instance.filter.table.error</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">canal.instance.filter.rows</span> = <span class="string">false</span></span><br><span class="line"><span class="attr">canal.instance.filter.transaction.entry</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">canal.instance.filter.dml.insert</span> = <span class="string">false</span></span><br><span class="line"><span class="attr">canal.instance.filter.dml.update</span> = <span class="string">false</span></span><br><span class="line"><span class="attr">canal.instance.filter.dml.delete</span> = <span class="string">false</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># binlog format/image check</span></span><br><span class="line"><span class="attr">canal.instance.binlog.format</span> = <span class="string">ROW,STATEMENT,MIXED </span></span><br><span class="line"><span class="attr">canal.instance.binlog.image</span> = <span class="string">FULL,MINIMAL,NOBLOB</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># binlog ddl isolation</span></span><br><span class="line"><span class="attr">canal.instance.get.ddl.isolation</span> = <span class="string">false</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># parallel parser config</span></span><br><span class="line"><span class="attr">canal.instance.parser.parallel</span> = <span class="string">true</span></span><br><span class="line"><span class="comment">## concurrent thread number, default 60% available processors, suggest not to exceed Runtime.getRuntime().availableProcessors()</span></span><br><span class="line"><span class="comment">#canal.instance.parser.parallelThreadSize = 16</span></span><br><span class="line"><span class="comment">## disruptor ringbuffer size, must be power of 2</span></span><br><span class="line"><span class="attr">canal.instance.parser.parallelBufferSize</span> = <span class="string">256</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># table meta tsdb info</span></span><br><span class="line"><span class="attr">canal.instance.tsdb.enable</span> = <span class="string">false</span></span><br><span class="line"><span class="attr">canal.instance.tsdb.dir</span> = <span class="string">$&#123;canal.file.data.dir:../conf&#125;/$&#123;canal.instance.destination:&#125;</span></span><br><span class="line"><span class="comment">#canal.instance.tsdb.url = jdbc:h2:$&#123;canal.instance.tsdb.dir&#125;/h2;CACHE_SIZE=1000;MODE=MYSQL;</span></span><br><span class="line"><span class="attr">canal.instance.tsdb.dbUsername</span> = <span class="string">canal</span></span><br><span class="line"><span class="attr">canal.instance.tsdb.dbPassword</span> = <span class="string">canal</span></span><br><span class="line"><span class="comment"># dump snapshot interval, default 24 hour</span></span><br><span class="line"><span class="attr">canal.instance.tsdb.snapshot.interval</span> = <span class="string">24</span></span><br><span class="line"><span class="comment"># purge snapshot expire , default 360 hour(15 days)</span></span><br><span class="line"><span class="attr">canal.instance.tsdb.snapshot.expire</span> = <span class="string">360</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#################################################</span></span><br><span class="line"><span class="comment">#########               destinations            #############</span></span><br><span class="line"><span class="comment">#################################################</span></span><br><span class="line"><span class="attr">canal.destinations</span> = <span class="string"></span></span><br><span class="line"><span class="comment"># conf root dir</span></span><br><span class="line"><span class="attr">canal.conf.dir</span> = <span class="string">../conf</span></span><br><span class="line"><span class="comment"># auto scan instance dir add/remove and start/stop instance</span></span><br><span class="line"><span class="attr">canal.auto.scan</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">canal.auto.scan.interval</span> = <span class="string">5</span></span><br><span class="line"><span class="comment"># set this value to &#x27;true&#x27; means that when binlog pos not found, skip to latest.</span></span><br><span class="line"><span class="comment"># WARN: pls keep &#x27;false&#x27; in production env, or if you know what you want.</span></span><br><span class="line"><span class="attr">canal.auto.reset.latest.pos.mode</span> = <span class="string">false</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#canal.instance.tsdb.spring.xml = classpath:spring/tsdb/h2-tsdb.xml</span></span><br><span class="line"><span class="attr">canal.instance.tsdb.spring.xml</span> = <span class="string">classpath:spring/tsdb/mysql-tsdb.xml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">canal.instance.global.mode</span> = <span class="string">spring</span></span><br><span class="line"><span class="attr">canal.instance.global.lazy</span> = <span class="string">false</span></span><br><span class="line"><span class="attr">canal.instance.global.manager.address</span> = <span class="string">$&#123;canal.admin.manager&#125;</span></span><br><span class="line"><span class="comment">#canal.instance.global.spring.xml = classpath:spring/memory-instance.xml</span></span><br><span class="line"><span class="comment">#canal.instance.global.spring.xml = classpath:spring/file-instance.xml</span></span><br><span class="line"><span class="attr">canal.instance.global.spring.xml</span> = <span class="string">classpath:spring/default-instance.xml</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">##################################################</span></span><br><span class="line"><span class="comment">#########             MQ Properties      #############</span></span><br><span class="line"><span class="comment">##################################################</span></span><br><span class="line"><span class="comment"># aliyun ak/sk , support rds/mq</span></span><br><span class="line"><span class="attr">canal.aliyun.accessKey</span> =<span class="string"></span></span><br><span class="line"><span class="attr">canal.aliyun.secretKey</span> =<span class="string"></span></span><br><span class="line"><span class="attr">canal.aliyun.uid</span>=<span class="string"></span></span><br><span class="line"></span><br><span class="line"><span class="attr">canal.mq.flatMessage</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">canal.mq.canalBatchSize</span> = <span class="string">50</span></span><br><span class="line"><span class="attr">canal.mq.canalGetTimeout</span> = <span class="string">100</span></span><br><span class="line"><span class="comment"># Set this value to &quot;cloud&quot;, if you want open message trace feature in aliyun.</span></span><br><span class="line"><span class="attr">canal.mq.accessChannel</span> = <span class="string">local</span></span><br><span class="line"></span><br><span class="line"><span class="attr">canal.mq.database.hash</span> = <span class="string">true</span></span><br><span class="line"><span class="attr">canal.mq.send.thread.size</span> = <span class="string">30</span></span><br><span class="line"><span class="attr">canal.mq.build.thread.size</span> = <span class="string">8</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">##################################################</span></span><br><span class="line"><span class="comment">#########                   RocketMQ         #############</span></span><br><span class="line"><span class="comment">##################################################</span></span><br><span class="line"><span class="attr">rocketmq.producer.group</span> = <span class="string">mysql-canal-mq</span></span><br><span class="line"><span class="attr">rocketmq.enable.message.trace</span> = <span class="string">false</span></span><br><span class="line"><span class="attr">rocketmq.customized.trace.topic</span> =<span class="string"></span></span><br><span class="line"><span class="attr">rocketmq.namespace</span> =<span class="string"></span></span><br><span class="line"><span class="attr">rocketmq.namesrv.addr</span> = <span class="string">hxkj07:9876</span></span><br><span class="line"><span class="attr">rocketmq.retry.times.when.send.failed</span> = <span class="string">0</span></span><br><span class="line"><span class="attr">rocketmq.vip.channel.enabled</span> = <span class="string">false</span></span><br><span class="line"><span class="attr">rocketmq.tag</span> = <span class="string"></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="创建并配置instance"><a href="#创建并配置instance" class="headerlink" title="创建并配置instance"></a>创建并配置instance</h3><p>控制台新建一个instance，配置如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">#################################################</span><br><span class="line">## mysql serverId , v1.0.26+ will autoGen</span><br><span class="line"># canal.instance.mysql.slaveId=0</span><br><span class="line"></span><br><span class="line"># enable gtid use true/false</span><br><span class="line">canal.instance.gtidon=false</span><br><span class="line"></span><br><span class="line"># position info</span><br><span class="line">canal.instance.master.address=hxkj07:3306</span><br><span class="line">canal.instance.master.journal.name=</span><br><span class="line">canal.instance.master.position=</span><br><span class="line">canal.instance.master.timestamp=</span><br><span class="line">canal.instance.master.gtid=</span><br><span class="line"></span><br><span class="line"># rds oss binlog</span><br><span class="line">canal.instance.rds.accesskey=</span><br><span class="line">canal.instance.rds.secretkey=</span><br><span class="line">canal.instance.rds.instanceId=</span><br><span class="line"></span><br><span class="line"># table meta tsdb info</span><br><span class="line">canal.instance.tsdb.enable=false</span><br><span class="line">#canal.instance.tsdb.url=jdbc:mysql://127.0.0.1:3306/canal_tsdb</span><br><span class="line">#canal.instance.tsdb.dbUsername=canal</span><br><span class="line">#canal.instance.tsdb.dbPassword=canal</span><br><span class="line"></span><br><span class="line">#canal.instance.standby.address =</span><br><span class="line">#canal.instance.standby.journal.name =</span><br><span class="line">#canal.instance.standby.position =</span><br><span class="line">#canal.instance.standby.timestamp =</span><br><span class="line">#canal.instance.standby.gtid=</span><br><span class="line"></span><br><span class="line"># username/password</span><br><span class="line">canal.instance.dbUsername=canal</span><br><span class="line">canal.instance.dbPassword=Hxkj2022!!!</span><br><span class="line">canal.instance.connectionCharset = UTF-8</span><br><span class="line"># enable druid Decrypt database password</span><br><span class="line">canal.instance.enableDruid=false</span><br><span class="line">#canal.instance.pwdPublicKey=MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBALK4BUxdDltRRE5/zXpVEVPUgunvscYFtEip3pmLlhrWpacX7y7GCMo2/JM6LeHmiiNdH1FWgGCpUfircSwlWKUCAwEAAQ==</span><br><span class="line"></span><br><span class="line"># table regex</span><br><span class="line">canal.instance.filter.regex=front_telematics.machinery_implement_combination_record,baseinfo.t_implement_sku,baseinfo.t_device_sku,iot.t_device,front_telematics.t_bg_agronomy_operate,baseinfo.t_fault_definittion_description</span><br><span class="line"># table black regex</span><br><span class="line">canal.instance.filter.black.regex=</span><br><span class="line"># table field filter(format: schema1.tableName1:field1/field2,schema2.tableName2:field1/field2)</span><br><span class="line">#canal.instance.filter.field=test1.t_product:id/subject/keywords,test2.t_company:id/name/contact/ch</span><br><span class="line"># table field black filter(format: schema1.tableName1:field1/field2,schema2.tableName2:field1/field2)</span><br><span class="line">#canal.instance.filter.black.field=test1.t_product:subject/product_image,test2.t_company:id/name/contact/ch</span><br><span class="line"></span><br><span class="line"># mq config</span><br><span class="line">canal.mq.topic=mysql_canal_mq</span><br><span class="line"># dynamic topic route by schema or table regex</span><br><span class="line">#canal.mq.dynamicTopic=</span><br><span class="line">canal.mq.partition=0</span><br><span class="line"># hash partition config</span><br><span class="line">canal.mq.partitionsNum=4</span><br><span class="line">canal.mq.partitionHash=.*\\..*:$pk$,.*\\..*:id</span><br><span class="line">#canal.mq.partitionHash=test.table:id^name,.*\\..*</span><br><span class="line">#################################################</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="检查mq"><a href="#检查mq" class="headerlink" title="检查mq"></a>检查mq</h3><p>所有配置正常情况下，修改目标mysql，就能在rocketmq看到相应的message</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Canal将mysql变化数据投送（同步）到MQ&quot;&gt;&lt;a href=&quot;#Canal将mysql变化数据投送（同步）到MQ&quot; class=&quot;headerlink&quot; title=&quot;Canal将mysql变化数据投送（同步）到MQ&quot;&gt;&lt;/a&gt;Canal将mysql变化数</summary>
      
    
    
    
    <category term="bigdata" scheme="https://biglovewheat.gihub.io/categories/bigdata/"/>
    
    
    <category term="bigdata" scheme="https://biglovewheat.gihub.io/tags/bigdata/"/>
    
  </entry>
  
  <entry>
    <title>Cloudera-CM+CDH6安装</title>
    <link href="https://biglovewheat.gihub.io/2023/04/13/Cloudera-CM+CDH6%E5%AE%89%E8%A3%85/"/>
    <id>https://biglovewheat.gihub.io/2023/04/13/Cloudera-CM+CDH6%E5%AE%89%E8%A3%85/</id>
    <published>2023-04-12T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.724Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Cloudera-CM-CDH6-安装"><a href="#Cloudera-CM-CDH6-安装" class="headerlink" title="Cloudera CM+CDH6 安装"></a>Cloudera CM+CDH6 安装</h2><h3 id="环境清单"><a href="#环境清单" class="headerlink" title="环境清单"></a>环境清单</h3><p>192.168.8.221 bigdata1<br>192.168.8.221 bigdata2<br>192.168.8.221 bigdata3</p><h3 id="服务器设置"><a href="#服务器设置" class="headerlink" title="服务器设置"></a>服务器设置</h3><p>关闭firewall，关闭selinux，设置ssh互信（略）</p><h3 id="禁止透明大页"><a href="#禁止透明大页" class="headerlink" title="禁止透明大页"></a>禁止透明大页</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> never &gt; /sys/kernel/mm/transparent_hugepage/enabled</span><br><span class="line"><span class="built_in">echo</span> never &gt; /sys/kernel/mm/transparent_hugepage/defrag</span><br></pre></td></tr></table></figure><h3 id="mysql5-7安装"><a href="#mysql5-7安装" class="headerlink" title="mysql5.7安装"></a>mysql5.7安装</h3><p>（略）</p><h3 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database scm <span class="keyword">default</span> <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">default</span> <span class="keyword">collate</span> utf8_general_ci;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> scm.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;scm&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;Hxkj2022!!!&#x27;</span>;</span><br><span class="line"><span class="keyword">create</span> database amon <span class="keyword">default</span> <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">default</span> <span class="keyword">collate</span> utf8_general_ci;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> amon.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;amon&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;Hxkj2022!!!&#x27;</span>;</span><br><span class="line"><span class="keyword">create</span> database rman <span class="keyword">default</span> <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">default</span> <span class="keyword">collate</span> utf8_general_ci;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> rman.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;rman&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;Hxkj2022!!!&#x27;</span>;</span><br><span class="line"><span class="keyword">create</span> database hue <span class="keyword">default</span> <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">default</span> <span class="keyword">collate</span> utf8_general_ci;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> hue.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;hue&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;Hxkj2022!!!&#x27;</span>;</span><br><span class="line"><span class="keyword">create</span> database metastore <span class="keyword">default</span> <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">default</span> <span class="keyword">collate</span> utf8_general_ci;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> metastore.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;hive&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;Hxkj2022!!!&#x27;</span>;</span><br><span class="line"><span class="keyword">create</span> database sentry <span class="keyword">default</span> <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">default</span> <span class="keyword">collate</span> utf8_general_ci;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> sentry.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;sentry&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;Hxkj2022!!!&#x27;</span>;</span><br><span class="line"><span class="keyword">create</span> database nav <span class="keyword">default</span> <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">default</span> <span class="keyword">collate</span> utf8_general_ci;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> nav.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;nav&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;Hxkj2022!!!&#x27;</span>;</span><br><span class="line"><span class="keyword">create</span> database oozie <span class="keyword">default</span> <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">default</span> <span class="keyword">collate</span> utf8_general_ci;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">on</span> oozie.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;oozie&#x27;</span>@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;Hxkj2022!!!&#x27;</span>;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><h3 id="本地yum仓库搭建"><a href="#本地yum仓库搭建" class="headerlink" title="本地yum仓库搭建"></a>本地yum仓库搭建</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[root@hy-base-01 bigdata_repo]<span class="comment"># tree </span></span><br><span class="line">.</span><br><span class="line">├── CDH-6.3.2-1.cdh6.3.2.p0.1605554-el7.parcel</span><br><span class="line">├── CDH-6.3.2-1.cdh6.3.2.p0.1605554-el7.parcel.sha1</span><br><span class="line">├── CDH-6.3.2-1.cdh6.3.2.p0.1605554-el7.parcel.sha256</span><br><span class="line">├── manifest.json</span><br><span class="line">├── allkeys.asc</span><br><span class="line">├── cloudera-manager-agent-6.3.1-1466458.el7.x86_64.rpm</span><br><span class="line">├── cloudera-manager-daemons-6.3.1-1466458.el7.x86_64.rpm</span><br><span class="line">├── cloudera-manager-server-6.3.1-1466458.el7.x86_64.rpm</span><br><span class="line">├── cloudera-manager-server-db-2-6.3.1-1466458.el7.x86_64.rpm</span><br><span class="line">├── enterprise-debuginfo-6.3.1-1466458.el7.x86_64.rpm</span><br><span class="line"></span><br><span class="line">yum install -y createrepo</span><br><span class="line"><span class="built_in">cd</span> bigdata_repo</span><br><span class="line">createrepo .</span><br><span class="line"></span><br><span class="line"><span class="comment">## nginx 配置</span></span><br><span class="line">server &#123;</span><br><span class="line">        listen     80;</span><br><span class="line">        location / &#123;</span><br><span class="line">            root  /data/bigdata_repo;</span><br><span class="line">            autoindex on;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">## yum仓库配置</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cat /etc/yum.repos.d/local.repo </span></span><br><span class="line">[bigdata]</span><br><span class="line">name=bigdata</span><br><span class="line">baseurl=http://bigdata1/</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="java设置"><a href="#java设置" class="headerlink" title="java设置"></a>java设置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## mysql链接驱动</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /usr/share/java </span><br><span class="line"><span class="built_in">cp</span> mysql-connector-java-8.0.21.jar /usr/share/java/mysql-connector-java.jar</span><br><span class="line"></span><br><span class="line"><span class="comment">## 默认java</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /usr/java/</span><br><span class="line"><span class="built_in">ln</span> -s /data/soft/jdk1.8.0_301/  /usr/java/default</span><br></pre></td></tr></table></figure><h3 id="安装-服务器"><a href="#安装-服务器" class="headerlink" title="安装(服务器)"></a>安装(服务器)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">yum install -y cloudera-manager-daemons cloudera-manager-agent cloudera-manager-server</span><br><span class="line"></span><br><span class="line"><span class="comment">## 初始化数据库</span></span><br><span class="line"><span class="comment"># mysql在本地</span></span><br><span class="line">/opt/cloudera/cm/schema/scm_prepare_database.sh mysql scm scm</span><br><span class="line"><span class="comment"># mysql不在本地</span></span><br><span class="line">/opt/cloudera/cm/schema/scm_prepare_database.sh mysql -h &lt;mysql-host-ip&gt; --scm-host &lt;cm-server-ip&gt; scm scm</span><br><span class="line"></span><br><span class="line"><span class="comment">## 数据库初始化成功后启动server</span></span><br><span class="line">systemctl <span class="built_in">enable</span> cloudera-manager-agent cloudera-manager-server</span><br><span class="line">systemctl start cloudera-manager-agent cloudera-manager-server</span><br><span class="line"></span><br><span class="line"><span class="comment">## 查看日志</span></span><br><span class="line"><span class="built_in">tail</span> -f /var/log/cloudera-scm-server/cloudera-scm-server.log</span><br></pre></td></tr></table></figure><h3 id="登录界面，在界面完成其他节点安装和配置"><a href="#登录界面，在界面完成其他节点安装和配置" class="headerlink" title="登录界面，在界面完成其他节点安装和配置"></a>登录界面，在界面完成其他节点安装和配置</h3><p><a href="http://bigdata-01:7180/cmf/login">http://bigdata-01:7180/cmf/login</a>   admin&#x2F;admin</p><h3 id="按照图形界面向导安装即可"><a href="#按照图形界面向导安装即可" class="headerlink" title="按照图形界面向导安装即可"></a>按照图形界面向导安装即可</h3><p><img src="/../images/cdh_01.jpg"><br><img src="/../images/cdh_02.jpg"><br><img src="/../images/cdh_03.jpg"><br><img src="/../images/cdh_04.jpg"><br><img src="/../images/cdh_05.jpg"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Cloudera-CM-CDH6-安装&quot;&gt;&lt;a href=&quot;#Cloudera-CM-CDH6-安装&quot; class=&quot;headerlink&quot; title=&quot;Cloudera CM+CDH6 安装&quot;&gt;&lt;/a&gt;Cloudera CM+CDH6 安装&lt;/h2&gt;&lt;h3 i</summary>
      
    
    
    
    <category term="bigdata" scheme="https://biglovewheat.gihub.io/categories/bigdata/"/>
    
    
    <category term="bigdata" scheme="https://biglovewheat.gihub.io/tags/bigdata/"/>
    
  </entry>
  
  <entry>
    <title>Doris集群搭建</title>
    <link href="https://biglovewheat.gihub.io/2023/04/11/Doris%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/"/>
    <id>https://biglovewheat.gihub.io/2023/04/11/Doris%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/</id>
    <published>2023-04-10T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.724Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Doris集群搭建"><a href="#Doris集群搭建" class="headerlink" title="Doris集群搭建"></a>Doris集群搭建</h2><h3 id="清单"><a href="#清单" class="headerlink" title="清单"></a>清单</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">192.168.8.221 bigdata1  <span class="comment">## fe,be</span></span><br><span class="line">192.168.8.222 bigdata2  <span class="comment">## fe,be</span></span><br><span class="line">192.168.8.223 bigdata3  <span class="comment">## fe,be</span></span><br></pre></td></tr></table></figure><h3 id="检查CPU是否支持AVX2指令集"><a href="#检查CPU是否支持AVX2指令集" class="headerlink" title="检查CPU是否支持AVX2指令集"></a>检查CPU是否支持AVX2指令集</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /proc/cpuinfo |grep -i avx2</span><br><span class="line"></span><br><span class="line"><span class="comment">## cpu是否支持avx2命令集决定下载对应的doris版本，版本不对be可能启动不了，/var/log/message 会产生类似错误</span></span><br><span class="line">kernel: traps: palo_be[18318] <span class="built_in">trap</span> invalid opcode ip:1222ed6</span><br></pre></td></tr></table></figure><h3 id="下载安装文件"><a href="#下载安装文件" class="headerlink" title="下载安装文件"></a>下载安装文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 编译好的</span></span><br><span class="line">http://palo.baidu.com/docs/%E4%B8%8B%E8%BD%BD%E4%B8%93%E5%8C%BA/%E9%A2%84%E7%BC%96%E8%AF%91%E7%89%88%E6%9C%AC%E4%B8%8B%E8%BD%BD/</span><br><span class="line"></span><br><span class="line"><span class="comment">## 或官网下载对应版本</span></span><br><span class="line">https://doris.apache.org/zh-CN/download</span><br></pre></td></tr></table></figure><h3 id="chrony时间同步"><a href="#chrony时间同步" class="headerlink" title="chrony时间同步"></a>chrony时间同步</h3><p>时间不同步会导致doris集群出问题<br>无法访问外网的话，内网拿一台作为chrony服务端，配置如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 服务端</span></span><br><span class="line">vim /etc/chrony.conf</span><br><span class="line"></span><br><span class="line">server 0.centos.pool.ntp.org iburst</span><br><span class="line">server 1.centos.pool.ntp.org iburst</span><br><span class="line">server 2.centos.pool.ntp.org iburst</span><br><span class="line">server 3.centos.pool.ntp.org iburst</span><br><span class="line"></span><br><span class="line"><span class="comment"># Allow NTP client access from local network.</span></span><br><span class="line">allow 192.168.8.0/24</span><br><span class="line"></span><br><span class="line"><span class="comment"># Serve time even if not synchronized to a time source.</span></span><br><span class="line"><span class="built_in">local</span> stratum 10</span><br><span class="line"></span><br><span class="line"><span class="comment">#其他默认</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## client端，把服务器改成上面的地址，其他默认，配置如下：</span></span><br><span class="line"></span><br><span class="line">server hy-base-01 iburst</span><br><span class="line"></span><br><span class="line"><span class="comment">## 重启</span></span><br><span class="line">systemctl <span class="built_in">enable</span> chronyd;systemctl restart chronyd</span><br></pre></td></tr></table></figure><h3 id="关掉swap"><a href="#关掉swap" class="headerlink" title="关掉swap"></a>关掉swap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## swap开启会影响doris性能，需要关闭</span></span><br><span class="line">swapoff -a</span><br><span class="line">vi /etc/fstab</span><br><span class="line"><span class="comment">## 注释掉swap的一行</span></span><br></pre></td></tr></table></figure><h3 id="修改系统最大文件打开数"><a href="#修改系统最大文件打开数" class="headerlink" title="修改系统最大文件打开数"></a>修改系统最大文件打开数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/security/limits.conf</span><br><span class="line">* soft nofile 65535</span><br><span class="line">* hard nofile 65535</span><br><span class="line">* soft <span class="built_in">nproc</span> 65535</span><br><span class="line">* hard <span class="built_in">nproc</span> 65535</span><br><span class="line"></span><br><span class="line"><span class="comment">#重新登录看是否生效 </span></span><br><span class="line"><span class="built_in">ulimit</span> -a</span><br></pre></td></tr></table></figure><h3 id="端口规划"><a href="#端口规划" class="headerlink" title="端口规划"></a>端口规划</h3><p>由于doris默认端口都是常用的端口，很容易造成冲突，建议更改所有默认端口，这里把所有默认端口前面都加1</p><h3 id="doris配置"><a href="#doris配置" class="headerlink" title="doris配置"></a>doris配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#如本机有多个IP（比如装了docker），be和fe都需要配置使用网段</span></span><br><span class="line">priority_networks = 192.168.8.0/24</span><br></pre></td></tr></table></figure><h3 id="启动第一台fe"><a href="#启动第一台fe" class="headerlink" title="启动第一台fe"></a>启动第一台fe</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#第一次启动最好清空元元素文件件</span></span><br><span class="line"><span class="built_in">rm</span> rf fe/doris-meta/*</span><br><span class="line"><span class="comment">#启动  </span></span><br><span class="line">fe/bin/start_fe.sh</span><br></pre></td></tr></table></figure><h3 id="启动三台be"><a href="#启动三台be" class="headerlink" title="启动三台be"></a>启动三台be</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#启动</span></span><br><span class="line">be/bin/start_be.sh</span><br></pre></td></tr></table></figure><h3 id="登录第一台fe，并把3台be，2台fe注册上去，初始密码为空"><a href="#登录第一台fe，并把3台be，2台fe注册上去，初始密码为空" class="headerlink" title="登录第一台fe，并把3台be，2台fe注册上去，初始密码为空"></a>登录第一台fe，并把3台be，2台fe注册上去，初始密码为空</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql -h 192.168.8.221 -u root -P 19030 -p</span><br><span class="line"></span><br><span class="line">ALTER SYSTEM ADD BACKEND <span class="string">&quot;192.168.8.221:19050&quot;</span>;</span><br><span class="line">ALTER SYSTEM ADD BACKEND <span class="string">&quot;192.168.8.222:19050&quot;</span>;</span><br><span class="line">ALTER SYSTEM ADD BACKEND <span class="string">&quot;192.168.8.223:19050&quot;</span>;</span><br><span class="line">ALTER SYSTEM ADD FOLLOWER <span class="string">&quot;192.168.8.222:19010&quot;</span>;</span><br><span class="line">ALTER SYSTEM ADD FOLLOWER <span class="string">&quot;192.168.8.223:19010&quot;</span>;</span><br></pre></td></tr></table></figure><h3 id="启动剩余两台fe"><a href="#启动剩余两台fe" class="headerlink" title="启动剩余两台fe"></a>启动剩余两台fe</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> rf fe/doris-meta/*</span><br><span class="line"><span class="comment">#第一次启动：</span></span><br><span class="line">fe/bin/start_fe.sh  --helper 192.168.8.221:19010  --daemon</span><br><span class="line"><span class="comment">#以后可以去掉helper参数</span></span><br><span class="line">fe/bin/start_fe.sh  192.168.8.221:19010  --daemon</span><br></pre></td></tr></table></figure><h3 id="查询fe、be状态-alive均为true则为正常"><a href="#查询fe、be状态-alive均为true则为正常" class="headerlink" title="查询fe、be状态,alive均为true则为正常"></a>查询fe、be状态,alive均为true则为正常</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> PROC <span class="string">&#x27;/backends&#x27;</span>;</span><br><span class="line"><span class="keyword">SHOW</span> PROC <span class="string">&#x27;/frontends&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="修改root密码"><a href="#修改root密码" class="headerlink" title="修改root密码"></a>修改root密码</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> PASSWORD <span class="keyword">FOR</span> <span class="string">&#x27;root&#x27;</span> <span class="operator">=</span> PASSWORD(<span class="string">&#x27;root&#x27;</span>); </span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Doris集群搭建&quot;&gt;&lt;a href=&quot;#Doris集群搭建&quot; class=&quot;headerlink&quot; title=&quot;Doris集群搭建&quot;&gt;&lt;/a&gt;Doris集群搭建&lt;/h2&gt;&lt;h3 id=&quot;清单&quot;&gt;&lt;a href=&quot;#清单&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    <category term="bigdata" scheme="https://biglovewheat.gihub.io/categories/bigdata/"/>
    
    
    <category term="bigdata" scheme="https://biglovewheat.gihub.io/tags/bigdata/"/>
    
  </entry>
  
  <entry>
    <title>Mysql-忘记root密码处理</title>
    <link href="https://biglovewheat.gihub.io/2023/03/27/mysql-%E5%BF%98%E8%AE%B0root%E5%AF%86%E7%A0%81%E5%A4%84%E7%90%86/"/>
    <id>https://biglovewheat.gihub.io/2023/03/27/mysql-%E5%BF%98%E8%AE%B0root%E5%AF%86%E7%A0%81%E5%A4%84%E7%90%86/</id>
    <published>2023-03-26T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.734Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Mysql-忘记root密码处理"><a href="#Mysql-忘记root密码处理" class="headerlink" title="Mysql-忘记root密码处理"></a>Mysql-忘记root密码处理</h2><p>原理：修改配置文件&#x2F;etc&#x2F;my.cnf，在mysqld项增加skip-grant-tables，重启后跳过权限验证，登录成功后，清除root密码。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/my.cnf</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">skip-grant-tables</span><br><span class="line"><span class="comment">## 重启mysql</span></span><br><span class="line">systemctl restart mysqld</span><br><span class="line"></span><br><span class="line"><span class="comment">## 登录并清除root密码</span></span><br><span class="line">mysql -u root</span><br><span class="line"><span class="comment">### 直接回车，登录成功后清空root密码</span></span><br><span class="line">mysql&gt; use mysql;</span><br><span class="line">mysql&gt; update user <span class="built_in">set</span> authentication_string=<span class="string">&#x27;&#x27;</span> <span class="built_in">where</span> user=<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">mysql&gt; quit;</span><br><span class="line"></span><br><span class="line"><span class="comment">## 配置文件去掉skip-grant-tables，并重启动mysql</span></span><br><span class="line">systemctl restart mysqld</span><br><span class="line"><span class="comment">### 登录并修改密码</span></span><br><span class="line">mysql&gt; alter user <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified by <span class="string">&#x27;2dcP2$LWpcc1&#x27;</span>;</span><br><span class="line">mysql&gt; flush privileges;</span><br><span class="line">mysql&gt; quit</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Mysql-忘记root密码处理&quot;&gt;&lt;a href=&quot;#Mysql-忘记root密码处理&quot; class=&quot;headerlink&quot; title=&quot;Mysql-忘记root密码处理&quot;&gt;&lt;/a&gt;Mysql-忘记root密码处理&lt;/h2&gt;&lt;p&gt;原理：修改配置文件&amp;#x2F</summary>
      
    
    
    
    <category term="数据库" scheme="https://biglovewheat.gihub.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="mysql" scheme="https://biglovewheat.gihub.io/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>Linux-日志相关</title>
    <link href="https://biglovewheat.gihub.io/2023/03/03/linux-%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F/"/>
    <id>https://biglovewheat.gihub.io/2023/03/03/linux-%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F/</id>
    <published>2023-03-02T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.731Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Linux-日志相关"><a href="#Linux-日志相关" class="headerlink" title="Linux-日志相关"></a>Linux-日志相关</h2><h3 id="综述"><a href="#综述" class="headerlink" title="综述"></a>综述</h3><p>centos7系统中有两个日志服务，分别是传统的rsyslog和新添加的systemd-journal</p><h3 id="图"><a href="#图" class="headerlink" title="图"></a>图</h3><p><img src="/../images/linux%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F_01.jpg"></p><h3 id="rsyslog"><a href="#rsyslog" class="headerlink" title="rsyslog"></a>rsyslog</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 系统日志</span></span><br><span class="line">/var/log/message          //绝大多数的系统日志都记录到文件</span><br><span class="line">/var/log/secure           //所有跟安全和认知授权等日志都会记录到此文件中  *****</span><br><span class="line">/var/log/maillog          //邮件服务日志</span><br><span class="line">/var/log/cron             //计划任务日志                             *****</span><br><span class="line">/var/log/boot.log         //系统启动相关的日志</span><br><span class="line">/var/log/demsg            //系统引导日志，dmesg命令查看</span><br><span class="line"> </span><br><span class="line"><span class="comment">## 程序日志</span></span><br><span class="line">/var/log/mysql.log        //mysql日志                               *****</span><br><span class="line">...</span><br><span class="line"> </span><br><span class="line"><span class="comment">## 特殊日志，二进制文件，不能直接查看</span></span><br><span class="line">/var/log/wtmp             //登录用户信息，使用last命令                     *****</span><br><span class="line">/var/log/btmp             //最近登录用户信息，使用lastb命令               ***</span><br><span class="line">/var/log/lastlog          //所有用户登录信息，使用lastlog命令</span><br></pre></td></tr></table></figure><h3 id="systemd-journal"><a href="#systemd-journal" class="headerlink" title="systemd-journal"></a>systemd-journal</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 显示最后10条</span></span><br><span class="line">journalctl -n 100</span><br><span class="line"></span><br><span class="line"><span class="comment">## 显示err以及以上级别的系统信息</span></span><br><span class="line">journalctl -p err</span><br><span class="line"></span><br><span class="line"><span class="comment">## 滚动输出</span></span><br><span class="line">journalctl -f</span><br><span class="line"></span><br><span class="line"><span class="comment">## 查看某个服务的日志</span></span><br><span class="line">journalctl -u mysqld</span><br><span class="line"></span><br><span class="line"><span class="comment">## 某段时间的日志</span></span><br><span class="line">journalctl --since=<span class="string">&quot;2022-07-06 09:00&quot;</span> --until=<span class="string">&quot;2022-07-06 10:00&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## journald配置文件</span></span><br><span class="line"><span class="built_in">cat</span> /etc/systemd/journald.conf </span><br><span class="line"></span><br><span class="line">[Journal]</span><br><span class="line"><span class="comment">#Storage=auto</span></span><br><span class="line"><span class="comment">#Compress=yes</span></span><br><span class="line"><span class="comment">#Seal=yes</span></span><br><span class="line"><span class="comment">#SplitMode=uid</span></span><br><span class="line"><span class="comment">#SyncIntervalSec=5m</span></span><br><span class="line"><span class="comment">#RateLimitInterval=30s</span></span><br><span class="line"><span class="comment">#RateLimitBurst=1000</span></span><br><span class="line"><span class="comment">#SystemMaxUse=</span></span><br><span class="line"><span class="comment">#SystemKeepFree=</span></span><br><span class="line"><span class="comment">#SystemMaxFileSize=</span></span><br><span class="line"><span class="comment">#RuntimeMaxUse=</span></span><br><span class="line"><span class="comment">#RuntimeKeepFree=</span></span><br><span class="line"><span class="comment">#RuntimeMaxFileSize=</span></span><br><span class="line"><span class="comment">#MaxRetentionSec=</span></span><br><span class="line"><span class="comment">#MaxFileSec=1month</span></span><br><span class="line"><span class="comment">#ForwardToSyslog=yes</span></span><br><span class="line"><span class="comment">#ForwardToKMsg=no</span></span><br><span class="line"><span class="comment">#ForwardToConsole=no</span></span><br><span class="line"><span class="comment">#ForwardToWall=yes</span></span><br><span class="line"><span class="comment">#TTYPath=/dev/console</span></span><br><span class="line"><span class="comment">#MaxLevelStore=debug</span></span><br><span class="line"><span class="comment">#MaxLevelSyslog=debug</span></span><br><span class="line"><span class="comment">#MaxLevelKMsg=notice</span></span><br><span class="line"><span class="comment">#MaxLevelConsole=info</span></span><br><span class="line"><span class="comment">#MaxLevelWall=emerg</span></span><br><span class="line"><span class="comment">#LineMax=48K</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Linux-日志相关&quot;&gt;&lt;a href=&quot;#Linux-日志相关&quot; class=&quot;headerlink&quot; title=&quot;Linux-日志相关&quot;&gt;&lt;/a&gt;Linux-日志相关&lt;/h2&gt;&lt;h3 id=&quot;综述&quot;&gt;&lt;a href=&quot;#综述&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="linux" scheme="https://biglovewheat.gihub.io/categories/linux/"/>
    
    
    <category term="linux" scheme="https://biglovewheat.gihub.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>Ansible-新装系统初始化</title>
    <link href="https://biglovewheat.gihub.io/2022/12/16/ansible-%E6%96%B0%E8%A3%85%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/"/>
    <id>https://biglovewheat.gihub.io/2022/12/16/ansible-%E6%96%B0%E8%A3%85%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/</id>
    <published>2022-12-15T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.721Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Ansible-新装系统初始化"><a href="#Ansible-新装系统初始化" class="headerlink" title="Ansible-新装系统初始化"></a>Ansible-新装系统初始化</h2><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p><em>ansible是一个自动化运维工具，基于Python开发，集合了众多运维工具（puppet、cfengine、chef、func、fabric）的优点，实现了批量系统配置、批量程序部署、批量运行命令等功能。Ansible架构相对比较简单，无需agnet，仅需通过SSH连接客户机即可执行任务。</em></p><p><em>简单任务可以直接使用命令行方式运行，较复杂任务可以通过编写playbook方式运行，以下例子通过编写palybook方式，使用角色区分，简单初始化centos7。</em></p><p>语法参考：<a href="https://docs.ansible.com/ansible/latest/modules/modules_by_category.htm">https://docs.ansible.com/ansible/latest/modules/modules_by_category.htm</a><br>Ansible Galaxy命令，用于安装指定的角色或集合：<a href="https://galaxy.ansible.com/">https://galaxy.ansible.com/</a></p><h3 id="初始化文件夹"><a href="#初始化文件夹" class="headerlink" title="初始化文件夹"></a>初始化文件夹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 创建整个项目文件夹</span></span><br><span class="line"><span class="built_in">mkdir</span> ansible-init</span><br><span class="line"><span class="built_in">cd</span> ansible-init</span><br><span class="line"><span class="built_in">mkdir</span> roles</span><br><span class="line"><span class="built_in">touch</span> ansible-host.lst</span><br><span class="line"></span><br><span class="line"><span class="comment">## 初始化roles</span></span><br><span class="line"><span class="built_in">cd</span> roles</span><br><span class="line">ansible-galaxy init common</span><br><span class="line"></span><br><span class="line">ansible-init/</span><br><span class="line">├── ansible-host.lst</span><br><span class="line">└── roles</span><br><span class="line">    └── common</span><br><span class="line">        ├── defaults</span><br><span class="line">        │   └── main.yml</span><br><span class="line">        ├── files</span><br><span class="line">        ├── handlers</span><br><span class="line">        │   └── main.yml</span><br><span class="line">        ├── meta</span><br><span class="line">        │   └── main.yml</span><br><span class="line">        ├── README.md</span><br><span class="line">        ├── tasks</span><br><span class="line">        │   └── main.yml</span><br><span class="line">        ├── templates</span><br><span class="line">        ├── tests</span><br><span class="line">        │   ├── inventory</span><br><span class="line">        │   └── test.yml</span><br><span class="line">        └── vars</span><br><span class="line">            └── main.yml</span><br><span class="line"></span><br><span class="line">10 directories, 9 files</span><br></pre></td></tr></table></figure><h3 id="配置主机清单-ansible-x2F-ansible-host-lst"><a href="#配置主机清单-ansible-x2F-ansible-host-lst" class="headerlink" title="配置主机清单 ansible&#x2F;ansible-host.lst"></a>配置主机清单 ansible&#x2F;ansible-host.lst</h3><p>将主机分组，并定义变量，指明运行的用户或明文密码</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">all</span>]</span><br><span class="line"><span class="number">192.168</span><span class="number">.8</span><span class="number">.252</span>  <span class="string">hostname=vm252</span>  <span class="string">server_type=app</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.8</span><span class="number">.253</span>  <span class="string">hostname=vm252</span>  <span class="string">server_type=db</span></span><br><span class="line"></span><br><span class="line">[<span class="string">db</span>]</span><br><span class="line"><span class="number">192.168</span><span class="number">.8</span><span class="number">.253</span>  <span class="string">hostname=vm252</span>  <span class="string">server_type=db</span></span><br><span class="line"></span><br><span class="line">[<span class="string">all:vars</span>]</span><br><span class="line"><span class="string">ansible_user=root</span></span><br><span class="line"><span class="string">ansible_password=12341234</span></span><br></pre></td></tr></table></figure><h3 id="入口脚本-ansible-x2F-init-yml"><a href="#入口脚本-ansible-x2F-init-yml" class="headerlink" title="入口脚本 ansible&#x2F;init.yml"></a>入口脚本 ansible&#x2F;init.yml</h3><p>这个是整个playbook入口，可以按不同主机组运行不同角色（roles）</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="comment">## 全部运行common角色</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">all</span></span><br><span class="line">  <span class="attr">user:</span> <span class="string">root</span></span><br><span class="line">  <span class="attr">gather_facts:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">roles:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">common</span></span><br><span class="line"><span class="comment">## db组运行db1角色、db2角色</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">db</span></span><br><span class="line">  <span class="attr">user:</span> <span class="string">root</span></span><br><span class="line">  <span class="attr">gather_facts:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">roles:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">db1</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">db2</span></span><br></pre></td></tr></table></figure><h3 id="配置主脚本-ansible-x2F-roles-x2F-common-x2F-task-x2F-main-yml"><a href="#配置主脚本-ansible-x2F-roles-x2F-common-x2F-task-x2F-main-yml" class="headerlink" title="配置主脚本 ansible&#x2F;roles&#x2F;common&#x2F;task&#x2F;main.yml"></a>配置主脚本 ansible&#x2F;roles&#x2F;common&#x2F;task&#x2F;main.yml</h3><p>主脚本默认为main.yml，里面可以包含各种子任务</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">include_tasks:</span> <span class="string">set-hosts.yml</span>   </span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">include_tasks:</span> <span class="string">set-yum-repo-cdrom.yml</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">include_tasks:</span> <span class="string">set-centos7.yml</span></span><br><span class="line"><span class="comment">#- include_tasks: set-yum-repo-local.yml</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">include_tasks:</span> <span class="string">install-base-tools.yml</span></span><br><span class="line"><span class="comment">#- include_tasks: set-hy.yml</span></span><br></pre></td></tr></table></figure><h3 id="子任务1，ansible-x2F-roles-x2F-common-x2F-task-x2F-set-hosts-yml"><a href="#子任务1，ansible-x2F-roles-x2F-common-x2F-task-x2F-set-hosts-yml" class="headerlink" title="子任务1，ansible&#x2F;roles&#x2F;common&#x2F;task&#x2F;set-hosts.yml"></a>子任务1，ansible&#x2F;roles&#x2F;common&#x2F;task&#x2F;set-hosts.yml</h3><p>这里用到copy，表示会在当前roles的files文件夹里查找hosts文件，并复制到目标主机</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">set</span> <span class="string">/etc/hosts</span></span><br><span class="line">  <span class="attr">copy:</span> <span class="string">src=hosts</span> <span class="string">dest=/etc/hosts</span></span><br></pre></td></tr></table></figure><h3 id="子任务2，ansible-x2F-roles-x2F-common-x2F-task-x2F-set-yum-repo-local-yml"><a href="#子任务2，ansible-x2F-roles-x2F-common-x2F-task-x2F-set-yum-repo-local-yml" class="headerlink" title="子任务2，ansible&#x2F;roles&#x2F;common&#x2F;task&#x2F;set-yum-repo-local.yml"></a>子任务2，ansible&#x2F;roles&#x2F;common&#x2F;task&#x2F;set-yum-repo-local.yml</h3><p>这里用到template，表示会将当前roles的templates文件夹查找local.repo.j2文件，并替换里面的变量后，复制到目标主机。需要修改为变量的场景，适合使用template模块。template使用jinja2语法。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; &#125;&#125; ：用来装载表达式，比如变量、运算表达式、比较表达式等。</span><br><span class="line">&#123;% %&#125; ：用来装载控制语句，比如 if 控制结构，for循环控制结构。</span><br><span class="line">&#123;# #&#125; ：用来装载注释，模板文件被渲染后，注释不会包含在最终生成的文件中。</span><br></pre></td></tr></table></figure><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">backup</span> <span class="string">yum</span> <span class="string">repo</span> <span class="string">files</span></span><br><span class="line">  <span class="attr">shell:</span> <span class="string">&#x27;find /etc/yum.repos.d/ -name &quot;*.repo&quot; -exec mv &#123;&#125; &#123;&#125;.$(date +&quot;%Y%m%d%H%M&quot;) \;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">set</span> <span class="string">yum</span> <span class="string">repo</span></span><br><span class="line">  <span class="attr">template:</span> <span class="string">src=local.repo.j2</span> <span class="string">dest=/etc/yum.repos.d/local.repo</span></span><br></pre></td></tr></table></figure><p>用到的变量在vars&#x2F;main.yml里定义</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">prometheus:</span></span><br><span class="line">  <span class="attr">base_path:</span> <span class="string">/data/moni</span></span><br><span class="line">  <span class="attr">server:</span> <span class="number">192.168</span><span class="number">.8</span><span class="number">.201</span><span class="string">:9090</span></span><br><span class="line">  <span class="attr">consul:</span> <span class="number">192.168</span><span class="number">.8</span><span class="number">.201</span><span class="string">:18500</span></span><br><span class="line"><span class="attr">chrony:</span></span><br><span class="line">  <span class="attr">server:</span> <span class="number">192.168</span><span class="number">.8</span><span class="number">.201</span></span><br><span class="line">  <span class="attr">priority_networks:</span> <span class="number">192.168</span><span class="number">.8</span><span class="number">.0</span><span class="string">/24</span></span><br><span class="line"><span class="attr">yum:</span></span><br><span class="line">  <span class="attr">server:</span> <span class="number">192.168</span><span class="number">.8</span><span class="number">.251</span><span class="string">:18001</span></span><br></pre></td></tr></table></figure><p>template放在templates文件夹里，上面用到的是local.repo.j2</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">base</span>]</span><br><span class="line"><span class="string">name=local</span></span><br><span class="line"><span class="string">baseurl=http://&#123;&#123;</span> <span class="string">yum.server</span> <span class="string">&#125;&#125;/</span></span><br><span class="line"><span class="string">gpgcheck=0</span></span><br><span class="line"><span class="string">enabled=1</span></span><br></pre></td></tr></table></figure><h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 测试</span></span><br><span class="line">ansible-playbook -i ansible_host.lst -C init.yml</span><br><span class="line"><span class="comment">## 运行</span></span><br><span class="line">ansible-playbook -i ansible_host.lst init.yml</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>整个初始化脚本框架搭建完毕</p><p>接下来需要添加各种子脚本，然后在主脚本main.yml引入即可</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Ansible-新装系统初始化&quot;&gt;&lt;a href=&quot;#Ansible-新装系统初始化&quot; class=&quot;headerlink&quot; title=&quot;Ansible-新装系统初始化&quot;&gt;&lt;/a&gt;Ansible-新装系统初始化&lt;/h2&gt;&lt;h3 id=&quot;介绍&quot;&gt;&lt;a href=&quot;</summary>
      
    
    
    
    <category term="devops" scheme="https://biglovewheat.gihub.io/categories/devops/"/>
    
    
    <category term="ansible" scheme="https://biglovewheat.gihub.io/tags/ansible/"/>
    
    <category term="devops" scheme="https://biglovewheat.gihub.io/tags/devops/"/>
    
  </entry>
  
  <entry>
    <title>Nginx-ssl双向认证</title>
    <link href="https://biglovewheat.gihub.io/2022/12/15/nginx-ssl%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81/"/>
    <id>https://biglovewheat.gihub.io/2022/12/15/nginx-ssl%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81/</id>
    <published>2022-12-14T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.735Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Nginx-ssl双向认证"><a href="#Nginx-ssl双向认证" class="headerlink" title="Nginx-ssl双向认证"></a>Nginx-ssl双向认证</h2><h3 id="脚本-生成ca-x2F-server-x2F-client证书"><a href="#脚本-生成ca-x2F-server-x2F-client证书" class="headerlink" title="脚本-生成ca&#x2F;server&#x2F;client证书"></a>脚本-生成ca&#x2F;server&#x2F;client证书</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line">DOMAIN=<span class="string">&quot;biglovewheat.cn&quot;</span></span><br><span class="line">IP=<span class="string">&quot;192.168.0.23&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">WORK_DIR=./temp</span><br><span class="line"><span class="built_in">rm</span> -rf <span class="variable">$WORK_DIR</span></span><br><span class="line"><span class="built_in">mkdir</span> ./temp</span><br><span class="line"><span class="built_in">rm</span> -rf <span class="variable">$DOMAIN</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## CA</span></span><br><span class="line">openssl genrsa -out <span class="variable">$WORK_DIR</span>/ca.key 4096</span><br><span class="line"> </span><br><span class="line">openssl req -x509 -new -nodes -sha512 -days 3650 \</span><br><span class="line">  -subj <span class="string">&quot;/C=CN/ST=Beijing/L=Beijing/O=example/OU=Personal/CN=<span class="variable">$DOMAIN</span>&quot;</span> \</span><br><span class="line">  -key <span class="variable">$WORK_DIR</span>/ca.key \</span><br><span class="line">  -out <span class="variable">$WORK_DIR</span>/ca.crt</span><br><span class="line"></span><br><span class="line"><span class="comment">## server</span></span><br><span class="line">openssl genrsa -out <span class="variable">$WORK_DIR</span>/server.key 4096</span><br><span class="line"> </span><br><span class="line">openssl req -sha512 -new \</span><br><span class="line">  -subj <span class="string">&quot;/C=CN/ST=Beijing/L=Beijing/O=example/OU=Personal/CN=<span class="variable">$DOMAIN</span>&quot;</span> \</span><br><span class="line">  -key <span class="variable">$WORK_DIR</span>/server.key \</span><br><span class="line">  -out <span class="variable">$WORK_DIR</span>/server.csr</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt; <span class="variable">$WORK_DIR</span>/server.ext &lt;&lt;-<span class="string">EOF</span></span><br><span class="line"><span class="string">authorityKeyIdentifier=keyid,issuer</span></span><br><span class="line"><span class="string">basicConstraints=CA:FALSE</span></span><br><span class="line"><span class="string">keyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment</span></span><br><span class="line"><span class="string">extendedKeyUsage = serverAuth</span></span><br><span class="line"><span class="string">subjectAltName = @alt_names</span></span><br><span class="line"><span class="string">[alt_names]</span></span><br><span class="line"><span class="string">DNS.1=$DOMAIN</span></span><br><span class="line"><span class="string">DNS.2=*.$DOMAIN</span></span><br><span class="line"><span class="string">IP.1=$IP</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">## server visa</span></span><br><span class="line">openssl x509 -req -sha512 -days 3650 \</span><br><span class="line">  -extfile <span class="variable">$WORK_DIR</span>/server.ext \</span><br><span class="line">  -CA <span class="variable">$WORK_DIR</span>/ca.crt -CAkey <span class="variable">$WORK_DIR</span>/ca.key -CAcreateserial \</span><br><span class="line">  -<span class="keyword">in</span> <span class="variable">$WORK_DIR</span>/server.csr \</span><br><span class="line">  -out <span class="variable">$WORK_DIR</span>/server.crt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## client</span></span><br><span class="line">openssl genrsa -out <span class="variable">$WORK_DIR</span>/client-ca.key 2048</span><br><span class="line">openssl req -x509 -new -nodes -key <span class="variable">$WORK_DIR</span>/client-ca.key -subj <span class="string">&quot;/CN=ca.client&quot;</span> -days 3650 -out <span class="variable">$WORK_DIR</span>/client-ca.crt</span><br><span class="line">openssl genrsa -out <span class="variable">$WORK_DIR</span>/client.key 2048</span><br><span class="line">openssl req -new -key <span class="variable">$WORK_DIR</span>/client.key -subj <span class="string">&quot;/CN=client&quot;</span> -out <span class="variable">$WORK_DIR</span>/client.csr</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt; <span class="variable">$WORK_DIR</span>/client.ext &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">extendedKeyUsage=clientAuth</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">openssl x509 -req -<span class="keyword">in</span> <span class="variable">$WORK_DIR</span>/client.csr -CA <span class="variable">$WORK_DIR</span>/client-ca.crt -CAkey <span class="variable">$WORK_DIR</span>/client-ca.key -CAcreateserial \</span><br><span class="line"> -extfile <span class="variable">$WORK_DIR</span>/client.ext -out <span class="variable">$WORK_DIR</span>/client.crt -days 3650</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">## output </span></span><br><span class="line"><span class="built_in">mkdir</span> -p ./<span class="variable">$DOMAIN</span></span><br><span class="line"><span class="built_in">cp</span> <span class="variable">$WORK_DIR</span>/*.crt  <span class="variable">$WORK_DIR</span>/*.key ./<span class="variable">$DOMAIN</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## convert to pfx</span></span><br><span class="line"></span><br><span class="line">openssl pkcs12 -<span class="built_in">export</span> -inkey ./<span class="variable">$DOMAIN</span>/client.key -<span class="keyword">in</span> ./<span class="variable">$DOMAIN</span>/client.crt -out ./<span class="variable">$DOMAIN</span>/client.pfx</span><br></pre></td></tr></table></figure><h3 id="nginx-配置"><a href="#nginx-配置" class="headerlink" title="nginx 配置"></a>nginx 配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen     80;</span><br><span class="line">    listen       443 ssl;</span><br><span class="line"></span><br><span class="line">    ssl_certificate      /data/openssl-test/biglovewheat.cn/server.crt;</span><br><span class="line">    ssl_certificate_key  /data/openssl-test/biglovewheat.cn/server.key;</span><br><span class="line"></span><br><span class="line">    ssl_client_certificate /data/openssl-test/biglovewheat.cn/client-ca.crt;</span><br><span class="line">    ssl_verify_client on;</span><br><span class="line"></span><br><span class="line">    ssl_verify_depth 3;</span><br><span class="line"></span><br><span class="line">    ssl_session_timeout 5m;</span><br><span class="line">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">    ssl_ciphers ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">            root  /data/webapp/www;</span><br><span class="line">    <span class="keyword">if</span> (!-e <span class="variable">$request_filename</span>)&#123;</span><br><span class="line">        rewrite ^(.*)$ /<span class="variable">$1</span>.html last;</span><br><span class="line">        <span class="built_in">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">#        try_files $uri $uri/ /index.html;</span></span><br><span class="line">        index index.html;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p>不带clinet证书，报400-No required SSL certificate was sent</p><p>带client证书和key，正常访问</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@hw-gz-1 biglovewheat.cn]<span class="comment"># curl  https://www.biglovewheat.cn -k </span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;<span class="built_in">head</span>&gt;&lt;title&gt;400 No required SSL certificate was sent&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;400 Bad Request&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;center&gt;No required SSL certificate was sent&lt;/center&gt;</span><br><span class="line">&lt;hr&gt;&lt;center&gt;nginx/1.20.1&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">[root@hw-gz-1 biglovewheat.cn]<span class="comment"># curl --cert ./client.crt --key ./client.key https://www.biglovewheat.cn -k </span></span><br><span class="line">www</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="windows浏览器访问"><a href="#windows浏览器访问" class="headerlink" title="windows浏览器访问"></a>windows浏览器访问</h3><p>导出pfx格式，可加密码，双击安装后，重启浏览器即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 脚本最后一步，转成pfx格式</span></span><br><span class="line">openssl pkcs12 -<span class="built_in">export</span> -inkey ./<span class="variable">$DOMAIN</span>/client.key -<span class="keyword">in</span> ./<span class="variable">$DOMAIN</span>/client.crt -out ./<span class="variable">$DOMAIN</span>/client.pfx</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Nginx-ssl双向认证&quot;&gt;&lt;a href=&quot;#Nginx-ssl双向认证&quot; class=&quot;headerlink&quot; title=&quot;Nginx-ssl双向认证&quot;&gt;&lt;/a&gt;Nginx-ssl双向认证&lt;/h2&gt;&lt;h3 id=&quot;脚本-生成ca-x2F-server-x2</summary>
      
    
    
    
    <category term="middleware" scheme="https://biglovewheat.gihub.io/categories/middleware/"/>
    
    
    <category term="nginx" scheme="https://biglovewheat.gihub.io/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>Consul-启动失败排查</title>
    <link href="https://biglovewheat.gihub.io/2022/12/13/consul-%E5%90%AF%E5%8A%A8%E5%A4%B1%E8%B4%A5%E6%8E%92%E6%9F%A5/"/>
    <id>https://biglovewheat.gihub.io/2022/12/13/consul-%E5%90%AF%E5%8A%A8%E5%A4%B1%E8%B4%A5%E6%8E%92%E6%9F%A5/</id>
    <published>2022-12-12T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.724Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Consul-不能启动问题排查"><a href="#Consul-不能启动问题排查" class="headerlink" title="Consul-不能启动问题排查"></a>Consul-不能启动问题排查</h2><h3 id="现象"><a href="#现象" class="headerlink" title="现象"></a>现象</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">supervisorctl status</span><br><span class="line"></span><br><span class="line">alertmanager                     RUNNING   pid 2910405, <span class="built_in">uptime</span> 1 day, 22:39:07</span><br><span class="line">consul                           FATAL     Exited too quickly (process <span class="built_in">log</span> may have details)</span><br><span class="line">prometheus                       RUNNING   pid 1842, <span class="built_in">uptime</span> 1299 days, 16:51:21</span><br><span class="line">prometheus-webhook-dingtalk      STOPPED   Jul 04 03:47 PM</span><br></pre></td></tr></table></figure><h3 id="查看日志"><a href="#查看日志" class="headerlink" title="查看日志"></a>查看日志</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tail</span> -f supervisord.log-20220704 </span><br><span class="line">2022-07-04 15:50:43,730 INFO gave up: consul entered FATAL state, too many start retries too quickly</span><br><span class="line">2022-07-06 14:27:46,651 INFO spawned: <span class="string">&#x27;consul&#x27;</span> with pid 1248136</span><br><span class="line">2022-07-06 14:27:46,854 INFO exited: consul (<span class="built_in">exit</span> status 1; not expected)</span><br><span class="line">2022-07-06 14:27:47,855 INFO spawned: <span class="string">&#x27;consul&#x27;</span> with pid 1248446</span><br><span class="line">2022-07-06 14:27:48,043 INFO exited: consul (<span class="built_in">exit</span> status 1; not expected)</span><br><span class="line">2022-07-06 14:27:50,046 INFO spawned: <span class="string">&#x27;consul&#x27;</span> with pid 1248797</span><br><span class="line">2022-07-06 14:27:50,599 INFO exited: consul (<span class="built_in">exit</span> status 1; not expected)</span><br><span class="line">2022-07-06 14:27:53,602 INFO spawned: <span class="string">&#x27;consul&#x27;</span> with pid 1249389</span><br><span class="line">2022-07-06 14:27:53,847 INFO exited: consul (<span class="built_in">exit</span> status 1; not expected)</span><br><span class="line">2022-07-06 14:27:54,847 INFO gave up: consul entered FATAL state, too many start retries too quickly</span><br></pre></td></tr></table></figure><h3 id="再次排查"><a href="#再次排查" class="headerlink" title="再次排查"></a>再次排查</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">supervisorctl  <span class="built_in">tail</span> consul stdout</span><br><span class="line">.245:8301: <span class="built_in">bind</span>: address already <span class="keyword">in</span> use</span><br><span class="line">bootstrap_expect = 2: A cluster with 2 servers will provide no failure tolerance. See https://www.consul.io/docs/internals/consensus.html<span class="comment">#deployment-table</span></span><br><span class="line">bootstrap_expect &gt; 0: expecting 2 servers</span><br><span class="line">==&gt; Starting Consul agent...</span><br><span class="line">==&gt; Error starting agent: Failed to start Consul server: Failed to start LAN Serf: Failed to create memberlist: Could not <span class="built_in">set</span> up network transport: failed to obtain an address: Failed to start TCP listener on <span class="string">&quot;10.9.127.245&quot;</span> port 8301: listen tcp 10.9.127.245:8301: <span class="built_in">bind</span>: address already <span class="keyword">in</span> use</span><br><span class="line">bootstrap_expect = 2: A cluster with 2 servers will provide no failure tolerance. See https://www.consul.io/docs/internals/consensus.html<span class="comment">#deployment-table</span></span><br><span class="line">bootstrap_expect &gt; 0: expecting 2 servers</span><br><span class="line">==&gt; Starting Consul agent...</span><br><span class="line">==&gt; Error starting agent: Failed to start Consul server: Failed to start LAN Serf: Failed to create memberlist: Could not <span class="built_in">set</span> up network transport: failed to obtain an address: Failed to start TCP listener on <span class="string">&quot;10.9.127.245&quot;</span> port 8301: listen tcp 10.9.127.245:8301: <span class="built_in">bind</span>: address already <span class="keyword">in</span> use</span><br><span class="line">bootstrap_expect = 2: A cluster with 2 servers will provide no failure tolerance. See https://www.consul.io/docs/internals/consensus.html<span class="comment">#deployment-table</span></span><br><span class="line">bootstrap_expect &gt; 0: expecting 2 servers</span><br><span class="line">==&gt; Starting Consul agent...</span><br><span class="line">==&gt; Error starting agent: Failed to start Consul server: Failed to start LAN Serf: Failed to create memberlist: Could not <span class="built_in">set</span> up network transport: failed to obtain an address: Failed to start TCP listener on <span class="string">&quot;10.9.127.245&quot;</span> port 8301: listen tcp 10.9.127.245:8301: <span class="built_in">bind</span>: address already <span class="keyword">in</span> use</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## address already in use --&gt; 端口被占用，清理端口后重新启动即可</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Consul-不能启动问题排查&quot;&gt;&lt;a href=&quot;#Consul-不能启动问题排查&quot; class=&quot;headerlink&quot; title=&quot;Consul-不能启动问题排查&quot;&gt;&lt;/a&gt;Consul-不能启动问题排查&lt;/h2&gt;&lt;h3 id=&quot;现象&quot;&gt;&lt;a href=&quot;</summary>
      
    
    
    
    <category term="故障排查" scheme="https://biglovewheat.gihub.io/categories/%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5/"/>
    
    
    <category term="consul" scheme="https://biglovewheat.gihub.io/tags/consul/"/>
    
    <category term="supervisor" scheme="https://biglovewheat.gihub.io/tags/supervisor/"/>
    
  </entry>
  
  <entry>
    <title>Java-启动参数修改</title>
    <link href="https://biglovewheat.gihub.io/2022/12/13/java-%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0%E4%BF%AE%E6%94%B9/"/>
    <id>https://biglovewheat.gihub.io/2022/12/13/java-%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0%E4%BF%AE%E6%94%B9/</id>
    <published>2022-12-12T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.727Z</updated>
    
    <content type="html"><![CDATA[<h2 id="java启动参数修改"><a href="#java启动参数修改" class="headerlink" title="java启动参数修改"></a>java启动参数修改</h2><h3 id="java8转换成java11参数修改"><a href="#java8转换成java11参数修改" class="headerlink" title="java8转换成java11参数修改"></a>java8转换成java11参数修改</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## java8</span></span><br><span class="line">JAVA_OPS=<span class="string">&quot;-Xms512m -Xmx2g -Xmn1g -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=<span class="variable">$&#123;LOG_HOME&#125;</span>/analyzeGc/ -XX:+PrintGCDetails -verbosegc -Xloggc:<span class="variable">$&#123;LOG_HOME&#125;</span>/analyzeGc/gc.<span class="variable">$&#123;svc&#125;</span>.log&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 启动报warning</span></span><br><span class="line">[0.001s][warning][gc] -Xloggc is deprecated. Will use -Xlog:gc:/data/logs/analyzeGc/gc.hx-task.log instead.</span><br><span class="line">[0.002s][warning][gc] -XX:+PrintGCDetails is deprecated. Will use -Xlog:gc* instead.</span><br><span class="line"></span><br><span class="line"><span class="comment">## java11</span></span><br><span class="line">JAVA_OPS=<span class="string">&quot;-Xms512m -Xmx1g -Xmn512m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=<span class="variable">$&#123;LOG_HOME&#125;</span>/analyzeGc/ -Xlog:gc*  -verbosegc -Xlog:gc:<span class="variable">$&#123;LOG_HOME&#125;</span>/analyzeGc/gc.<span class="variable">$&#123;svc&#125;</span>.log&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;java启动参数修改&quot;&gt;&lt;a href=&quot;#java启动参数修改&quot; class=&quot;headerlink&quot; title=&quot;java启动参数修改&quot;&gt;&lt;/a&gt;java启动参数修改&lt;/h2&gt;&lt;h3 id=&quot;java8转换成java11参数修改&quot;&gt;&lt;a href=&quot;#jav</summary>
      
    
    
    
    <category term="java" scheme="https://biglovewheat.gihub.io/categories/java/"/>
    
    
    <category term="java" scheme="https://biglovewheat.gihub.io/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>数据库隔离级别</title>
    <link href="https://biglovewheat.gihub.io/2022/12/06/%E6%95%B0%E6%8D%AE%E5%BA%93%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/"/>
    <id>https://biglovewheat.gihub.io/2022/12/06/%E6%95%B0%E6%8D%AE%E5%BA%93%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/</id>
    <published>2022-12-05T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.743Z</updated>
    
    <content type="html"><![CDATA[<h2 id="数据库隔离级别"><a href="#数据库隔离级别" class="headerlink" title="数据库隔离级别"></a>数据库隔离级别</h2><p><img src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB_01.jpg"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;数据库隔离级别&quot;&gt;&lt;a href=&quot;#数据库隔离级别&quot; class=&quot;headerlink&quot; title=&quot;数据库隔离级别&quot;&gt;&lt;/a&gt;数据库隔离级别&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/../images/%E6%95%B0%E6%8D%AE%E5%BA%93%E</summary>
      
    
    
    
    <category term="基础概念" scheme="https://biglovewheat.gihub.io/categories/%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    
    
    <category term="database" scheme="https://biglovewheat.gihub.io/tags/database/"/>
    
  </entry>
  
  <entry>
    <title>Arthas-java性能分析工具</title>
    <link href="https://biglovewheat.gihub.io/2022/12/05/arthas-java%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/"/>
    <id>https://biglovewheat.gihub.io/2022/12/05/arthas-java%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/</id>
    <published>2022-12-04T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.721Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Arthas-java性能分析工具"><a href="#Arthas-java性能分析工具" class="headerlink" title="Arthas-java性能分析工具"></a>Arthas-java性能分析工具</h2><h3 id="Arthas简介"><a href="#Arthas简介" class="headerlink" title="Arthas简介"></a>Arthas简介</h3><p><em>Arthas 是阿里开源的 Java 诊断工具</em></p><p><a href="https://arthas.aliyun.com/doc/">https://arthas.aliyun.com/doc/</a></p><h3 id="安装使用"><a href="#安装使用" class="headerlink" title="安装使用"></a>安装使用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## github下载</span></span><br><span class="line"></span><br><span class="line">wget https://github.com/alibaba/arthas/releases/download/arthas-all-3.6.7/arthas-bin.zip</span><br><span class="line"></span><br><span class="line"><span class="comment">## 解压</span></span><br><span class="line">unzip arthas-all-3.6.7/arthas-bin.zip</span><br><span class="line"></span><br><span class="line"><span class="comment">## 运行</span></span><br><span class="line">./as.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">## 选择需要监控的java进程</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 常用命令</span></span><br><span class="line">dashboard</span><br><span class="line"></span><br><span class="line"><span class="comment">## 更多详见帮助</span></span><br><span class="line"><span class="built_in">help</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 退出</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Arthas-java性能分析工具&quot;&gt;&lt;a href=&quot;#Arthas-java性能分析工具&quot; class=&quot;headerlink&quot; title=&quot;Arthas-java性能分析工具&quot;&gt;&lt;/a&gt;Arthas-java性能分析工具&lt;/h2&gt;&lt;h3 id=&quot;Artha</summary>
      
    
    
    
    <category term="监控" scheme="https://biglovewheat.gihub.io/categories/%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="java" scheme="https://biglovewheat.gihub.io/tags/java/"/>
    
    <category term="监控" scheme="https://biglovewheat.gihub.io/tags/%E7%9B%91%E6%8E%A7/"/>
    
  </entry>
  
  <entry>
    <title>K8s-允许master节点参与调度</title>
    <link href="https://biglovewheat.gihub.io/2022/12/05/k8s-%E5%85%81%E8%AE%B8master%E8%8A%82%E7%82%B9%E5%8F%82%E4%B8%8E%E8%B0%83%E5%BA%A6/"/>
    <id>https://biglovewheat.gihub.io/2022/12/05/k8s-%E5%85%81%E8%AE%B8master%E8%8A%82%E7%82%B9%E5%8F%82%E4%B8%8E%E8%B0%83%E5%BA%A6/</id>
    <published>2022-12-04T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.730Z</updated>
    
    <content type="html"><![CDATA[<h2 id="k8s-允许master节点参与调度"><a href="#k8s-允许master节点参与调度" class="headerlink" title="k8s-允许master节点参与调度"></a>k8s-允许master节点参与调度</h2><p>默认情况下，master由于有node-role.kubernetes.io&#x2F;master:NoSchedule污点，不参与任务调度。想让master节点参与任务调度，需去除此污点</p><h3 id="去除污点"><a href="#去除污点" class="headerlink" title="去除污点"></a>去除污点</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">出去污点</span><br><span class="line"><span class="comment"># 查看node</span></span><br><span class="line">kubectl get nodes</span><br><span class="line"><span class="comment"># 查看污点</span></span><br><span class="line">kubectl describe node k8s-master |grep Taints </span><br><span class="line">Taints:    node-role.kubernetes.io/master:NoSchedule  </span><br><span class="line"><span class="comment"># 去除污点 </span></span><br><span class="line">kubectl taint nodes --all node-role.kubernetes.io/master-</span><br><span class="line"></span><br><span class="line">添加master为worker角色(可选)</span><br><span class="line"><span class="comment"># 让master节点参与调度，#如果想删除，把=换成-</span></span><br><span class="line">kubectl label nodes k8s-master node-role.kubernetes.io/worker=</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;k8s-允许master节点参与调度&quot;&gt;&lt;a href=&quot;#k8s-允许master节点参与调度&quot; class=&quot;headerlink&quot; title=&quot;k8s-允许master节点参与调度&quot;&gt;&lt;/a&gt;k8s-允许master节点参与调度&lt;/h2&gt;&lt;p&gt;默认情况下，</summary>
      
    
    
    
    <category term="devops" scheme="https://biglovewheat.gihub.io/categories/devops/"/>
    
    
    <category term="devops" scheme="https://biglovewheat.gihub.io/tags/devops/"/>
    
    <category term="k8s" scheme="https://biglovewheat.gihub.io/tags/k8s/"/>
    
  </entry>
  
  <entry>
    <title>Linux-时区操作</title>
    <link href="https://biglovewheat.gihub.io/2022/12/05/linux-%E6%97%B6%E5%8C%BA%E6%93%8D%E4%BD%9C/"/>
    <id>https://biglovewheat.gihub.io/2022/12/05/linux-%E6%97%B6%E5%8C%BA%E6%93%8D%E4%BD%9C/</id>
    <published>2022-12-04T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.732Z</updated>
    
    <content type="html"><![CDATA[<h2 id="linux-时区操作"><a href="#linux-时区操作" class="headerlink" title="linux-时区操作"></a>linux-时区操作</h2><h3 id="ubuntu-x2F-centos-更改时区"><a href="#ubuntu-x2F-centos-更改时区" class="headerlink" title="ubuntu&#x2F;centos 更改时区"></a>ubuntu&#x2F;centos 更改时区</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">timedatectl list-timezones |grep -i shanghai</span><br><span class="line">timedatectl set-timezone Asia/Shanghai</span><br></pre></td></tr></table></figure><h3 id="alpine-更改时区"><a href="#alpine-更改时区" class="headerlink" title="alpine 更改时区"></a>alpine 更改时区</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> -a /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;linux-时区操作&quot;&gt;&lt;a href=&quot;#linux-时区操作&quot; class=&quot;headerlink&quot; title=&quot;linux-时区操作&quot;&gt;&lt;/a&gt;linux-时区操作&lt;/h2&gt;&lt;h3 id=&quot;ubuntu-x2F-centos-更改时区&quot;&gt;&lt;a href=&quot;</summary>
      
    
    
    
    <category term="linux" scheme="https://biglovewheat.gihub.io/categories/linux/"/>
    
    
    <category term="linux" scheme="https://biglovewheat.gihub.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>Postgresql-创建只读用户</title>
    <link href="https://biglovewheat.gihub.io/2022/12/05/postgresql-%E5%88%9B%E5%BB%BA%E5%8F%AA%E8%AF%BB%E7%94%A8%E6%88%B7/"/>
    <id>https://biglovewheat.gihub.io/2022/12/05/postgresql-%E5%88%9B%E5%BB%BA%E5%8F%AA%E8%AF%BB%E7%94%A8%E6%88%B7/</id>
    <published>2022-12-04T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.738Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Postgresql-创建只读用户"><a href="#Postgresql-创建只读用户" class="headerlink" title="Postgresql-创建只读用户"></a>Postgresql-创建只读用户</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> bigdata <span class="keyword">with</span> password <span class="string">&#x27;ch2)x7jzReZN&#x27;</span>;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> bigdata <span class="keyword">set</span> default_transaction_read_only<span class="operator">=</span><span class="keyword">on</span>;</span><br><span class="line"><span class="keyword">GRANT</span> USAGE <span class="keyword">ON</span> SCHEMA public <span class="keyword">to</span> bigdata;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> <span class="keyword">all</span> tables <span class="keyword">in</span> schema public <span class="keyword">to</span> bigdata;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Postgresql-创建只读用户&quot;&gt;&lt;a href=&quot;#Postgresql-创建只读用户&quot; class=&quot;headerlink&quot; title=&quot;Postgresql-创建只读用户&quot;&gt;&lt;/a&gt;Postgresql-创建只读用户&lt;/h2&gt;&lt;figure class</summary>
      
    
    
    
    <category term="数据库" scheme="https://biglovewheat.gihub.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="postgresql" scheme="https://biglovewheat.gihub.io/tags/postgresql/"/>
    
  </entry>
  
  <entry>
    <title>Shell-备份工具</title>
    <link href="https://biglovewheat.gihub.io/2022/12/05/shell-%E5%A4%87%E4%BB%BD%E5%B7%A5%E5%85%B7/"/>
    <id>https://biglovewheat.gihub.io/2022/12/05/shell-%E5%A4%87%E4%BB%BD%E5%B7%A5%E5%85%B7/</id>
    <published>2022-12-04T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.741Z</updated>
    
    <content type="html"><![CDATA[<h2 id="shell-备份工具"><a href="#shell-备份工具" class="headerlink" title="shell-备份工具"></a>shell-备份工具</h2><p><em>一个自己写的shell脚本备份工具</em></p><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 主配置文件</span></span><br><span class="line"><span class="built_in">cat</span> backup.lst </span><br><span class="line"><span class="comment">#1pg|2gis_sit|3IP|4Port|5user|6password|7cycle|</span></span><br><span class="line">pg|gis_sit|172.31.34.25|5083|postgres|abc123!!!|days|</span><br><span class="line">pg|gis_prod|172.31.56.16|5083|postgres|abc123!!!|days|</span><br><span class="line">pg|gis_jx|172.31.71.117|5083|postgres|abc123!!!|days|</span><br><span class="line">pg|gis_old_lite|172.31.45.42|5083|postgres|abc123!!!|days|</span><br><span class="line">pg|gis_old|172.31.45.42|5083|postgres|abc123!!!|weeks|</span><br><span class="line">mysql|jx|3|4|5|6|days|</span><br><span class="line">mysql|sit|3|4|5|6|days|</span><br><span class="line">mysql|show|3|4|5|6|days|</span><br><span class="line">mysql|prod|3|4|5|6|days|</span><br><span class="line">mysql|wiki|3|4|5|6|days|</span><br><span class="line">mysql|bigdata|3|4|5|6|days|</span><br><span class="line"></span><br><span class="line"><span class="comment">## mysql-client配置文件</span></span><br><span class="line"><span class="built_in">cat</span> ./mysql_cnf/jx.lst </span><br><span class="line">[client]</span><br><span class="line">user=root</span><br><span class="line">password=abc123!!!</span><br><span class="line">host=172.31.71.117</span><br><span class="line">port=3306</span><br><span class="line"></span><br><span class="line"><span class="comment">## ansible配置</span></span><br><span class="line"><span class="built_in">cat</span> ansible_host.lst</span><br><span class="line">[nginx_default]</span><br><span class="line">aws-prod-app-01</span><br><span class="line">aws-prod-app-02</span><br><span class="line">aws-prod-app-03</span><br><span class="line">aws-prod-app-04</span><br><span class="line">aws-prod-app-05</span><br><span class="line">aws-sit-app-01</span><br><span class="line">aws-sit-app-02</span><br><span class="line">aws-sit-app-04</span><br><span class="line">aws-show-app-01</span><br><span class="line"></span><br><span class="line">[nginx_data]</span><br><span class="line">aws-jx-app-01</span><br><span class="line">aws-jx-app-02</span><br><span class="line"></span><br><span class="line">[nginx_default:vars]</span><br><span class="line">ansible_user=ops_root</span><br><span class="line">ansible_password=dNqzrKHu8UQsuxcX</span><br><span class="line"></span><br><span class="line">[nginx_data:vars]</span><br><span class="line">ansible_user=ops_root</span><br><span class="line">ansible_password=dNqzrKHu8UQsuxcX</span><br></pre></td></tr></table></figure><h3 id="主脚本"><a href="#主脚本" class="headerlink" title="主脚本"></a>主脚本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">DATETIME=$(<span class="built_in">date</span> +<span class="string">&quot;%Y%m%d%H%M&quot;</span>)</span><br><span class="line">ROOT=/data/backup</span><br><span class="line">v_backuplist=<span class="variable">$ROOT</span>/backup.lst</span><br><span class="line">v_weekday=$(<span class="built_in">date</span> +%w)</span><br><span class="line">v_day=$(<span class="built_in">date</span> +%d)</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$ROOT</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;***********************************************************************&quot;</span></span><br><span class="line"><span class="built_in">echo</span> $(<span class="built_in">date</span>) <span class="string">&quot; -- backup bgein&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;***********************************************************************&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## backup</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> $(<span class="built_in">cat</span> <span class="variable">$v_backuplist</span>|grep -v ^$|grep -v ^<span class="comment">#)</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="comment">#pg|gis-sit|172.31.34.25|5083|postgres|Hxkj2022!!!|</span></span><br><span class="line">    v_type=$(<span class="built_in">echo</span> <span class="variable">$row</span> |awk -F\| <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class="line">    v_name=$(<span class="built_in">echo</span> <span class="variable">$row</span> |awk -F\| <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">    v_ip=$(<span class="built_in">echo</span> <span class="variable">$row</span> |awk -F\| <span class="string">&#x27;&#123;print $3&#125;&#x27;</span>)</span><br><span class="line">    v_port=$(<span class="built_in">echo</span> <span class="variable">$row</span> |awk -F\| <span class="string">&#x27;&#123;print $4&#125;&#x27;</span>)</span><br><span class="line">    v_user=$(<span class="built_in">echo</span> <span class="variable">$row</span> |awk -F\| <span class="string">&#x27;&#123;print $5&#125;&#x27;</span>)</span><br><span class="line">    v_pass=$(<span class="built_in">echo</span> <span class="variable">$row</span> |awk -F\| <span class="string">&#x27;&#123;print $6&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$v_type</span> <span class="keyword">in</span></span><br><span class="line">    pg)</span><br><span class="line">        <span class="built_in">export</span> PGPASSWORD=<span class="variable">$v_pass</span></span><br><span class="line">        <span class="keyword">case</span> <span class="variable">$v_name</span> <span class="keyword">in</span></span><br><span class="line">        gis_old_lite)</span><br><span class="line">            v_backupfile=<span class="variable">$&#123;v_type&#125;</span>_<span class="variable">$&#123;v_name&#125;</span>_<span class="variable">$&#123;DATETIME&#125;</span>.tar</span><br><span class="line">            pg_dumpall -h <span class="variable">$v_ip</span> -U <span class="variable">$v_user</span> -p <span class="variable">$v_port</span> --exclude-database=common -c --if-exists |gzip &gt; <span class="variable">$&#123;v_type&#125;</span>_<span class="variable">$&#123;v_name&#125;</span>_<span class="variable">$&#123;DATETIME&#125;</span>.1.sql.gz</span><br><span class="line">            pg_dump -h <span class="variable">$v_ip</span> -U <span class="variable">$v_user</span> -p <span class="variable">$v_port</span> --dbname=common --exclude-schema=offline_map -c --if-exists|gzip &gt; <span class="variable">$&#123;v_type&#125;</span>_<span class="variable">$&#123;v_name&#125;</span>_<span class="variable">$&#123;DATETIME&#125;</span>.2.sql.gz</span><br><span class="line">            tar -cvf <span class="variable">$v_backupfile</span> <span class="variable">$&#123;v_type&#125;</span>_<span class="variable">$&#123;v_name&#125;</span>_<span class="variable">$&#123;DATETIME&#125;</span>.*.sql.gz --remove-files</span><br><span class="line">            /usr/local/bin/aws s3 <span class="built_in">cp</span> <span class="variable">$v_backupfile</span> s3://hxs3/backup/</span><br><span class="line"><span class="comment">#            if [[ &quot;v$&#123;v_day&#125;&quot; == &quot;v01&quot; ]] || [[ &quot;v$&#123;v_day&#125;&quot; == &quot;v15&quot; ]]; then /usr/local/bin/aws s3 cp $v_backupfile s3://hxs3/backup/ s3://hxarchive/永久备份/; fi</span></span><br><span class="line">        ;;</span><br><span class="line">        gis_old)</span><br><span class="line">            <span class="keyword">if</span> [[ <span class="string">&quot;v<span class="variable">$&#123;v_weekday&#125;</span>&quot;</span> == <span class="string">&quot;v6&quot;</span> ]]</span><br><span class="line">            <span class="keyword">then</span></span><br><span class="line">                v_backupfile=<span class="variable">$&#123;v_type&#125;</span>_<span class="variable">$&#123;v_name&#125;</span>_<span class="variable">$&#123;DATETIME&#125;</span>.sql.gz</span><br><span class="line">                pg_dumpall -h <span class="variable">$v_ip</span> -U <span class="variable">$v_user</span> -p <span class="variable">$v_port</span> -c --if-exists |gzip &gt; <span class="variable">$v_backupfile</span></span><br><span class="line">                /usr/local/bin/aws s3 <span class="built_in">cp</span> <span class="variable">$v_backupfile</span> s3://hxs3/backup/</span><br><span class="line">            <span class="keyword">fi</span></span><br><span class="line">        ;;</span><br><span class="line">        *)</span><br><span class="line">            v_backupfile=<span class="variable">$&#123;v_type&#125;</span>_<span class="variable">$&#123;v_name&#125;</span>_<span class="variable">$&#123;DATETIME&#125;</span>.sql.gz</span><br><span class="line">            pg_dumpall -h <span class="variable">$v_ip</span> -U <span class="variable">$v_user</span> -p <span class="variable">$v_port</span> -c --if-exists |gzip &gt; <span class="variable">$v_backupfile</span></span><br><span class="line">            /usr/local/bin/aws s3 <span class="built_in">cp</span> <span class="variable">$v_backupfile</span> s3://hxs3/backup/</span><br><span class="line"><span class="comment">#            if [[ &quot;v$&#123;v_day&#125;&quot; == &quot;v01&quot; ]] || [[ &quot;v$&#123;v_day&#125;&quot; == &quot;v15&quot; ]]; then /usr/local/bin/aws s3 cp $v_backupfile s3://hxs3/backup/ s3://hxarchive/永久备份/; fi</span></span><br><span class="line">        ;;</span><br><span class="line">        <span class="keyword">esac</span></span><br><span class="line">    ;;</span><br><span class="line">    mysql)</span><br><span class="line">        v_mysqllst=./mysql_cnf/<span class="variable">$&#123;v_name&#125;</span>.lst</span><br><span class="line">        v_backupfile=<span class="variable">$&#123;v_type&#125;</span>_<span class="variable">$&#123;v_name&#125;</span>_<span class="variable">$&#123;DATETIME&#125;</span>.sql.gz</span><br><span class="line">        <span class="keyword">if</span> [[ <span class="string">&quot;v<span class="variable">$&#123;v_name&#125;</span>&quot;</span> == <span class="string">&quot;vbigdata&quot;</span> ]]; <span class="keyword">then</span> mysql_ops=<span class="string">&#x27; --skip-column-statistics&#x27;</span> ; <span class="keyword">fi</span></span><br><span class="line">        mysqldump --defaults-extra-file=<span class="variable">$v_mysqllst</span> --all-databases --set-gtid-purged=OFF  <span class="variable">$mysql_ops</span> -C |  gzip &gt; <span class="variable">$v_backupfile</span></span><br><span class="line">        /usr/local/bin/aws s3 <span class="built_in">cp</span> <span class="variable">$v_backupfile</span> s3://hxs3/backup/</span><br><span class="line"><span class="comment">#        if [[ &quot;v$&#123;v_day&#125;&quot; == &quot;v01&quot; ]] || [[ &quot;v$&#123;v_day&#125;&quot; == &quot;v15&quot; ]]; then /usr/local/bin/aws s3 cp $v_backupfile s3://hxs3/backup/ s3://hxarchive/永久备份/; fi</span></span><br><span class="line">    ;;</span><br><span class="line">    *)</span><br><span class="line">    ;;</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## nacos backup</span></span><br><span class="line">./nacos_backup.py</span><br><span class="line"></span><br><span class="line"><span class="comment">## nginx backup</span></span><br><span class="line">/data/anaconda3/bin/ansible nginx_default -i ansible_hosts.lst -m synchronize -a  <span class="string">&quot;src=/etc/nginx/conf.d dest=nginx_&#123;&#123;inventory_hostname&#125;&#125;  mode=pull&quot;</span></span><br><span class="line">/data/anaconda3/bin/ansible nginx_data -i ansible_hosts.lst -m synchronize -a  <span class="string">&quot;src=/data/nginx/conf/conf.d dest=nginx_&#123;&#123;inventory_hostname&#125;&#125;  mode=pull&quot;</span></span><br><span class="line">tar -czvf nginx_<span class="variable">$&#123;DATETIME&#125;</span>.tgz nginx_aws*  --remove</span><br><span class="line">/usr/local/bin/aws s3 <span class="built_in">cp</span> nginx_<span class="variable">$&#123;DATETIME&#125;</span>.tgz s3://hxs3/backup/</span><br><span class="line"><span class="comment">#if [[ &quot;v$&#123;v_day&#125;&quot; == &quot;v01&quot; ]] || [[ &quot;v$&#123;v_day&#125;&quot; == &quot;v15&quot; ]]; then /usr/local/bin/aws s3 cp nginx_$&#123;DATETIME&#125;.tgz s3://hxarchive/永久备份/; fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## clenaup</span></span><br><span class="line">find <span class="variable">$ROOT</span> -mtime +3 -<span class="built_in">type</span> f -name <span class="string">&quot;*.gz&quot;</span> | xargs <span class="built_in">rm</span> -fv</span><br><span class="line">find <span class="variable">$ROOT</span> -mtime +3 -<span class="built_in">type</span> f -name <span class="string">&quot;*.zip&quot;</span> | xargs <span class="built_in">rm</span> -fv</span><br><span class="line">find <span class="variable">$ROOT</span> -mtime +3 -<span class="built_in">type</span> f -name <span class="string">&quot;*.tgz&quot;</span> | xargs <span class="built_in">rm</span> -fv</span><br><span class="line">find <span class="variable">$ROOT</span> -mtime +3 -<span class="built_in">type</span> f -name <span class="string">&quot;*.tar&quot;</span> | xargs <span class="built_in">rm</span> -fv</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;***********************************************************************&quot;</span></span><br><span class="line"><span class="built_in">echo</span> $(<span class="built_in">date</span>) <span class="string">&quot; -- backup end&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;***********************************************************************&quot;</span></span><br></pre></td></tr></table></figure><h3 id="nacos-备份脚本"><a href="#nacos-备份脚本" class="headerlink" title="nacos 备份脚本"></a>nacos 备份脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/data/anaconda3/bin/python3.9</span></span><br><span class="line"><span class="keyword">from</span> fileinput <span class="keyword">import</span> filename</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> boto3.session <span class="keyword">import</span> Session</span><br><span class="line"></span><br><span class="line"><span class="comment">## s3 config</span></span><br><span class="line">aws_key = <span class="string">&quot;AKIAUPGCAPWX4FD5N2CO&quot;</span></span><br><span class="line">aws_secret = <span class="string">&quot;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&quot;</span></span><br><span class="line">region_name = <span class="string">&quot;cn-northwest-1&quot;</span></span><br><span class="line">session = Session(aws_access_key_id=aws_key,</span><br><span class="line">aws_secret_access_key=aws_secret,</span><br><span class="line">region_name=region_name)</span><br><span class="line"></span><br><span class="line">s3 = session.resource(<span class="string">&quot;s3&quot;</span>)</span><br><span class="line">client = session.client(<span class="string">&quot;s3&quot;</span>)</span><br><span class="line">bucket = <span class="string">&quot;hxs3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## nacos</span></span><br><span class="line">nacos_list=[</span><br><span class="line"><span class="comment">#    &#x27;http://10.9.127.244:8848|c23a1b4c-e97f-45ae-a5c0-1e7f1a8d22e9|nacos|nacos|nacos-dev&#x27;,</span></span><br><span class="line">    <span class="string">&#x27;http://nacos.farmbgy.net:8848|da7aaaa2-7505-4c1d-98c6-9e2e7778ef55|nacos|abc123!!!|nacos-prod&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;http://aws-sit-code-pro-01:8848|09a89c03-8f14-40a7-a44b-2be7e9f87e14|nacos|abc123!!!|nacos-sit&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;http://aws-jx-middle-01:8848|c876967c-d8dd-4318-9bf1-e7e72eb47d13|nacos|abc123!!!|nacos-jx&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;http://aws-show-middle-01:8848|da7aaaa2-7505-4c1d-98c6-9e2e7778ef55|nacos|abc123!!!|nacos-show&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> nacos_list:</span><br><span class="line">    url,namespace,username,password,filename = row.strip().split(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    login_url = url+<span class="string">&#x27;/nacos/v1/auth/users/login&#x27;</span></span><br><span class="line">    data = &#123;<span class="string">&#x27;username&#x27;</span>:username,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>:password&#125;</span><br><span class="line">    s = requests.session()</span><br><span class="line">    resp = s.post(login_url,data)</span><br><span class="line">    token = json.loads(resp.text)[<span class="string">&#x27;accessToken&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    backup_url = url+<span class="string">&#x27;/nacos/v1/cs/configs?export=true&amp;tenant=&#x27;</span>+namespace+<span class="string">&#x27;&amp;group=&amp;appName=&amp;dataId=&amp;ids=&amp;accessToken=&#x27;</span>+token</span><br><span class="line">    </span><br><span class="line">    filename = os.path.abspath(os.path.dirname(__file__))+<span class="string">&#x27;/&#x27;</span>+filename+<span class="string">&#x27;-&#x27;</span>+datetime.datetime.now().strftime(<span class="string">&#x27;%Y%m%d&#x27;</span>)+<span class="string">&#x27;.zip&#x27;</span></span><br><span class="line"></span><br><span class="line">    r = requests.get(backup_url)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> code:</span><br><span class="line">        code.write(r.content)</span><br><span class="line"></span><br><span class="line">    upload_data = <span class="built_in">open</span>(filename,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line">    upload_key = <span class="string">&quot;backup/&quot;</span>+os.path.basename(filename)</span><br><span class="line">    file_obj = s3.Bucket(bucket).put_object(Key=upload_key, Body=upload_data)</span><br><span class="line">    <span class="built_in">print</span>(file_obj)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;shell-备份工具&quot;&gt;&lt;a href=&quot;#shell-备份工具&quot; class=&quot;headerlink&quot; title=&quot;shell-备份工具&quot;&gt;&lt;/a&gt;shell-备份工具&lt;/h2&gt;&lt;p&gt;&lt;em&gt;一个自己写的shell脚本备份工具&lt;/em&gt;&lt;/p&gt;
&lt;h3 id=</summary>
      
    
    
    
    <category term="shell" scheme="https://biglovewheat.gihub.io/categories/shell/"/>
    
    
    <category term="shell" scheme="https://biglovewheat.gihub.io/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>Docker-基本操作</title>
    <link href="https://biglovewheat.gihub.io/2022/11/28/docker-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
    <id>https://biglovewheat.gihub.io/2022/11/28/docker-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</id>
    <published>2022-11-27T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.724Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Docker-基本操作"><a href="#Docker-基本操作" class="headerlink" title="Docker-基本操作"></a>Docker-基本操作</h2><h3 id="Docker镜像导入导出"><a href="#Docker镜像导入导出" class="headerlink" title="Docker镜像导入导出"></a>Docker镜像导入导出</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker save 605c77e624dd &gt;nginx.tar</span><br><span class="line">docker load &lt; nginx.tar</span><br><span class="line"></span><br><span class="line"><span class="comment">## 多个镜像打一个包</span></span><br><span class="line">docker save nginx:latest  rocketmq-exporter:latest -o aa.tar</span><br><span class="line">docker load -i aa.tar</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Docker-基本操作&quot;&gt;&lt;a href=&quot;#Docker-基本操作&quot; class=&quot;headerlink&quot; title=&quot;Docker-基本操作&quot;&gt;&lt;/a&gt;Docker-基本操作&lt;/h2&gt;&lt;h3 id=&quot;Docker镜像导入导出&quot;&gt;&lt;a href=&quot;#Docke</summary>
      
    
    
    
    <category term="devops" scheme="https://biglovewheat.gihub.io/categories/devops/"/>
    
    
    <category term="docker" scheme="https://biglovewheat.gihub.io/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>Skywalking-链路跟踪部署</title>
    <link href="https://biglovewheat.gihub.io/2022/11/24/skywalking-%E9%93%BE%E8%B7%AF%E8%B7%9F%E8%B8%AA%E9%83%A8%E7%BD%B2/"/>
    <id>https://biglovewheat.gihub.io/2022/11/24/skywalking-%E9%93%BE%E8%B7%AF%E8%B7%9F%E8%B8%AA%E9%83%A8%E7%BD%B2/</id>
    <published>2022-11-23T16:00:00.000Z</published>
    <updated>2023-06-01T23:23:21.742Z</updated>
    
    <content type="html"><![CDATA[<h2 id="skywalking链路跟踪部署"><a href="#skywalking链路跟踪部署" class="headerlink" title="skywalking链路跟踪部署"></a>skywalking链路跟踪部署</h2><h3 id="Skywalking介绍"><a href="#Skywalking介绍" class="headerlink" title="Skywalking介绍"></a>Skywalking介绍</h3><p>Skywalking是分布式系统的应用程序性能监视工具，专为微服务，云原生架构和基于容器（Docker，K8S,Mesos）架构而设计，它是一款优秀的APM（Application Performance Management）工具，包括了分布式追踪，性能指标分析和服务依赖分析等。</p><h3 id="skywalking架构图"><a href="#skywalking架构图" class="headerlink" title="skywalking架构图"></a>skywalking架构图</h3><p><img src="/./../images/skywalking%E9%93%BE%E8%B7%AF%E8%B7%9F%E8%B8%AA%E9%83%A8%E7%BD%B2_01.jpg"></p><p>Skywalking agent 和业务端绑定在一起，负责收集各种监控数据</p><p>Skywalking oapservice 是负责处理监控数据，接受agent的数据并存储在数据库中，接受来自UI的请求，查询监控数据。</p><p>Skywalking UI提供给用户，展现各种监控数据和告警。</p><h3 id="skywalking安装部署-ES"><a href="#skywalking安装部署-ES" class="headerlink" title="skywalking安装部署-ES"></a>skywalking安装部署-ES</h3><p>elasticsearch安装（略）</p><h3 id="skywalking安装部署-obs-server端"><a href="#skywalking安装部署-obs-server端" class="headerlink" title="skywalking安装部署-obs(server端)"></a>skywalking安装部署-obs(server端)</h3><p>官网下载，解压压缩包</p><p>修改配置文件</p><p>vi skywalking&#x2F;config&#x2F;application.yml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 修改配置文件，使用nacos作为注册中心</span></span><br><span class="line"><span class="attr">cluster:</span></span><br><span class="line">  <span class="attr">selector:</span> <span class="string">$&#123;SW_CLUSTER:nacos&#125;</span></span><br><span class="line">  <span class="attr">nacos:</span></span><br><span class="line">    <span class="attr">serviceName:</span> <span class="string">$&#123;SW_SERVICE_NAME:&quot;SkyWalking_OAP_Cluster&quot;&#125;</span></span><br><span class="line">    <span class="attr">hostPort:</span> <span class="string">$&#123;SW_CLUSTER_NACOS_HOST_PORT:192.168.8.101:8848&#125;</span></span><br><span class="line">    <span class="comment"># Nacos Configuration namespace</span></span><br><span class="line">    <span class="attr">namespace:</span> <span class="string">$&#123;SW_CLUSTER_NACOS_NAMESPACE:&quot;c23a1b4c-e97f-45ae-a5c0-1e7f1a8d22e9&quot;&#125;</span></span><br><span class="line">    <span class="comment"># Nacos auth username</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">$&#123;SW_CLUSTER_NACOS_USERNAME:&quot;&quot;&#125;</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">$&#123;SW_CLUSTER_NACOS_PASSWORD:&quot;&quot;&#125;</span></span><br><span class="line">    <span class="comment"># Nacos auth accessKey</span></span><br><span class="line">    <span class="attr">accessKey:</span> <span class="string">$&#123;SW_CLUSTER_NACOS_ACCESSKEY:&quot;&quot;&#125;</span></span><br><span class="line">    <span class="attr">secretKey:</span> <span class="string">$&#123;SW_CLUSTER_NACOS_SECRETKEY:&quot;&quot;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## es作为后端存储</span></span><br><span class="line"><span class="attr">storage:</span></span><br><span class="line">  <span class="attr">selector:</span> <span class="string">$&#123;SW_STORAGE:elasticsearch&#125;</span></span><br><span class="line">  <span class="attr">elasticsearch:</span></span><br><span class="line">    <span class="attr">namespace:</span> <span class="string">$&#123;SW_NAMESPACE:&quot;&quot;&#125;</span></span><br><span class="line">    <span class="attr">clusterNodes:</span> <span class="string">$&#123;SW_STORAGE_ES_CLUSTER_NODES:10.9.127.36:9200&#125;</span></span><br></pre></td></tr></table></figure><p>修改UI配置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 主要修改端口</span></span><br><span class="line"><span class="string">skywalking/webapp/webapp.yml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">12080</span></span><br></pre></td></tr></table></figure><p>同时启动oap和UI</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">skywalking/bin/startup.sh</span><br></pre></td></tr></table></figure><p>启动成功后，可以在nacos上看到SkyWalking_OAP_Cluster</p><h3 id="skywalking安装部署-agent-spring-boot"><a href="#skywalking安装部署-agent-spring-boot" class="headerlink" title="skywalking安装部署-agent(spring boot)"></a>skywalking安装部署-agent(spring boot)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 下载agent</span></span><br><span class="line">wget https://www.apache.org/dyn/closer.cgi/skywalking/java-agent/8.13.0/apache-skywalking-java-agent-8.13.0.tgz</span><br><span class="line"></span><br><span class="line"><span class="comment">## 修改配置</span></span><br><span class="line">vi ./config/agent.config</span><br><span class="line"><span class="comment">#主要修改oap的IP，多个IP可用逗号隔开</span></span><br><span class="line">collector.backend_service=<span class="variable">$&#123;SW_AGENT_COLLECTOR_BACKEND_SERVICES:192.168.8.101:11800&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## sprintboot增加启动参数</span></span><br><span class="line"><span class="built_in">nohup</span> java -javaagent:/data/skywalking/skywalking-agent/skywalking-agent.jar \</span><br><span class="line">           -Dskywalking.agent.service_name=<span class="variable">$&#123;svc&#125;</span> \</span><br><span class="line">           <span class="variable">$&#123;JAVA_OPS&#125;</span> -jar <span class="variable">$&#123;APP_HOME&#125;</span>/<span class="variable">$&#123;svc&#125;</span>.jar  --spring.profiles.active=$ \&#123;SPRING_ENV&#125; &gt;&gt; <span class="variable">$&#123;APP_HOME&#125;</span>/<span class="variable">$&#123;svc&#125;</span>.<span class="built_in">log</span> 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><h3 id="登录UI，可以查看到监控情况"><a href="#登录UI，可以查看到监控情况" class="headerlink" title="登录UI，可以查看到监控情况"></a>登录UI，可以查看到监控情况</h3><h3 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h3><p>默认是没有开启日志监控，需要修改java程序（自行百度）</p><h3 id="告警"><a href="#告警" class="headerlink" title="告警"></a>告警</h3><p>&lt;待补充&gt;</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;skywalking链路跟踪部署&quot;&gt;&lt;a href=&quot;#skywalking链路跟踪部署&quot; class=&quot;headerlink&quot; title=&quot;skywalking链路跟踪部署&quot;&gt;&lt;/a&gt;skywalking链路跟踪部署&lt;/h2&gt;&lt;h3 id=&quot;Skywalkin</summary>
      
    
    
    
    <category term="监控" scheme="https://biglovewheat.gihub.io/categories/%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="skywalking" scheme="https://biglovewheat.gihub.io/tags/skywalking/"/>
    
  </entry>
  
</feed>
