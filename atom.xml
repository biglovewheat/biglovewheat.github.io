<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>biglovewheat</title>
  
  
  <link href="https://biglovewheat.gihub.io/atom.xml" rel="self"/>
  
  <link href="https://biglovewheat.gihub.io/"/>
  <updated>2023-10-11T13:31:38.986Z</updated>
  <id>https://biglovewheat.gihub.io/</id>
  
  <author>
    <name>biglovewheat</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Jenkins-增加agent</title>
    <link href="https://biglovewheat.gihub.io/2023/10/11/jenkins-%E5%A2%9E%E5%8A%A0agent/"/>
    <id>https://biglovewheat.gihub.io/2023/10/11/jenkins-%E5%A2%9E%E5%8A%A0agent/</id>
    <published>2023-10-10T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Jenkins-增加agent"><a href="#Jenkins-增加agent" class="headerlink" title="Jenkins-增加agent"></a>Jenkins-增加agent</h2><p><em>单台jenkins处理能力有限，一般只能同时处理数个发布，当发布增多时，需增加jenkins agent，并行处理发布，增加jenkins总体处理能力</em></p><h3 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jenkins 2.308</span><br><span class="line">master：192.168.1.101</span><br><span class="line">agent：192.168.1.102</span><br></pre></td></tr></table></figure><h3 id="信任配置"><a href="#信任配置" class="headerlink" title="信任配置"></a>信任配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## step 1 master和agent新建ssh证书（已有可忽略）</span></span><br><span class="line">ssh-keygen  <span class="comment">## 一路回车即可</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 复制master证书到agent，使master可以免密登录agent</span></span><br><span class="line">ssh-copy-id root@192.168.1.102</span><br></pre></td></tr></table></figure><h3 id="添加凭证"><a href="#添加凭证" class="headerlink" title="添加凭证"></a>添加凭证</h3><p>登录jenkins–》manage jenkins–》manage credentials–》全局–》添加凭证<br>添加一个agent的ssh用户和密码、或证书</p><p><img src="/../images/jenkins-agent-01"></p><h3 id="添加节点"><a href="#添加节点" class="headerlink" title="添加节点"></a>添加节点</h3><p>登录jenkins–》manage node and clouds–》新建节点<br>远程工作目录：输入agent的工作目录，如：&#x2F;data&#x2F;jenkins，注意目录权限</p><p>启动方式：Lauch agents via SSH，输入agent的用户和凭证</p><p>用法：按需，这里选指定标签的任务才使用agent执行</p><p>标签：按需</p><h3 id="启动节点"><a href="#启动节点" class="headerlink" title="启动节点"></a>启动节点</h3><p>登录jenkins–》manage node and clouds–》选中节点，启动代理<br>注意看启动日志，如有报错按日志处理，如ssh认证问题、缺少java环境等</p><h3 id="使用agent构建项目"><a href="#使用agent构建项目" class="headerlink" title="使用agent构建项目"></a>使用agent构建项目</h3><p>项目配置里，选中“限制项目的运行节点”，输入标签表达式，即可指定该项目以特定agent运行</p><p><img src="/../images/jenkins-agent-02"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Jenkins-增加agent&quot;&gt;&lt;a href=&quot;#Jenkins-增加agent&quot; class=&quot;headerlink&quot; title=&quot;Jenkins-增加agent&quot;&gt;&lt;/a&gt;Jenkins-增加agent&lt;/h2&gt;&lt;p&gt;&lt;em&gt;单台jenkins处理能力有</summary>
      
    
    
    
    <category term="devops" scheme="https://biglovewheat.gihub.io/categories/devops/"/>
    
    
    <category term="devops" scheme="https://biglovewheat.gihub.io/tags/devops/"/>
    
    <category term="jenkins" scheme="https://biglovewheat.gihub.io/tags/jenkins/"/>
    
  </entry>
  
  <entry>
    <title>阿里云-DNS负载均衡配置</title>
    <link href="https://biglovewheat.gihub.io/2023/09/21/%E9%98%BF%E9%87%8C%E4%BA%91-dns%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E9%85%8D%E7%BD%AE/"/>
    <id>https://biglovewheat.gihub.io/2023/09/21/%E9%98%BF%E9%87%8C%E4%BA%91-dns%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E9%85%8D%E7%BD%AE/</id>
    <published>2023-09-20T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="阿里云-DNS负载均衡配置"><a href="#阿里云-DNS负载均衡配置" class="headerlink" title="阿里云-DNS负载均衡配置"></a>阿里云-DNS负载均衡配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## step 0</span></span><br><span class="line">通过xxx.abc.com域名，负载均衡到3个后端IP</span><br><span class="line">8.8.8.1</span><br><span class="line">8.8.8.2</span><br><span class="line">8.8.8.3</span><br><span class="line"></span><br><span class="line"><span class="comment">## step 1</span></span><br><span class="line">阿里云-云解析-域名解析，添加三条A记录</span><br><span class="line">xxx.abc.com    8.8.8.1</span><br><span class="line">xxx.abc.com    8.8.8.2</span><br><span class="line">xxx.abc.com    8.8.8.3</span><br><span class="line"></span><br><span class="line"><span class="comment">## step 2</span></span><br><span class="line">阿里云-云解析-域名解析-权重配置</span><br><span class="line">开启权重配置，3个ip权重按需设置，默认都为1</span><br><span class="line">权重范围0-100，权重越大表示访问越频繁，0则不访问</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;阿里云-DNS负载均衡配置&quot;&gt;&lt;a href=&quot;#阿里云-DNS负载均衡配置&quot; class=&quot;headerlink&quot; title=&quot;阿里云-DNS负载均衡配置&quot;&gt;&lt;/a&gt;阿里云-DNS负载均衡配置&lt;/h2&gt;&lt;figure class=&quot;highlight bash</summary>
      
    
    
    
    <category term="云原生" scheme="https://biglovewheat.gihub.io/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/"/>
    
    
    <category term="阿里云" scheme="https://biglovewheat.gihub.io/tags/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
  </entry>
  
  <entry>
    <title>Kafka-集群安装</title>
    <link href="https://biglovewheat.gihub.io/2023/08/21/Kafka-%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85/"/>
    <id>https://biglovewheat.gihub.io/2023/08/21/Kafka-%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85/</id>
    <published>2023-08-20T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Kafka-集群安装"><a href="#Kafka-集群安装" class="headerlink" title="Kafka-集群安装"></a>Kafka-集群安装</h2><h3 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h3><h3 id="部署主机"><a href="#部署主机" class="headerlink" title="部署主机"></a>部署主机</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">172.31.34.25   aws-sit-app-01  </span><br><span class="line">172.31.43.98   aws-sit-app-03</span><br><span class="line">172.31.43.45   aws-sit-app-04</span><br></pre></td></tr></table></figure><h3 id="zookeeper配置"><a href="#zookeeper配置" class="headerlink" title="zookeeper配置"></a>zookeeper配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##重命名配置文件</span></span><br><span class="line"><span class="built_in">mv</span> conf/zoo_sample.cfg conf/conzoo.cfg</span><br><span class="line"><span class="comment">#编辑</span></span><br><span class="line">vim conf/zoo.cfg</span><br><span class="line"></span><br><span class="line">tickTime=2000</span><br><span class="line">initLimit=10</span><br><span class="line">syncLimit=5</span><br><span class="line">dataDir=/data/zookeeper/zkdata</span><br><span class="line">clientPort=2181</span><br><span class="line">server.1=172.31.34.25:2888:3888</span><br><span class="line">server.2=172.31.43.98:2888:3888</span><br><span class="line">server.3=172.31.43.45:2888:3888</span><br><span class="line"></span><br><span class="line"><span class="comment">#上面这段server.A=B:C:D中</span></span><br><span class="line"><span class="comment">#A代表的就是每个节点中myid文件中的编号</span></span><br><span class="line"><span class="comment">#B代表的是节点的服务地址</span></span><br><span class="line"><span class="comment">#C代表这个服务器 Follower 与集群中的 Leader 服务器交换信息的端口</span></span><br><span class="line"><span class="comment">#D代表是万一集群中的 Leader 服务器挂了，需要一个端口来重新进行选举，选出一个新的Leader，而这个端口就是用#来执行选举时服务器相互通信的端口</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#创建myid文件，每个节点id是唯一</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /data/zookeeper/zkdata;<span class="built_in">echo</span> 1&gt;/data/zookeeper/zkdata/myid</span><br><span class="line"><span class="built_in">mkdir</span> -p /data/zookeeper/zkdata;<span class="built_in">echo</span> 2&gt;/data/zookeeper/zkdata/myid</span><br><span class="line"><span class="built_in">mkdir</span> -p /data/zookeeper/zkdata;<span class="built_in">echo</span> 3&gt;/data/zookeeper/zkdata/myid</span><br><span class="line"></span><br><span class="line"><span class="comment">## 启动脚本</span></span><br><span class="line"><span class="comment">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/data/soft/jdk1.8.0_301</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line">ROOT_PATH=/data/zookeeper</span><br><span class="line"></span><br><span class="line"><span class="variable">$ROOT_PATH</span>/bin/zkServer.sh start</span><br><span class="line"></span><br><span class="line"><span class="comment">## 检查</span></span><br><span class="line">./bin/zkServer.sh  status</span><br></pre></td></tr></table></figure><h3 id="kafka配置"><a href="#kafka配置" class="headerlink" title="kafka配置"></a>kafka配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 修改配置文件</span></span><br><span class="line">vi confile/server.properties</span><br><span class="line"></span><br><span class="line"><span class="comment">#broker.id不重复</span></span><br><span class="line">broker.id=0</span><br><span class="line">num.network.threads=3</span><br><span class="line">num.io.threads=8</span><br><span class="line">socket.send.buffer.bytes=102400</span><br><span class="line">socket.receive.buffer.bytes=102400</span><br><span class="line">socket.request.max.bytes=104857600</span><br><span class="line">log.dirs=/data/kafka/kafka-logs</span><br><span class="line">num.partitions=1</span><br><span class="line">num.recovery.threads.per.data.dir=1</span><br><span class="line">offsets.topic.replication.factor=1</span><br><span class="line">transaction.state.log.replication.factor=1</span><br><span class="line">transaction.state.log.min.isr=1</span><br><span class="line">log.retention.hours=60</span><br><span class="line">log.segment.bytes=1073741824</span><br><span class="line">log.retention.check.interval.ms=300000</span><br><span class="line">zookeeper.connect=172.31.34.25:2181,172.31.43.98:2181,172.31.43.45:2181</span><br><span class="line">zookeeper.connection.timeout.ms=6000</span><br><span class="line">group.initial.rebalance.delay.ms=0</span><br><span class="line"><span class="comment"># 自动创建topic</span></span><br><span class="line">auto.create.topics.enable=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 启动脚本</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/data/soft/jdk1.8.0_301</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line">ROOT_PATH=/data/kafka</span><br><span class="line"></span><br><span class="line"><span class="variable">$ROOT_PATH</span>/bin/kafka-server-start.sh -daemon <span class="variable">$ROOT_PATH</span>/config/server.properties</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 创建topic</span></span><br><span class="line">bin/kafka-topics.sh --create --topic quickstart-events1 --bootstrap-server 172.31.34.25:9092,172.31.43.98:9092,172.31.43.45:9092</span><br><span class="line">bin/kafka-topics.sh --describe --topic quickstart-events1 --bootstrap-server 172.31.34.25:9092,172.31.43.98:9092,172.31.43.45:9092</span><br><span class="line"></span><br><span class="line"><span class="comment">## 往topic写入信息</span></span><br><span class="line">$ bin/kafka-console-producer.sh --topic quickstart-events1 --bootstrap-server 172.31.34.25:9092,172.31.43.98:9092,172.31.43.45:9092</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line"></span><br><span class="line"><span class="comment">## 读取信息</span></span><br><span class="line">$ bin/kafka-console-consumer.sh --topic quickstart-events1 --from-beginning --bootstrap-server 172.31.34.25:9092,172.31.43.98:9092,172.31.43.45:9092</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line"></span><br><span class="line">bin/kafka-console-producer.sh --topic quickstart-events --bootstrap-server localhost:9092</span><br><span class="line">bin/kafka-console-consumer.sh --topic quickstart-events --from-beginning --bootstrap-server localhost:9092</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Kafka-集群安装&quot;&gt;&lt;a href=&quot;#Kafka-集群安装&quot; class=&quot;headerlink&quot; title=&quot;Kafka-集群安装&quot;&gt;&lt;/a&gt;Kafka-集群安装&lt;/h2&gt;&lt;h3 id=&quot;官方文档&quot;&gt;&lt;a href=&quot;#官方文档&quot; class=&quot;head</summary>
      
    
    
    
    <category term="middleware" scheme="https://biglovewheat.gihub.io/categories/middleware/"/>
    
    
    <category term="middleware" scheme="https://biglovewheat.gihub.io/tags/middleware/"/>
    
    <category term="mq" scheme="https://biglovewheat.gihub.io/tags/mq/"/>
    
  </entry>
  
  <entry>
    <title>AWS-子网划分</title>
    <link href="https://biglovewheat.gihub.io/2023/08/21/aws-%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86/"/>
    <id>https://biglovewheat.gihub.io/2023/08/21/aws-%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86/</id>
    <published>2023-08-20T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.984Z</updated>
    
    <content type="html"><![CDATA[<h2 id="AWS-子网划分"><a href="#AWS-子网划分" class="headerlink" title="AWS-子网划分"></a>AWS-子网划分</h2><h3 id="参考网址"><a href="#参考网址" class="headerlink" title="参考网址"></a>参考网址</h3><p>在线网络计算器</p><p><a href="https://www.sojson.com/convert/subnetmask.html">https://www.sojson.com/convert/subnetmask.html</a></p><h3 id="列子"><a href="#列子" class="headerlink" title="列子"></a>列子</h3><p>网络列表网络 172.31.0.0 ，掩码255.255.240.0或20</p><p>可用网络16，每个网络可用主机4096</p><p><img src="/./../images/%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86_01.jpg"></p><p><img src="/./../images/%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86_02.jpg"></p><p><img src="/./../images/%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86_03.jpg"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;AWS-子网划分&quot;&gt;&lt;a href=&quot;#AWS-子网划分&quot; class=&quot;headerlink&quot; title=&quot;AWS-子网划分&quot;&gt;&lt;/a&gt;AWS-子网划分&lt;/h2&gt;&lt;h3 id=&quot;参考网址&quot;&gt;&lt;a href=&quot;#参考网址&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    <category term="云原生" scheme="https://biglovewheat.gihub.io/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/"/>
    
    
    <category term="aws" scheme="https://biglovewheat.gihub.io/tags/aws/"/>
    
  </entry>
  
  <entry>
    <title>Git-常用命令</title>
    <link href="https://biglovewheat.gihub.io/2023/08/21/git-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    <id>https://biglovewheat.gihub.io/2023/08/21/git-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</id>
    <published>2023-08-20T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Git-常用命令"><a href="#Git-常用命令" class="headerlink" title="Git-常用命令"></a>Git-常用命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 下载</span></span><br><span class="line">git <span class="built_in">clone</span> [url]</span><br><span class="line"></span><br><span class="line"><span class="comment">## 显示配置</span></span><br><span class="line">git config --list</span><br><span class="line"></span><br><span class="line"><span class="comment">## 设置用户信息</span></span><br><span class="line">git config [--global] user.name <span class="string">&quot;[name]&quot;</span></span><br><span class="line">git config [--global] user.email <span class="string">&quot;[email address]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 增加文件</span></span><br><span class="line">git add [file1] [file2] ...</span><br><span class="line">git add [<span class="built_in">dir</span>]</span><br><span class="line">git add .</span><br><span class="line"></span><br><span class="line"><span class="comment">## 代码提交</span></span><br><span class="line">git commit -m [message]</span><br><span class="line"></span><br><span class="line"><span class="comment">## 列出分支</span></span><br><span class="line">git branch</span><br><span class="line">git branch -r</span><br><span class="line">git branch -a</span><br><span class="line"></span><br><span class="line"><span class="comment">## 切换分支</span></span><br><span class="line">git checkout [branch-name]</span><br><span class="line"></span><br><span class="line"><span class="comment">## 合并分支</span></span><br><span class="line">git merge [branch]</span><br><span class="line"></span><br><span class="line"><span class="comment">## 查看变更的文件</span></span><br><span class="line">git status</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Git-常用命令&quot;&gt;&lt;a href=&quot;#Git-常用命令&quot; class=&quot;headerlink&quot; title=&quot;Git-常用命令&quot;&gt;&lt;/a&gt;Git-常用命令&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td cla</summary>
      
    
    
    
    <category term="devops" scheme="https://biglovewheat.gihub.io/categories/devops/"/>
    
    
    <category term="gitlab" scheme="https://biglovewheat.gihub.io/tags/gitlab/"/>
    
  </entry>
  
  <entry>
    <title>Git-角色</title>
    <link href="https://biglovewheat.gihub.io/2023/08/21/git-%E8%A7%92%E8%89%B2/"/>
    <id>https://biglovewheat.gihub.io/2023/08/21/git-%E8%A7%92%E8%89%B2/</id>
    <published>2023-08-20T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Git-角色"><a href="#Git-角色" class="headerlink" title="Git-角色"></a>Git-角色</h2><h3 id="用户在项目中的角色"><a href="#用户在项目中的角色" class="headerlink" title="用户在项目中的角色"></a>用户在项目中的角色</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Guest：访客。可以创建issue、发表评论，不能读写版本库。（就是看不了代码…）</span><br><span class="line">Reporter：Git项目测试人员。可以克隆代码，不能提交。QA、PM可以赋予这个权限。</span><br><span class="line">Developer：项目开发人员。可以克隆代码、开发、提交、push。RD可以赋予这个权限。</span><br><span class="line">Maintainer：Git项目管理员。可以创建项目、添加tag、保护分支、添加项目成员、编辑项目。核心RD负责人可以赋予这个权限。</span><br><span class="line">Owner：Git系统管理员即Administrator。拥有至高无上的权限。开发组leader可以赋予这个权限。</span><br></pre></td></tr></table></figure><h3 id="项目的访问权限"><a href="#项目的访问权限" class="headerlink" title="项目的访问权限"></a>项目的访问权限</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Private：只有组成员才能看到</span><br><span class="line">Internal：只要登录的用户就能看到</span><br><span class="line">Public：所有人都能看到</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Git-角色&quot;&gt;&lt;a href=&quot;#Git-角色&quot; class=&quot;headerlink&quot; title=&quot;Git-角色&quot;&gt;&lt;/a&gt;Git-角色&lt;/h2&gt;&lt;h3 id=&quot;用户在项目中的角色&quot;&gt;&lt;a href=&quot;#用户在项目中的角色&quot; class=&quot;headerlink</summary>
      
    
    
    
    <category term="devops" scheme="https://biglovewheat.gihub.io/categories/devops/"/>
    
    
    <category term="devops" scheme="https://biglovewheat.gihub.io/tags/devops/"/>
    
    <category term="git" scheme="https://biglovewheat.gihub.io/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>Oracle-常用查询</title>
    <link href="https://biglovewheat.gihub.io/2023/08/21/oracle-%E5%B8%B8%E7%94%A8%E6%9F%A5%E8%AF%A2/"/>
    <id>https://biglovewheat.gihub.io/2023/08/21/oracle-%E5%B8%B8%E7%94%A8%E6%9F%A5%E8%AF%A2/</id>
    <published>2023-08-20T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Oracle-常用查询"><a href="#Oracle-常用查询" class="headerlink" title="Oracle-常用查询"></a>Oracle-常用查询</h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Oracle-常用查询&quot;&gt;&lt;a href=&quot;#Oracle-常用查询&quot; class=&quot;headerlink&quot; title=&quot;Oracle-常用查询&quot;&gt;&lt;/a&gt;Oracle-常用查询&lt;/h2&gt;&lt;h3 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="数据库" scheme="https://biglovewheat.gihub.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="oracle" scheme="https://biglovewheat.gihub.io/tags/oracle/"/>
    
  </entry>
  
  <entry>
    <title>Oracle-常见ora错误</title>
    <link href="https://biglovewheat.gihub.io/2023/08/21/oracle-%E5%B8%B8%E8%A7%81ora%E9%94%99%E8%AF%AF/"/>
    <id>https://biglovewheat.gihub.io/2023/08/21/oracle-%E5%B8%B8%E8%A7%81ora%E9%94%99%E8%AF%AF/</id>
    <published>2023-08-20T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Oracle-常见ora错误"><a href="#Oracle-常见ora错误" class="headerlink" title="Oracle-常见ora错误"></a>Oracle-常见ora错误</h2><h3 id="ORA-ORA-00257-空间不足错误"><a href="#ORA-ORA-00257-空间不足错误" class="headerlink" title="ORA_ORA-00257 空间不足错误"></a>ORA_ORA-00257 空间不足错误</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--查看使用情况</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> V$FLASH_RECOVERY_AREA_USAGE;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查看存储目录</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">parameter</span> recover;</span><br><span class="line"></span><br><span class="line"><span class="comment">--增大空间</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">system</span> <span class="keyword">set</span> DB_RECOVERY_FILE_DEST_SIZE<span class="operator">=</span><span class="number">20</span>g;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Oracle-常见ora错误&quot;&gt;&lt;a href=&quot;#Oracle-常见ora错误&quot; class=&quot;headerlink&quot; title=&quot;Oracle-常见ora错误&quot;&gt;&lt;/a&gt;Oracle-常见ora错误&lt;/h2&gt;&lt;h3 id=&quot;ORA-ORA-00257-空间不</summary>
      
    
    
    
    <category term="数据库" scheme="https://biglovewheat.gihub.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="oracle" scheme="https://biglovewheat.gihub.io/tags/oracle/"/>
    
  </entry>
  
  <entry>
    <title>Oracle-获取表结构</title>
    <link href="https://biglovewheat.gihub.io/2023/08/21/oracle-%E8%8E%B7%E5%8F%96%E8%A1%A8%E7%BB%93%E6%9E%84/"/>
    <id>https://biglovewheat.gihub.io/2023/08/21/oracle-%E8%8E%B7%E5%8F%96%E8%A1%A8%E7%BB%93%E6%9E%84/</id>
    <published>2023-08-20T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Oracle-获取表结构"><a href="#Oracle-获取表结构" class="headerlink" title="Oracle-获取表结构"></a>Oracle-获取表结构</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">getTabSql</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">sqlplus -S / as sysdba &gt;&gt;./<span class="variable">$logfile</span> &lt;&lt;!</span><br><span class="line"><span class="built_in">set</span> heading off;</span><br><span class="line"><span class="built_in">set</span> <span class="built_in">echo</span> off;</span><br><span class="line"><span class="built_in">set</span> pages 999;</span><br><span class="line"><span class="built_in">set</span> long 90000;</span><br><span class="line"><span class="built_in">set</span> linesize 1000;</span><br><span class="line">column DDLS format a1000;</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;PRETTY&#x27;</span>, TRUE);</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;SQLTERMINATOR&#x27;</span>, TRUE);</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;CONSTRAINTS&#x27;</span>, FALSE);</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;REF_CONSTRAINTS&#x27;</span>, FALSE);</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;CONSTRAINTS_AS_ALTER&#x27;</span>, FALSE);</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;STORAGE&#x27;</span>, FALSE);</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;TABLESPACE&#x27;</span>, FALSE);</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;SEGMENT_ATTRIBUTES&#x27;</span>, FALSE);</span><br><span class="line">EXECUTE DBMS_METADATA.SET_TRANSFORM_PARAM(DBMS_METADATA.SESSION_TRANSFORM,<span class="string">&#x27;STORAGE&#x27;</span>,<span class="literal">false</span>); </span><br><span class="line">spool getsql.<span class="variable">$1</span>.tmp;</span><br><span class="line">select dbms_metadata.get_ddl(<span class="string">&#x27;TABLE&#x27;</span>,<span class="string">&#x27;$1&#x27;</span>,<span class="string">&#x27;$2&#x27;</span>) as ddls FROM DUAL;</span><br><span class="line">spool off</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">getIdxSql</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">sqlplus -S / as sysdba &gt;&gt;./<span class="variable">$logfile</span> &lt;&lt;!</span><br><span class="line"><span class="built_in">set</span> heading off;</span><br><span class="line"><span class="built_in">set</span> <span class="built_in">echo</span> off;</span><br><span class="line"><span class="built_in">set</span> pages 999;</span><br><span class="line"><span class="built_in">set</span> long 90000;</span><br><span class="line"><span class="built_in">set</span> linesize 1000;</span><br><span class="line">column DDLS format a1000;</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;PRETTY&#x27;</span>, TRUE);</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;SQLTERMINATOR&#x27;</span>, TRUE);</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;CONSTRAINTS&#x27;</span>, FALSE);</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;REF_CONSTRAINTS&#x27;</span>, FALSE);</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;CONSTRAINTS_AS_ALTER&#x27;</span>, FALSE);</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;STORAGE&#x27;</span>, FALSE);</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;TABLESPACE&#x27;</span>, FALSE);</span><br><span class="line">EXEC DBMS_METADATA.set_transform_param(DBMS_METADATA.session_transform, <span class="string">&#x27;SEGMENT_ATTRIBUTES&#x27;</span>, FALSE);</span><br><span class="line">spool getsql.<span class="variable">$1</span>.tmp;</span><br><span class="line">select dbms_metadata.get_ddl(<span class="string">&#x27;INDEX&#x27;</span>,<span class="string">&#x27;$1&#x27;</span>,<span class="string">&#x27;$2&#x27;</span>) as ddls FROM DUAL;</span><br><span class="line">spool off</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">getIdxName</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">        sqlplus -S / as sysdba &gt;&gt;./<span class="variable">$logfile</span> &lt;&lt;!</span><br><span class="line">        <span class="built_in">set</span> <span class="built_in">echo</span> off </span><br><span class="line">        <span class="built_in">set</span> termout off</span><br><span class="line">        <span class="built_in">set</span> trimspool on</span><br><span class="line">        <span class="built_in">set</span> feedback off</span><br><span class="line">        <span class="built_in">set</span> verify off</span><br><span class="line">        <span class="built_in">set</span> pagesize 0</span><br><span class="line">        spool getsql.<span class="variable">$1</span>.idxname.tmp</span><br><span class="line">        select index_name from dba_indexes <span class="built_in">where</span> table_name=<span class="string">&#x27;$1&#x27;</span> and owner=<span class="string">&#x27;$2&#x27;</span>;</span><br><span class="line">        spool off</span><br><span class="line">        <span class="built_in">exit</span></span><br><span class="line">!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">rm</span> -rf getsql.*.tmp</span><br><span class="line"><span class="built_in">rm</span> -rf getsql.log</span><br><span class="line"></span><br><span class="line">logfile=getsql.log</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> rec <span class="keyword">in</span> `<span class="built_in">cat</span> getsql.lst`</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">                OWNER=`<span class="built_in">echo</span> <span class="variable">$rec</span>|awk -F\. <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>`</span><br><span class="line">                TABNAME=`<span class="built_in">echo</span> <span class="variable">$rec</span>|awk -F\. <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>`</span><br><span class="line">                 <span class="built_in">typeset</span> -u <span class="variable">$OWNER</span></span><br><span class="line">                 <span class="built_in">typeset</span> -u <span class="variable">$TABNAME</span></span><br><span class="line">                getTabSql <span class="variable">$TABNAME</span> <span class="variable">$OWNER</span></span><br><span class="line">                getIdxName <span class="variable">$TABNAME</span> <span class="variable">$OWNER</span></span><br><span class="line">                <span class="keyword">for</span> rec <span class="keyword">in</span>  `<span class="built_in">cat</span> getsql.<span class="variable">$TABNAME</span>.idxname.tmp`</span><br><span class="line">                <span class="keyword">do</span> </span><br><span class="line">                   IDXNAME=`<span class="built_in">echo</span> <span class="variable">$rec</span>|awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>`</span><br><span class="line">                   getIdxSql <span class="variable">$IDXNAME</span> <span class="variable">$OWNER</span></span><br><span class="line">                   <span class="built_in">cat</span> getsql.<span class="variable">$IDXNAME</span>.tmp &gt;&gt; getsql.<span class="variable">$TABNAME</span>.tmp</span><br><span class="line">                <span class="keyword">done</span></span><br><span class="line">                sed <span class="string">&#x27;s/[ \t]*$//&#x27;</span> getsql.<span class="variable">$TABNAME</span>.tmp|sed -e <span class="string">&#x27;/^$/d&#x27;</span>&gt;<span class="variable">$TABNAME</span>.sql</span><br><span class="line">        <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">rm</span> -rf getsql.*.tmp</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Oracle-获取表结构&quot;&gt;&lt;a href=&quot;#Oracle-获取表结构&quot; class=&quot;headerlink&quot; title=&quot;Oracle-获取表结构&quot;&gt;&lt;/a&gt;Oracle-获取表结构&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;t</summary>
      
    
    
    
    <category term="数据库" scheme="https://biglovewheat.gihub.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="oracle" scheme="https://biglovewheat.gihub.io/tags/oracle/"/>
    
  </entry>
  
  <entry>
    <title>Postgresql-基本操作</title>
    <link href="https://biglovewheat.gihub.io/2023/08/21/postgresql-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
    <id>https://biglovewheat.gihub.io/2023/08/21/postgresql-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</id>
    <published>2023-08-20T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Postgresql-基本操作"><a href="#Postgresql-基本操作" class="headerlink" title="Postgresql-基本操作"></a>Postgresql-基本操作</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">##查看所有数据库</span><br><span class="line">\l</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> datname <span class="keyword">from</span> pg_database;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Postgresql-基本操作&quot;&gt;&lt;a href=&quot;#Postgresql-基本操作&quot; class=&quot;headerlink&quot; title=&quot;Postgresql-基本操作&quot;&gt;&lt;/a&gt;Postgresql-基本操作&lt;/h2&gt;&lt;figure class=&quot;highli</summary>
      
    
    
    
    <category term="数据库" scheme="https://biglovewheat.gihub.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="postgresql" scheme="https://biglovewheat.gihub.io/tags/postgresql/"/>
    
  </entry>
  
  <entry>
    <title>Shell-将文件平均分成n份</title>
    <link href="https://biglovewheat.gihub.io/2023/08/21/shell-%E5%B0%86%E6%96%87%E4%BB%B6%E5%B9%B3%E5%9D%87%E5%88%86%E6%88%90n%E4%BB%BD/"/>
    <id>https://biglovewheat.gihub.io/2023/08/21/shell-%E5%B0%86%E6%96%87%E4%BB%B6%E5%B9%B3%E5%9D%87%E5%88%86%E6%88%90n%E4%BB%BD/</id>
    <published>2023-08-20T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="将文件平均分成n份"><a href="#将文件平均分成n份" class="headerlink" title="将文件平均分成n份"></a>将文件平均分成n份</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">FILENAME=policyno.unl</span><br><span class="line">PARALLEL=10</span><br><span class="line">TOTALROW=`<span class="built_in">wc</span> -l <span class="variable">$FILENAME</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>`</span><br><span class="line">DIVROW=$(( <span class="variable">$TOTALROW</span> / <span class="variable">$PARALLEL</span> ))</span><br><span class="line">LEFTROW=$(( <span class="variable">$TOTALROW</span> % <span class="variable">$PARALLEL</span> ))</span><br><span class="line"><span class="keyword">for</span> ((i=1;i&lt;=<span class="variable">$PARALLEL</span>;i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$i</span> -le <span class="variable">$LEFTROW</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">PIECEROW=$(( <span class="variable">$DIVROW</span> + <span class="number">1</span> ))</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">PIECEROW=<span class="variable">$DIVROW</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$i</span> <span class="keyword">in</span></span><br><span class="line">1)</span><br><span class="line"><span class="built_in">head</span> -n <span class="variable">$PIECEROW</span> <span class="variable">$FILENAME</span> &gt; <span class="variable">$FILENAME</span>.<span class="variable">$i</span></span><br><span class="line">GETROW=<span class="variable">$PIECEROW</span></span><br><span class="line">;;</span><br><span class="line"><span class="variable">$PARALLEL</span>)</span><br><span class="line"><span class="built_in">tail</span> -n <span class="variable">$PIECEROW</span> <span class="variable">$FILENAME</span> &gt; <span class="variable">$FILENAME</span>.<span class="variable">$i</span></span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line">GETROW=$(( <span class="variable">$GETROW</span> + <span class="variable">$PIECEROW</span> ))</span><br><span class="line"><span class="built_in">head</span> -n <span class="variable">$GETROW</span> <span class="variable">$FILENAME</span> |<span class="built_in">tail</span> -n <span class="variable">$PIECEROW</span> &gt;<span class="variable">$FILENAME</span>.<span class="variable">$i</span></span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;将文件平均分成n份&quot;&gt;&lt;a href=&quot;#将文件平均分成n份&quot; class=&quot;headerlink&quot; title=&quot;将文件平均分成n份&quot;&gt;&lt;/a&gt;将文件平均分成n份&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td</summary>
      
    
    
    
    <category term="shell" scheme="https://biglovewheat.gihub.io/categories/shell/"/>
    
    
    <category term="shell" scheme="https://biglovewheat.gihub.io/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>阿里云-数据库选型</title>
    <link href="https://biglovewheat.gihub.io/2023/08/21/%E9%98%BF%E9%87%8C%E4%BA%91-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%80%89%E5%9E%8B/"/>
    <id>https://biglovewheat.gihub.io/2023/08/21/%E9%98%BF%E9%87%8C%E4%BA%91-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%80%89%E5%9E%8B/</id>
    <published>2023-08-20T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="阿里云-数据库选型"><a href="#阿里云-数据库选型" class="headerlink" title="阿里云-数据库选型"></a>阿里云-数据库选型</h2><p><img src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93%E9%80%89%E5%9E%8B.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;阿里云-数据库选型&quot;&gt;&lt;a href=&quot;#阿里云-数据库选型&quot; class=&quot;headerlink&quot; title=&quot;阿里云-数据库选型&quot;&gt;&lt;/a&gt;阿里云-数据库选型&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/../images/%E6%95%B0%E6%8D%AE%E5</summary>
      
    
    
    
    <category term="云原生" scheme="https://biglovewheat.gihub.io/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/"/>
    
    
    <category term="阿里云" scheme="https://biglovewheat.gihub.io/tags/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
  </entry>
  
  <entry>
    <title>ELK-ON-K8S安装</title>
    <link href="https://biglovewheat.gihub.io/2023/08/17/elk-on-k8s%E5%AE%89%E8%A3%85/"/>
    <id>https://biglovewheat.gihub.io/2023/08/17/elk-on-k8s%E5%AE%89%E8%A3%85/</id>
    <published>2023-08-16T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ELK-ON-K8S安装"><a href="#ELK-ON-K8S安装" class="headerlink" title="ELK-ON-K8S安装"></a>ELK-ON-K8S安装</h2><h3 id="helm安装"><a href="#helm安装" class="headerlink" title="helm安装"></a>helm安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## helm-es</span></span><br><span class="line">helm repo add bitnami https://charts.bitnami.com/bitnami</span><br><span class="line">helm upgrade --install elasticsearch bitnami/elasticsearch -n base \</span><br><span class="line">--<span class="built_in">set</span> global.storageClass=nfs-zhikong \</span><br><span class="line">--<span class="built_in">set</span> global.kibanaEnabled=<span class="literal">true</span> \</span><br><span class="line">--<span class="built_in">set</span> image.tag=7.15.2-debian-10-r10 \</span><br><span class="line">--<span class="built_in">set</span> security.elasticPassword=Hxkj2021 \</span><br><span class="line">--<span class="built_in">set</span> master.replicas=1 \</span><br><span class="line">--<span class="built_in">set</span> master.autoscaling.enabled=<span class="literal">false</span> \</span><br><span class="line">--<span class="built_in">set</span> master.autoscaling.minReplicas=2 \</span><br><span class="line">--<span class="built_in">set</span> master.autoscaling.maxReplicas=11 \</span><br><span class="line">--<span class="built_in">set</span> master.heapSize=256m \</span><br><span class="line">--<span class="built_in">set</span> coordinating.replicas=1 \</span><br><span class="line">--<span class="built_in">set</span> coordinating.autoscaling.enabled=<span class="literal">false</span> \</span><br><span class="line">--<span class="built_in">set</span> coordinating.autoscaling.minReplicas=2 \</span><br><span class="line">--<span class="built_in">set</span> coordinating.autoscaling.maxReplicas=11 \</span><br><span class="line">--<span class="built_in">set</span> coordinating.heapSize=256m \</span><br><span class="line">--<span class="built_in">set</span> data.replicas=1 \</span><br><span class="line">--<span class="built_in">set</span> data.autoscaling.enabled=<span class="literal">false</span> \</span><br><span class="line">--<span class="built_in">set</span> data.autoscaling.minReplicas=2 \</span><br><span class="line">--<span class="built_in">set</span> data.autoscaling.maxReplicas=11 \</span><br><span class="line">--<span class="built_in">set</span> data.heapSize=1G \</span><br><span class="line">--<span class="built_in">set</span> ingest.replicas=1 \</span><br><span class="line">--<span class="built_in">set</span> curator.enabled=<span class="literal">false</span> \</span><br><span class="line">--<span class="built_in">set</span> metrics.enabled=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## helm-logstash</span></span><br><span class="line">helm repo add bitnami https://charts.bitnami.com/bitnami</span><br><span class="line">helm upgrade --install logstash bitnami/logstash -n base \</span><br><span class="line">--<span class="built_in">set</span> image.tag=7.15.2-debian-10-r12 \</span><br><span class="line">--<span class="built_in">set</span> replicaCount=1 \</span><br><span class="line">--<span class="built_in">set</span> service.type=ClusterIP \</span><br><span class="line">--<span class="built_in">set</span> persistence.enabled=<span class="literal">false</span> \</span><br><span class="line">--<span class="built_in">set</span> persistence.storageClass=nfs-zhikong \</span><br><span class="line">--<span class="built_in">set</span> persistence.size=2Gi</span><br><span class="line"></span><br><span class="line"><span class="comment">## helm-filebeat</span></span><br><span class="line">helm repo add elastic https://helm.elastic.co</span><br><span class="line">helm upgrade  --install filebeat elastic/filebeat -n base \</span><br><span class="line">--<span class="built_in">set</span> daemonset.enabled=<span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="configmap配置"><a href="#configmap配置" class="headerlink" title="configmap配置"></a>configmap配置</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## es-configmap</span></span><br><span class="line"></span><br><span class="line"><span class="attr">pid.file:</span> <span class="string">/opt/bitnami/kibana/tmp/kibana.pid</span></span><br><span class="line"><span class="attr">server.host:</span> <span class="string">&quot;::&quot;</span></span><br><span class="line"><span class="attr">server.port:</span> <span class="number">5601</span></span><br><span class="line"><span class="attr">elasticsearch.hosts:</span> [<span class="string">http://elasticsearch-coordinating-only:9200</span>]</span><br><span class="line"><span class="attr">server.rewriteBasePath:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## filebeat-configmap</span></span><br><span class="line"></span><br><span class="line"><span class="attr">filebeat.inputs:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">type:</span> <span class="string">log</span></span><br><span class="line">  <span class="attr">paths:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/var/log/*server/*server/*.log</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">output.logstash:</span></span><br><span class="line">  <span class="attr">hosts:</span> [<span class="string">logstash:8080</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">## logstash-configmap</span></span><br><span class="line"></span><br><span class="line"><span class="string">input</span> &#123;</span><br><span class="line">  <span class="comment"># udp &#123;</span></span><br><span class="line">  <span class="comment">#   port =&gt; 1514</span></span><br><span class="line">  <span class="comment">#   type =&gt; syslog</span></span><br><span class="line">  <span class="comment"># &#125;</span></span><br><span class="line">  <span class="comment"># tcp &#123;</span></span><br><span class="line">  <span class="comment">#   port =&gt; 1514</span></span><br><span class="line">  <span class="comment">#   type =&gt; syslog</span></span><br><span class="line">  <span class="comment"># &#125;</span></span><br><span class="line">  <span class="string">beats</span> &#123; <span class="string">port</span> <span class="string">=&gt;</span> <span class="number">8080</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">output</span> &#123;</span><br><span class="line">   <span class="string">elasticsearch</span> &#123;</span><br><span class="line">     <span class="string">hosts</span> <span class="string">=&gt;</span> [<span class="string">&quot;elasticsearch-master:9200&quot;</span>]</span><br><span class="line">  <span class="comment">#   manage_template =&gt; false</span></span><br><span class="line">     <span class="string">index</span> <span class="string">=&gt;</span> <span class="string">&quot;<span class="template-variable">%&#123;[@metadata][beat]&#125;</span>-<span class="template-variable">%&#123;+YYYY.MM.dd&#125;</span>&quot;</span></span><br><span class="line">   &#125;</span><br><span class="line">  <span class="comment"># gelf &#123;</span></span><br><span class="line">  <span class="comment">#   host =&gt; &quot;$&#123;GRAYLOG_HOST&#125;&quot;</span></span><br><span class="line">  <span class="comment">#   port =&gt; $&#123;GRAYLOG_PORT&#125;</span></span><br><span class="line">  <span class="comment"># &#125;</span></span><br><span class="line">  <span class="comment"># stdout &#123;&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ELK-ON-K8S安装&quot;&gt;&lt;a href=&quot;#ELK-ON-K8S安装&quot; class=&quot;headerlink&quot; title=&quot;ELK-ON-K8S安装&quot;&gt;&lt;/a&gt;ELK-ON-K8S安装&lt;/h2&gt;&lt;h3 id=&quot;helm安装&quot;&gt;&lt;a href=&quot;#helm安装&quot;</summary>
      
    
    
    
    <category term="日志" scheme="https://biglovewheat.gihub.io/categories/%E6%97%A5%E5%BF%97/"/>
    
    
    <category term="日志" scheme="https://biglovewheat.gihub.io/tags/%E6%97%A5%E5%BF%97/"/>
    
    <category term="k8s" scheme="https://biglovewheat.gihub.io/tags/k8s/"/>
    
  </entry>
  
  <entry>
    <title>emqx-安装</title>
    <link href="https://biglovewheat.gihub.io/2023/08/17/emqx-%E5%AE%89%E8%A3%85/"/>
    <id>https://biglovewheat.gihub.io/2023/08/17/emqx-%E5%AE%89%E8%A3%85/</id>
    <published>2023-08-16T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="emqx-安装"><a href="#emqx-安装" class="headerlink" title="emqx-安装"></a>emqx-安装</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p><em>EMQX 是一款开源 (opens new window)的大规模分布式 MQTT 消息服务器，功能丰富，专为物联网和实时通信应用而设计。EMQX 5.0 单集群支持 MQTT 并发连接数高达 1 亿条，单服务器的传输与处理吞吐量可达每秒百万级 MQTT 消息，并保证延迟在亚毫秒级。</em></p><h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><p><em>centos7.9  emqx4.13</em></p><h3 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h3><p><a href="https://www.emqx.io/docs/zh/v4.3/">https://www.emqx.io/docs/zh/v4.3/</a></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 下载仓库</span></span><br><span class="line">curl -s https://assets.emqx.com/scripts/install-emqx-rpm.sh | sudo bash</span><br><span class="line"></span><br><span class="line"><span class="comment">## 安装指定版本</span></span><br><span class="line">yum list emqx --showduplicates</span><br><span class="line">yum install -y emqx-4.3.15</span><br><span class="line"></span><br><span class="line"><span class="comment">## 开启启动和启动</span></span><br><span class="line">systemctl <span class="built_in">enable</span> emqx</span><br><span class="line">systemctl restart emqx</span><br></pre></td></tr></table></figure><h3 id="控制台和默认端口"><a href="#控制台和默认端口" class="headerlink" title="控制台和默认端口"></a>控制台和默认端口</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://10.77.114.178:18083/  admin/public</span><br><span class="line">mqtt:1883</span><br><span class="line">mqtts:8883</span><br></pre></td></tr></table></figure><h3 id="ssl证书生成脚本"><a href="#ssl证书生成脚本" class="headerlink" title="ssl证书生成脚本"></a>ssl证书生成脚本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt; openssl.cnf</span></span><br><span class="line"><span class="string">[req]default_bits  = 2048</span></span><br><span class="line"><span class="string">distinguished_name = req_distinguished_name</span></span><br><span class="line"><span class="string">req_extensions = req_ext</span></span><br><span class="line"><span class="string">x509_extensions = v3_req</span></span><br><span class="line"><span class="string">prompt = no</span></span><br><span class="line"><span class="string">[req_distinguished_name]</span></span><br><span class="line"><span class="string">countryName = CN</span></span><br><span class="line"><span class="string">stateOrProvinceName = Zhejiang</span></span><br><span class="line"><span class="string">localityName = Hangzhou</span></span><br><span class="line"><span class="string">organizationName = EMQX</span></span><br><span class="line"><span class="string">commonName = CA</span></span><br><span class="line"><span class="string">[req_ext]</span></span><br><span class="line"><span class="string">subjectAltName = @alt_names</span></span><br><span class="line"><span class="string">[v3_req]</span></span><br><span class="line"><span class="string">subjectAltName = @alt_names</span></span><br><span class="line"><span class="string">[alt_names]</span></span><br><span class="line"><span class="string">DNS.1 = *.abc.cn</span></span><br><span class="line"><span class="string">IP.2 = 120.224.237.21</span></span><br><span class="line"><span class="string">DNS.2 = 120.224.237.21</span></span><br><span class="line"><span class="string">IP.3 = 10.77.114.158</span></span><br><span class="line"><span class="string">DNS.3 = 10.77.114.158</span></span><br><span class="line"><span class="string">IP.4 = 10.77.114.178</span></span><br><span class="line"><span class="string">DNS.4 = 10.77.114.178</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">openssl genrsa -out ca.key 2048</span><br><span class="line">openssl req -x509 -new -nodes -key ca.key -sha256 -days 3650 -out ca.pem</span><br><span class="line">openssl genrsa -out emqx.key 2048</span><br><span class="line">openssl req -new -key ./emqx.key -config openssl.cnf -out emqx.csr</span><br><span class="line">openssl x509 -req -<span class="keyword">in</span> ./emqx.csr -CA ca.pem -CAkey ca.key -CAcreateserial -out emqx.pem -days 3650 -sha256 -extensions v3_req -extfile openssl.cnf</span><br><span class="line">openssl genrsa -out client.key 2048</span><br><span class="line">openssl req -new -key client.key -out client.csr -subj <span class="string">&quot;/C=CN/ST=Zhejiang/L=Hangzhou/O=EMQX/CN=client&quot;</span></span><br><span class="line">openssl x509 -req -days 3650 -<span class="keyword">in</span> client.csr -CA ca.pem -CAkey ca.key -CAcreateserial -out client.pem</span><br><span class="line"></span><br><span class="line"><span class="built_in">mv</span> ca.pem  cacert.pem</span><br><span class="line"><span class="built_in">mv</span> emqx.pem cert.pem</span><br><span class="line"><span class="built_in">mv</span> emqx.key key.pem</span><br></pre></td></tr></table></figure><h3 id="证书配置"><a href="#证书配置" class="headerlink" title="证书配置"></a>证书配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 将生成的证书替换掉/etc/emqx下的同名证书</span></span><br><span class="line">listener.ssl.external.keyfile = /etc/emqx/certs/key.pem</span><br><span class="line">listener.ssl.external.certfile = /etc/emqx/certs/cert.pem</span><br><span class="line"></span><br><span class="line"><span class="comment">## 重启emqx</span></span><br><span class="line">systemctl restart emqx</span><br><span class="line"></span><br><span class="line"><span class="comment">## 客户端配置3个证书即可链接</span></span><br><span class="line">cacert.pem</span><br><span class="line">client.pem</span><br><span class="line">client.key</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;emqx-安装&quot;&gt;&lt;a href=&quot;#emqx-安装&quot; class=&quot;headerlink&quot; title=&quot;emqx-安装&quot;&gt;&lt;/a&gt;emqx-安装&lt;/h2&gt;&lt;h3 id=&quot;概述&quot;&gt;&lt;a href=&quot;#概述&quot; class=&quot;headerlink&quot; title=&quot;概</summary>
      
    
    
    
    <category term="middleware" scheme="https://biglovewheat.gihub.io/categories/middleware/"/>
    
    
    <category term="middleware" scheme="https://biglovewheat.gihub.io/tags/middleware/"/>
    
  </entry>
  
  <entry>
    <title>Shell-输出多行</title>
    <link href="https://biglovewheat.gihub.io/2023/08/17/shell-cat%E8%BE%93%E5%87%BA%E5%A4%9A%E8%A1%8C/"/>
    <id>https://biglovewheat.gihub.io/2023/08/17/shell-cat%E8%BE%93%E5%87%BA%E5%A4%9A%E8%A1%8C/</id>
    <published>2023-08-16T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Shell-输出多行"><a href="#Shell-输出多行" class="headerlink" title="Shell-输出多行"></a>Shell-输出多行</h2><h3 id="并发执行"><a href="#并发执行" class="headerlink" title="并发执行"></a>并发执行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt; test.sh</span></span><br><span class="line"><span class="string">#!/bin/bash</span></span><br><span class="line"><span class="string">#you Shell script writes here.</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF | sudo tee /etc/sysctl.d/99-kubernetes-cri.conf</span></span><br><span class="line"><span class="string">net.bridge.bridge-nf-call-iptables  = 1</span></span><br><span class="line"><span class="string">net.ipv4.ip_forward                 = 1</span></span><br><span class="line"><span class="string">net.bridge.bridge-nf-call-ip6tables = 1</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Shell-输出多行&quot;&gt;&lt;a href=&quot;#Shell-输出多行&quot; class=&quot;headerlink&quot; title=&quot;Shell-输出多行&quot;&gt;&lt;/a&gt;Shell-输出多行&lt;/h2&gt;&lt;h3 id=&quot;并发执行&quot;&gt;&lt;a href=&quot;#并发执行&quot; class=&quot;head</summary>
      
    
    
    
    <category term="shell" scheme="https://biglovewheat.gihub.io/categories/shell/"/>
    
    
    <category term="shell" scheme="https://biglovewheat.gihub.io/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>Prometheus-安装配置</title>
    <link href="https://biglovewheat.gihub.io/2023/08/14/prometheus-%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/"/>
    <id>https://biglovewheat.gihub.io/2023/08/14/prometheus-%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/</id>
    <published>2023-08-13T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Prometheus-安装配置"><a href="#Prometheus-安装配置" class="headerlink" title="Prometheus-安装配置"></a>Prometheus-安装配置</h2><h3 id="supervisor安装"><a href="#supervisor安装" class="headerlink" title="supervisor安装"></a>supervisor安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y supervisor</span><br></pre></td></tr></table></figure><h3 id="各组件ini"><a href="#各组件ini" class="headerlink" title="各组件ini"></a>各组件ini</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt; alertmanager.ini</span></span><br><span class="line"><span class="string">[program:alertmanager]</span></span><br><span class="line"><span class="string">command=/data/moni/alertmanager/alertmanager --web.listen-address=&quot;:9093&quot;</span></span><br><span class="line"><span class="string">directory=/data/moni/alertmanager        ; directory to cwd to before exec (def no cwd)</span></span><br><span class="line"><span class="string">umask=022                     ; umask for process (default None)</span></span><br><span class="line"><span class="string">priority=999                  ; the relative start priority (default 999)</span></span><br><span class="line"><span class="string">autostart=true                ; start at supervisord start (default: true)</span></span><br><span class="line"><span class="string">autorestart=true              ; retstart at unexpected quit (default: true)</span></span><br><span class="line"><span class="string">startsecs=1                   ; number of secs prog must stay running (def. 1)</span></span><br><span class="line"><span class="string">startretries=3                ; max # of serial start failures (default 3)</span></span><br><span class="line"><span class="string">exitcodes=0,2                 ; &#x27;expected&#x27; exit codes for process (default 0,2)</span></span><br><span class="line"><span class="string">stopsignal=QUIT               ; signal used to kill process (default TERM)</span></span><br><span class="line"><span class="string">stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)</span></span><br><span class="line"><span class="string">user=root                     ; setuid to this UNIX account to run the program</span></span><br><span class="line"><span class="string">redirect_stderr=true          ; redirect proc stderr to stdout (default false)</span></span><br><span class="line"><span class="string">stdout_logfile=/var/log/alertmanager/alertmanager.log        ; stdout log path, NONE for none; default AUTO</span></span><br><span class="line"><span class="string">stdout_logfile_maxbytes=50MB  ; max # logfile bytes b4 rotation (default 50MB)</span></span><br><span class="line"><span class="string">stdout_logfile_backups=10     ; # of stdout logfile backups (default 10)</span></span><br><span class="line"><span class="string">stdout_capture_maxbytes=1MB   ; number of bytes in &#x27;capturemode&#x27; (default 0)</span></span><br><span class="line"><span class="string">stdout_events_enabled=false   ; emit events on stdout writes (default false)</span></span><br><span class="line"><span class="string">environment=A=1,B=2           ; process environment additions (def no adds)</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt; consul.ini</span></span><br><span class="line"><span class="string">[program:consul]</span></span><br><span class="line"><span class="string">command=/data/moni/consul agent -dev -data-dir=/data/moni/consul-data -node=aws-base-01 -bind=10.77.114.153 -config-dir=/etc/consul.d -enable-script-checks=true -datacenter=hykj -ui -rejoin -client=0.0.0.0</span></span><br><span class="line"><span class="string">directory=/data/moni        ; directory to cwd to before exec (def no cwd)</span></span><br><span class="line"><span class="string">umask=022                     ; umask for process (default None)</span></span><br><span class="line"><span class="string">priority=999                  ; the relative start priority (default 999)</span></span><br><span class="line"><span class="string">autostart=true                ; start at supervisord start (default: true)</span></span><br><span class="line"><span class="string">autorestart=true              ; retstart at unexpected quit (default: true)</span></span><br><span class="line"><span class="string">startsecs=1                   ; number of secs prog must stay running (def. 1)</span></span><br><span class="line"><span class="string">startretries=3                ; max # of serial start failures (default 3)</span></span><br><span class="line"><span class="string">exitcodes=0,2                 ; &#x27;expected&#x27; exit codes for process (default 0,2)</span></span><br><span class="line"><span class="string">stopsignal=QUIT               ; signal used to kill process (default TERM)</span></span><br><span class="line"><span class="string">stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)</span></span><br><span class="line"><span class="string">user=root                     ; setuid to this UNIX account to run the program</span></span><br><span class="line"><span class="string">redirect_stderr=true          ; redirect proc stderr to stdout (default false)</span></span><br><span class="line"><span class="string">stdout_logfile=/var/log/consul/consul.log        ; stdout log path, NONE for none; default AUTO</span></span><br><span class="line"><span class="string">stdout_logfile_maxbytes=50MB  ; max # logfile bytes b4 rotation (default 50MB)</span></span><br><span class="line"><span class="string">stdout_logfile_backups=10     ; # of stdout logfile backups (default 10)</span></span><br><span class="line"><span class="string">stdout_capture_maxbytes=1MB   ; number of bytes in &#x27;capturemode&#x27; (default 0)</span></span><br><span class="line"><span class="string">stdout_events_enabled=false   ; emit events on stdout writes (default false)</span></span><br><span class="line"><span class="string">environment=A=1,B=2           ; process environment additions (def no adds)</span></span><br><span class="line"><span class="string">#serverurl=AUTO                ; override serverurl computation (childutils)</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt; dingtalk.ini</span></span><br><span class="line"><span class="string">[program:dingtalk]</span></span><br><span class="line"><span class="string">command=/data/moni/dingtalk/dingtalk --config.file=config.yml --web.listen-address=&quot;:8860&quot;</span></span><br><span class="line"><span class="string">directory=/data/moni/dingtalk    ; directory to cwd to before exec (def no cwd)</span></span><br><span class="line"><span class="string">umask=022                     ; umask for process (default None)</span></span><br><span class="line"><span class="string">priority=999                  ; the relative start priority (default 999)</span></span><br><span class="line"><span class="string">autostart=false               ; start at supervisord start (default: true)</span></span><br><span class="line"><span class="string">autorestart=true              ; retstart at unexpected quit (default: true)</span></span><br><span class="line"><span class="string">startsecs=1                   ; number of secs prog must stay running (def. 1)</span></span><br><span class="line"><span class="string">startretries=3                ; max # of serial start failures (default 3)</span></span><br><span class="line"><span class="string">exitcodes=0,2                 ; &#x27;expected&#x27; exit codes for process (default 0,2)</span></span><br><span class="line"><span class="string">stopsignal=QUIT               ; signal used to kill process (default TERM)</span></span><br><span class="line"><span class="string">stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)</span></span><br><span class="line"><span class="string">user=root                     ; setuid to this UNIX account to run the program</span></span><br><span class="line"><span class="string">redirect_stderr=true          ; redirect proc stderr to stdout (default false)</span></span><br><span class="line"><span class="string">stdout_logfile=/var/log/dingtalk/dingtalk.log ; stdout log path, NONE for none; default AUTO</span></span><br><span class="line"><span class="string">stdout_logfile_maxbytes=50MB  ; max # logfile bytes b4 rotation (default 50MB)</span></span><br><span class="line"><span class="string">stdout_logfile_backups=10     ; # of stdout logfile backups (default 10)</span></span><br><span class="line"><span class="string">stdout_capture_maxbytes=1MB   ; number of bytes in &#x27;capturemode&#x27; (default 0)</span></span><br><span class="line"><span class="string">stdout_events_enabled=false   ; emit events on stdout writes (default false)</span></span><br><span class="line"><span class="string">environment=A=1,B=2           ; process environment additions (def no adds)</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt; grafana.ini</span></span><br><span class="line"><span class="string">[program:grafana] </span></span><br><span class="line"><span class="string">command=/data/moni/grafana/bin/grafana-server -config /data/moni/grafana/conf/grafana.ini ; </span></span><br><span class="line"><span class="string">directory=/data/moni/grafana        ; directory to cwd to before exec (def no cwd)</span></span><br><span class="line"><span class="string">umask=022                     ; umask for process (default None)</span></span><br><span class="line"><span class="string">priority=999                  ; the relative start priority (default 999)</span></span><br><span class="line"><span class="string">autostart=true                ; start at supervisord start (default: true)</span></span><br><span class="line"><span class="string">autorestart=true              ; retstart at unexpected quit (default: true)</span></span><br><span class="line"><span class="string">startsecs=1                   ; number of secs prog must stay running (def. 1)</span></span><br><span class="line"><span class="string">startretries=3                ; max # of serial start failures (default 3)</span></span><br><span class="line"><span class="string">exitcodes=0,2                 ; &#x27;expected&#x27; exit codes for process (default 0,2)</span></span><br><span class="line"><span class="string">stopsignal=QUIT               ; signal used to kill process (default TERM)</span></span><br><span class="line"><span class="string">stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)</span></span><br><span class="line"><span class="string">user=root                     ; setuid to this UNIX account to run the program</span></span><br><span class="line"><span class="string">redirect_stderr=true          ; redirect proc stderr to stdout (default false)</span></span><br><span class="line"><span class="string">stdout_logfile=/var/log/grafana/grafana.log        ; stdout log path, NONE for none; default AUTO</span></span><br><span class="line"><span class="string">stdout_logfile_maxbytes=50MB  ; max # logfile bytes b4 rotation (default 50MB)</span></span><br><span class="line"><span class="string">stdout_logfile_backups=10     ; # of stdout logfile backups (default 10)</span></span><br><span class="line"><span class="string">stdout_capture_maxbytes=1MB   ; number of bytes in &#x27;capturemode&#x27; (default 0)</span></span><br><span class="line"><span class="string">stdout_events_enabled=false   ; emit events on stdout writes (default false)</span></span><br><span class="line"><span class="string">environment=A=1,B=2           ; process environment additions (def no adds)</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt; prometheus.ini</span></span><br><span class="line"><span class="string">[program:prometheus]</span></span><br><span class="line"><span class="string">command=/data/moni/prometheus/prometheus --storage.tsdb.retention.time=30d --storage.tsdb.path=&quot;/data/moni/prometheus/data&quot;</span></span><br><span class="line"><span class="string">directory=/data/moni/prometheus        ; directory to cwd to before exec (def no cwd)</span></span><br><span class="line"><span class="string">umask=022                     ; umask for process (default None)</span></span><br><span class="line"><span class="string">priority=999                  ; the relative start priority (default 999)</span></span><br><span class="line"><span class="string">autostart=true                ; start at supervisord start (default: true)</span></span><br><span class="line"><span class="string">autorestart=true              ; retstart at unexpected quit (default: true)</span></span><br><span class="line"><span class="string">startsecs=1                   ; number of secs prog must stay running (def. 1)</span></span><br><span class="line"><span class="string">startretries=3                ; max # of serial start failures (default 3)</span></span><br><span class="line"><span class="string">exitcodes=0,2                 ; &#x27;expected&#x27; exit codes for process (default 0,2)</span></span><br><span class="line"><span class="string">stopsignal=QUIT               ; signal used to kill process (default TERM)</span></span><br><span class="line"><span class="string">stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)</span></span><br><span class="line"><span class="string">user=root                     ; setuid to this UNIX account to run the program</span></span><br><span class="line"><span class="string">redirect_stderr=true          ; redirect proc stderr to stdout (default false)</span></span><br><span class="line"><span class="string">stdout_logfile=/var/log/prometheus/prometheus.log        ; stdout log path, NONE for none; default AUTO</span></span><br><span class="line"><span class="string">stdout_logfile_maxbytes=50MB  ; max # logfile bytes b4 rotation (default 50MB)</span></span><br><span class="line"><span class="string">stdout_logfile_backups=10     ; # of stdout logfile backups (default 10)</span></span><br><span class="line"><span class="string">stdout_capture_maxbytes=1MB   ; number of bytes in &#x27;capturemode&#x27; (default 0)</span></span><br><span class="line"><span class="string">stdout_events_enabled=false   ; emit events on stdout writes (default false)</span></span><br><span class="line"><span class="string">environment=A=1,B=2           ; process environment additions (def no adds)</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><h3 id="supervisor启动"><a href="#supervisor启动" class="headerlink" title="supervisor启动"></a>supervisor启动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /var/log/&#123;alertmanager,consul,prometheus,dingtalk,grafana&#125;</span><br><span class="line"><span class="built_in">mkdir</span> -p /etc/consul.d</span><br><span class="line"><span class="built_in">cp</span> *.ini /etc/supervisord.d/</span><br><span class="line"><span class="built_in">cp</span> supervisord.conf /etc</span><br><span class="line"></span><br><span class="line">systemctl <span class="built_in">enable</span> supervisord</span><br><span class="line">systemctl restart supervisord</span><br><span class="line"></span><br><span class="line"><span class="built_in">sleep</span> 2</span><br><span class="line">supervisorctl status </span><br></pre></td></tr></table></figure><h3 id="prometheus配置"><a href="#prometheus配置" class="headerlink" title="prometheus配置"></a>prometheus配置</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">global:</span><br><span class="line">  scrape_interval: 15s </span><br><span class="line">  evaluation_interval: 15s </span><br><span class="line"></span><br><span class="line">alerting:</span><br><span class="line">  alertmanagers:</span><br><span class="line">  - static_configs:</span><br><span class="line">    - targets:</span><br><span class="line">      - &quot;localhost:9093&quot;</span><br><span class="line"></span><br><span class="line">rule_files:</span><br><span class="line">     - &quot;/data/moni/prometheus/rules/*&quot;</span><br><span class="line"></span><br><span class="line">scrape_configs:</span><br><span class="line">  - job_name: &quot;prometheus&quot;</span><br><span class="line">    static_configs:</span><br><span class="line">      - targets: <span class="section">[&quot;localhost:9090&quot;]</span></span><br><span class="line"></span><br><span class="line">  - job_name: &quot;alertmanager&quot;</span><br><span class="line">    static_configs:</span><br><span class="line">    - targets: <span class="section">[&quot;localhost:9093&quot;]</span></span><br><span class="line"></span><br><span class="line">  - job_name: &quot;doris_job&quot;</span><br><span class="line">    static_configs:</span><br><span class="line">      - targets: <span class="section">[&#x27;hy-bigdata-01:18030&#x27;, &#x27;hy-bigdata-02:18030&#x27;, &#x27;hy-bigdata-03:18030&#x27;]</span></span><br><span class="line">        labels:</span><br><span class="line">          group: fe</span><br><span class="line"></span><br><span class="line">      - targets: <span class="section">[&#x27;hy-bigdata-01:18040&#x27;, &#x27;hy-bigdata-02:18040&#x27;, &#x27;hy-bigdata-03:18040&#x27;]</span></span><br><span class="line">        labels:</span><br><span class="line">          group: be</span><br><span class="line"></span><br><span class="line"><span class="comment">#  - job_name: &quot;pushgateway&quot;</span></span><br><span class="line"><span class="comment">#    honor_labels: true</span></span><br><span class="line"><span class="comment">#    static_configs:</span></span><br><span class="line"><span class="comment">#    - targets: [&#x27;10.9.127.245:9091&#x27;]</span></span><br><span class="line"><span class="comment">#      labels:</span></span><br><span class="line"><span class="comment">#        instance: pushgateway</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#  - job_name: &quot;java_jvm&quot;</span></span><br><span class="line"><span class="comment">#    static_configs:</span></span><br><span class="line"><span class="comment">#      - targets: [&#x27;10.9.127.245:8848&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  - job_name: &quot;java-jmx-monitor&quot;</span></span><br><span class="line"><span class="comment">#    static_configs:</span></span><br><span class="line"><span class="comment">#      - targets: [&#x27;10.249.2.51:3010&#x27;]</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  - job_name: &quot;davinci_monitor&quot;</span></span><br><span class="line"><span class="comment">#    metrics_path: /prometheus </span></span><br><span class="line"><span class="comment">#    static_configs: </span></span><br><span class="line"><span class="comment">#      - targets: [&#x27;10.249.2.50:14399&#x27;]</span></span><br><span class="line"></span><br><span class="line">  - job_name: &#x27;consul_sd_node_exporter&#x27;</span><br><span class="line">    metrics_path: /metrics</span><br><span class="line">    honor_labels: false</span><br><span class="line">    consul_sd_configs:</span><br><span class="line">      - server: &#x27;localhost:8500&#x27;</span><br><span class="line">        scheme: http</span><br><span class="line">        services: <span class="section">[&#x27;node_exporter&#x27;]</span></span><br><span class="line">    relabel_configs:                        <span class="comment">#根据实际监控所需添加label，并在注册时注册</span></span><br><span class="line">    - source_labels: <span class="section">[&#x27;__meta_consul_bzl&#x27;]</span>   <span class="comment"># datacenter，会显示注册到的consul的datacenter</span></span><br><span class="line">      target_label: &#x27;bgy&#x27;</span><br><span class="line">    - source_labels: <span class="section">[&#x27;__meta_consul_service_address&#x27;]</span></span><br><span class="line">      target_label: &#x27;host&#x27;</span><br><span class="line">    - source_labels: <span class="section">[&#x27;__meta_consul_service_metadata_hostname&#x27;]</span></span><br><span class="line">      target_label: &#x27;hostname&#x27;</span><br><span class="line">    - source_labels: <span class="section">[&#x27;__meta_consul_service_metadata_business&#x27;]</span></span><br><span class="line">      target_label: &#x27;business&#x27;</span><br><span class="line"></span><br><span class="line">  - job_name: &#x27;sa_process_exporter&#x27;</span><br><span class="line">    scrape_interval: 10s</span><br><span class="line">    honor_labels: false</span><br><span class="line">    consul_sd_configs:</span><br><span class="line">      - server: &#x27;localhost:8500&#x27;</span><br><span class="line">        scheme: http</span><br><span class="line">        services: <span class="section">[&#x27;process_exporter&#x27;]</span></span><br><span class="line">    relabel_configs:</span><br><span class="line">    - source_labels: <span class="section">[&#x27;__meta_consul_service_address&#x27;]</span></span><br><span class="line">      target_label: &#x27;host&#x27;</span><br><span class="line">    - source_labels: <span class="section">[&#x27;__meta_consul_service_metadata_hostname&#x27;]</span></span><br><span class="line">      target_label: &#x27;hostname&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="告警配置"><a href="#告警配置" class="headerlink" title="告警配置"></a>告警配置</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line">groups:</span><br><span class="line">- name: defaultStatsAlert</span><br><span class="line">  rules:</span><br><span class="line">  - alert: cpuUsageAlert</span><br><span class="line">    expr: (100 - (avg by (instance,hostname,hosttype,responsibility)(irate(node_cpu_seconds_total&#123;<span class="attr">job</span>=<span class="string">&quot;consul_sd_node_exporter&quot;</span>,mode=<span class="string">&quot;idle&quot;</span>&#125;[<span class="number">3</span>m])) * <span class="number">100</span>)) &gt; <span class="number">95</span></span><br><span class="line">    for: 10m</span><br><span class="line">    labels:</span><br><span class="line">      team: node</span><br><span class="line">      organization: ops </span><br><span class="line"><span class="comment">#    labels:</span></span><br><span class="line"><span class="comment">#      severity: page</span></span><br><span class="line">    annotations:</span><br><span class="line">      summary: &quot;&#123;&#123; $labels.host &#125;&#125; CPU usgae high&quot;</span><br><span class="line">      description: &quot;&#123;&#123; $labels.host &#125;&#125; CPU usage above 95% (current value: &#123;&#123; $value &#125;&#125;)&quot;</span><br><span class="line"></span><br><span class="line">  - alert: cpuIOwaitAlert    </span><br><span class="line">    expr: (avg by (hostname,instance,hosttype,responsibility)(irate(node_cpu_seconds_total&#123;<span class="attr">business</span>=~<span class="string">&#x27;bzl|aws|hy&#x27;</span>,job=<span class="string">&quot;consul_sd_node_exporter&quot;</span>,mode=<span class="string">&quot;iowait&quot;</span>&#125;[<span class="number">3</span>m])) * <span class="number">100</span>) &gt; <span class="number">45</span></span><br><span class="line">    for: 10m</span><br><span class="line">    labels:</span><br><span class="line">      team: node</span><br><span class="line">      organization: ops</span><br><span class="line">    annotations:</span><br><span class="line">      summary: &quot;&#123;&#123; $labels.instance &#125;&#125; CPU iowait high&quot;</span><br><span class="line">      description: &quot;&#123;&#123; $labels.host &#125;&#125; CPU iowait above 45% (current value: &#123;&#123; $value &#125;&#125;)&quot;</span><br><span class="line"></span><br><span class="line">  - alert: sysLoadAlert</span><br><span class="line">    expr: sum by(hostname, instance,business,hosttype,responsibility) (node_load5&#123;<span class="attr">job</span>=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125;) / count by(hostname, instance,business,hosttype,responsibility) (count by(cpu, hostname, instance,business,hosttype,responsibility) (node_cpu_seconds_total&#123;job=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125;)) &gt; <span class="number">3.85</span> </span><br><span class="line">    for: 10m</span><br><span class="line">    labels:</span><br><span class="line">      team: node</span><br><span class="line">      organization: ops</span><br><span class="line">    annotations:</span><br><span class="line">    <span class="comment">#  summary: &quot;&#123;&#123; $labels.instance &#125;&#125; CPU usgae high&quot;</span></span><br><span class="line">      <span class="comment">#description: &quot;&#123;&#123; $labels.host &#125;&#125; CPU load1m is greater than cpu core number for 1min(current value: &#123;&#123; $value &#125;&#125;)&quot;</span></span><br><span class="line">      description: &quot;&#123;&#123; $labels.host &#125;&#125; CPU load5m is greater than cpu core number(current value: cpu 核数的&#123;&#123; $value &#125;&#125;倍 )&quot;</span><br><span class="line"></span><br><span class="line">  - alert: sys-time-Alert    </span><br><span class="line">    expr: time() - node_time_seconds&#123;<span class="attr">job</span>=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125; &gt; <span class="number">125</span></span><br><span class="line">    for: 10m</span><br><span class="line">    labels:</span><br><span class="line">      team: node</span><br><span class="line">      organization: ops</span><br><span class="line">    annotations:</span><br><span class="line">      description: &quot;&#123;&#123; $labels.host &#125;&#125; system time is inconsistent (current value: &#123;&#123; $value &#125;&#125;s)&quot;</span><br><span class="line">  - alert: sys-time-Alert1    </span><br><span class="line">    expr: time() - node_time_seconds&#123;<span class="attr">job</span>=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125; &lt; -<span class="number">125</span> </span><br><span class="line">    for: 10m</span><br><span class="line">    labels:</span><br><span class="line">      team: node</span><br><span class="line">      organization: ops</span><br><span class="line">    annotations:</span><br><span class="line">      description: &quot;&#123;&#123; $labels.host &#125;&#125; system time is inconsistent (current value: &#123;&#123; $value &#125;&#125;s)&quot;</span><br><span class="line"></span><br><span class="line">  - alert: memUsageAlert</span><br><span class="line">    <span class="comment">#expr: ((node_memory_MemTotal_bytes&#123;job=&quot;consul_sd_node_exporter&quot;&#125; - (node_memory_MemAvailable_bytes&#123;job=&quot;consul_sd_node_exporter&quot;&#125;))/node_memory_MemTotal_bytes&#123;job=&quot;consul_sd_node_exporter&quot;&#125;) * 100 &gt; 90</span></span><br><span class="line">    expr: ((node_memory_MemTotal_bytes&#123;<span class="attr">job</span>=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125; - (node_memory_MemFree_bytes&#123;job=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125;+node_memory_Buffers_bytes&#123;job=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125;+node_memory_Cached_bytes&#123;job=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125;+node_memory_SReclaimable_bytes&#123;job=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125;))/node_memory_MemTotal_bytes&#123;job=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125;) * <span class="number">100</span> &gt; <span class="number">95</span></span><br><span class="line">    for: 15m</span><br><span class="line">    labels:</span><br><span class="line">      team: mem</span><br><span class="line">      organization: ops</span><br><span class="line"><span class="comment">#    labels:</span></span><br><span class="line"><span class="comment">#      severity: page</span></span><br><span class="line">    annotations:</span><br><span class="line">      summary: &quot;&#123;&#123; $labels.host &#125;&#125; MEM usgae high&quot;</span><br><span class="line">      description: &quot;&#123;&#123; $labels.host &#125;&#125; MEM usage above 95% (current value: &#123;&#123; $value &#125;&#125;)&quot;</span><br><span class="line"></span><br><span class="line">  - alert: NodeDown</span><br><span class="line">    expr: up&#123;<span class="attr">job</span>=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125; == <span class="number">0</span></span><br><span class="line">    for: 5m</span><br><span class="line">    labels:</span><br><span class="line">      team: down</span><br><span class="line">      organization: ops</span><br><span class="line"><span class="comment">#    labels:   可以使用这个label在altermanager中配置match分组</span></span><br><span class="line"><span class="comment">#      team: node</span></span><br><span class="line">    annotations:</span><br><span class="line">      description: &#x27;&#123;&#123; $labels.host&#125;&#125; has been down for 5m&#x27;</span><br><span class="line"></span><br><span class="line">  - alert: disk_utilization_rate</span><br><span class="line">    expr: 100 - ((node_filesystem_avail_bytes&#123;<span class="attr">business</span>=~<span class="string">&#x27;bzl|aws|hy&#x27;</span>,fstype!~<span class="string">&quot;rootfs|selinuxfs|autofs|rpc_pipefs|tmpfs|fuse.lxcfs|iso9660&quot;</span>,mountpoint!~<span class="string">&quot;/boot&quot;</span>,job=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125; * <span class="number">100</span>) / node_filesystem_size_bytes &#123;business=~<span class="string">&#x27;bzl|aws|hy&#x27;</span>,fstype!~<span class="string">&quot;rootfs|selinuxfs|autofs|rpc_pipefs|tmpfs|fuse.lxcfs|iso9660&quot;</span>,mountpoint!~<span class="string">&quot;/boot&quot;</span>,job=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125;) &gt; <span class="number">80</span></span><br><span class="line">    for: 10m</span><br><span class="line">    labels:</span><br><span class="line">      team: disk</span><br><span class="line">      organization: ops</span><br><span class="line">    annotations:</span><br><span class="line">      description: &#x27;&#123;&#123;$labels.host&#125;&#125; &#123;&#123;$labels.mountpoint&#125;&#125; excess 90% --&gt; &#123;&#123;$value&#125;&#125;&#x27;</span><br><span class="line"></span><br><span class="line">  - alert: network_receive_bytes</span><br><span class="line">    expr: irate(node_network_receive_bytes_total&#123;<span class="attr">business</span>=~<span class="string">&#x27;bzl|aws|hy&#x27;</span>,device!~<span class="string">&#x27;tap.*|veth.*|br.*|docker.*|virbr*|lo*|eth*|eno*&#x27;</span>,job=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125;[<span class="number">15</span>m])*<span class="number">8</span>/<span class="number">1024</span>/<span class="number">1024</span> &gt; <span class="number">1000</span></span><br><span class="line">    for: 5m</span><br><span class="line">    labels:</span><br><span class="line">      team: node</span><br><span class="line">      organization: ops</span><br><span class="line">    annotations:</span><br><span class="line">      description: &#x27;&#123;&#123;$labels.host&#125;&#125; network receive bytes reach to &#123;&#123;$value&#125;&#125; MB/s&#x27;</span><br><span class="line"></span><br><span class="line">  - alert: network_transmit_bytes</span><br><span class="line">    expr: irate(node_network_transmit_bytes_total&#123;<span class="attr">business</span>=~<span class="string">&#x27;bzl|aws|hy&#x27;</span>,device!~<span class="string">&#x27;tap.*|veth.*|br.*|docker.*|virbr*|lo*|eth*|eno*&#x27;</span>,job=<span class="string">&quot;consul_sd_node_exporter&quot;</span>&#125;[<span class="number">15</span>m])*<span class="number">8</span>/<span class="number">1024</span>/<span class="number">1024</span> &gt; <span class="number">1000</span></span><br><span class="line">    for: 5m</span><br><span class="line">    labels:</span><br><span class="line">      team: node</span><br><span class="line">      organization: ops</span><br><span class="line">    annotations:</span><br><span class="line">      description: &#x27;&#123;&#123;$labels.host&#125;&#125; network transmit bytes reach to &#123;&#123;$value&#125;&#125; MB/s&#x27;</span><br><span class="line"></span><br><span class="line">  - alert: frame-alert</span><br><span class="line">    expr: node_network_receive_frame_total&#123;device!~&quot;tap.*|veth.*|br.*|docker.*|virbr*|lo*&quot;&#125; - min_over_time(node_network_receive_frame_total&#123;device!~&quot;tap.*|veth.*|br.*|docker.*|virbr*|lo*&quot;&#125;<span class="section">[1h]</span>) &gt;= 5 </span><br><span class="line">    for: 10s</span><br><span class="line">    labels:</span><br><span class="line">      team: node </span><br><span class="line">      organization: ops</span><br><span class="line">    annotations:</span><br><span class="line">      description: &#x27;&#123;&#123;$labels.host&#125;&#125; network frame growth &#123;&#123;$value&#125;&#125;&#x27;</span><br><span class="line"></span><br><span class="line">  - alert: time_zone-alert</span><br><span class="line">    expr: time_zone&#123;tz!=&quot;CST&quot;&#125; == 0 </span><br><span class="line">    for: 10s</span><br><span class="line">    labels:</span><br><span class="line">      team: node </span><br><span class="line">      organization: ops</span><br><span class="line">    annotations:</span><br><span class="line">      description: &#x27;&#123;&#123;$labels.host&#125;&#125; time zone is not CST&#x27;</span><br><span class="line"></span><br><span class="line"><span class="comment">#  - alert: doris_node-alert</span></span><br><span class="line"><span class="comment">#    expr: sum(up&#123;job=~&quot;doris_job|davinci_monitor&quot;&#125;) by (group,job,instance) &lt; 1</span></span><br><span class="line"><span class="comment">#    for: 10s</span></span><br><span class="line"><span class="comment">#    labels:</span></span><br><span class="line"><span class="comment">#      team: node</span></span><br><span class="line"><span class="comment">#      organization: bigdata</span></span><br><span class="line"><span class="comment">#    annotations:</span></span><br><span class="line"><span class="comment">#      description: &#x27;&#123;&#123;$labels.job&#125;&#125; &#123;&#123;$labels.group&#125;&#125; 的节点&#123;&#123;$labels.instance&#125;&#125; 发生异常!!!!&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">groups:</span><br><span class="line">  - name: rocketmq-delay</span><br><span class="line">    rules:</span><br><span class="line">      - alert: rocketmq-delay warning1</span><br><span class="line">        expr: rocketmq_group_diff&#123;<span class="attr">topic</span>=<span class="string">&quot;machine_work_log&quot;</span>,group=<span class="string">&quot;machine_work_log_roketmq2doris&quot;</span>&#125; &gt;<span class="number">2000</span></span><br><span class="line">        for: 20s</span><br><span class="line">        labels:</span><br><span class="line">          group: bigdata</span><br><span class="line">          severity: bigdata</span><br><span class="line">        annotations:</span><br><span class="line">          description: Topic：&#123;&#123;$labels.topic&#125;&#125; , Group：&#123;&#123;$labels.group&#125;&#125; 出现积压，积压量为：&#123;&#123;$value&#125;&#125;</span><br><span class="line">      - alert: rocketmq-delay warning2</span><br><span class="line">        expr: rocketmq_group_diff&#123;<span class="attr">topic</span>=<span class="string">&quot;pro_canal_producer&quot;</span>,group=<span class="string">&quot;pro_canal_producer_roketmq2doris&quot;</span>&#125; &gt;<span class="number">10</span></span><br><span class="line">        for: 20s</span><br><span class="line">        labels:</span><br><span class="line">          group: bigdata</span><br><span class="line">          severity: bigdata</span><br><span class="line">        annotations:</span><br><span class="line">          description: Topic：&#123;&#123;$labels.topic&#125;&#125; , Group：&#123;&#123;$labels.group&#125;&#125; 出现积压，积压量为：&#123;&#123;$value&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">groups:</span><br><span class="line">  - name: doris_instance_down</span><br><span class="line">    rules:</span><br><span class="line">      - alert: Doris Backends Down</span><br><span class="line">        expr: up &#123;<span class="attr">group</span>=<span class="string">&quot;be&quot;</span>, job=<span class="string">&quot;doris_job&quot;</span>&#125; == <span class="number">0</span></span><br><span class="line">        for: 20s</span><br><span class="line">        labels:</span><br><span class="line">          user: doris</span><br><span class="line">          severity: bigdata</span><br><span class="line">        annotations:</span><br><span class="line">          summary: &quot;doris Instance &#123;&#123; $labels.instance &#125;&#125; down&quot;</span><br><span class="line">          description: &quot;doris &#123;&#123; $labels.instance &#125;&#125; of job &#123;&#123; $labels.job &#125;&#125; has been down for more than 20s.&quot;</span><br><span class="line">      - alert: Doris Frontends Down</span><br><span class="line">        expr: up &#123;<span class="attr">group</span>=<span class="string">&quot;fe&quot;</span>, job=<span class="string">&quot;doris_job&quot;</span>&#125; == <span class="number">0</span></span><br><span class="line">        for: 20s</span><br><span class="line">        labels:</span><br><span class="line">          user: doris</span><br><span class="line">          severity: bigdata</span><br><span class="line">        annotations:</span><br><span class="line">          summary: &quot;doris Instance &#123;&#123; $labels.instance &#125;&#125; down&quot;</span><br><span class="line">          description: &quot;doris &#123;&#123; $labels.instance &#125;&#125; of job &#123;&#123; $labels.job &#125;&#125; has been down for more than 20s.&quot;</span><br></pre></td></tr></table></figure><h3 id="alertmanage配置"><a href="#alertmanage配置" class="headerlink" title="alertmanage配置"></a>alertmanage配置</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">global: </span><br><span class="line">  resolve_timeout: 5m <span class="comment">#处理超时时间，默认为5min</span></span><br><span class="line">  smtp_smarthost: &#x27;smtp.139.com:465&#x27; <span class="comment"># 邮箱smtp服务器代理</span></span><br><span class="line">  smtp_from: &#x27;xxxxxx@139.com&#x27; <span class="comment"># 发送邮箱名称</span></span><br><span class="line">  smtp_auth_username: &#x27;xxxxx@139.com&#x27; <span class="comment"># 邮箱名称</span></span><br><span class="line">  smtp_auth_password: &#x27;xxxxxxxxx&#x27; <span class="comment"># 邮箱密码或授权码</span></span><br><span class="line">  smtp_require_tls: false</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义模板信心</span></span><br><span class="line">templates:</span><br><span class="line">  - &#x27;/opt/alertmanager/templates/*&#x27;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义路由树信息</span></span><br><span class="line">route:</span><br><span class="line">  receiver: &#x27;ops&#x27; <span class="comment"># 发送警报的接收者的名称，以下receivers name的名称</span></span><br><span class="line">  group_by: <span class="section">[&#x27;alertname&#x27;]</span> <span class="comment"># 报警分组依据</span></span><br><span class="line">  group_wait: 1s <span class="comment"># 最初即第一次等待多久时间发送一组警报的通知</span></span><br><span class="line">  group_interval: 10s <span class="comment"># 在发送新警报前的等待时间</span></span><br><span class="line">  repeat_interval: 1h <span class="comment"># 发送重复警报的周期 对于email配置中，此项不可以设置过低，否则将会由于邮件发送太多频繁，被smtp服务器拒绝</span></span><br><span class="line">  routes:</span><br><span class="line">  - receiver: &#x27;bigdata&#x27;</span><br><span class="line">    group_wait: 10s</span><br><span class="line">    match_re:</span><br><span class="line">       severity: bigdata</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 定义警报接收者信息</span></span><br><span class="line">receivers:</span><br><span class="line">  - name: &#x27;ops&#x27; <span class="comment"># 警报</span></span><br><span class="line"><span class="comment">#    email_configs: # 邮箱配置</span></span><br><span class="line"><span class="comment">#    - to: &#x27;chenyuhua37@countrygarden.com.cn,luminfeng01@countrygarden.com.cn,liangwenjun04@countrygarden.com.cn,maiqixian@countrygarden.com.cn,15121486557@163.com&#x27;  # 接收警报的email配置</span></span><br><span class="line"><span class="comment">#      send_resolved: true</span></span><br><span class="line"><span class="comment">#      headers:</span></span><br><span class="line"><span class="comment">#        subject: &quot;AWS-Prometheus报警邮件&quot;</span></span><br><span class="line"><span class="comment">#        from : &quot;Prometheus监控告警&quot;</span></span><br><span class="line"><span class="comment">#        to: &quot;You,Please pay attention!!!&quot;</span></span><br><span class="line">    webhook_configs:</span><br><span class="line">    - url: &#x27;http://localhost:8860/dingtalk/webhook1/send&#x27; </span><br><span class="line">      send_resolved: true</span><br><span class="line">  - name: &#x27;bigdata&#x27;</span><br><span class="line">    webhook_configs:</span><br><span class="line"><span class="comment">#    - url: &#x27;http://localhost:18060/dingtalk/webhook_bigdata/send&#x27;</span></span><br><span class="line">    - url: &#x27;http://localhost:8860/dingtalk/webhook1/send&#x27; </span><br><span class="line">      send_resolved: true</span><br><span class="line"></span><br><span class="line"><span class="comment"># 一个inhibition规则是在与另一组匹配器匹配的警报存在的条件下，使匹配一组匹配器的警报失效的规则。两个警报必须具有一组相同的标签。 </span></span><br><span class="line">inhibit_rules: </span><br><span class="line">  - source_match: </span><br><span class="line">     severity: &#x27;critical&#x27; </span><br><span class="line">    target_match: </span><br><span class="line">     severity: &#x27;warning&#x27; </span><br><span class="line">    equal: <span class="section">[&#x27;alertname&#x27;, &#x27;dev&#x27;, &#x27;instance&#x27;]</span></span><br></pre></td></tr></table></figure><h3 id="钉钉配置"><a href="#钉钉配置" class="headerlink" title="钉钉配置"></a>钉钉配置</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">templates:</span><br><span class="line">   - dingding.tmpl</span><br><span class="line"></span><br><span class="line">targets:</span><br><span class="line">  webhook1:</span><br><span class="line">    url: https://oapi.dingtalk.com/robot/send?<span class="attr">access_token</span>=<span class="number">8</span>cd8f7502c148fa63a7ad9e424731f83022841eab80c81d476e8000f36d5143a</span><br><span class="line">    <span class="comment"># secret for signature</span></span><br><span class="line">    secret: SEC000000000000000000000</span><br><span class="line">  webhook2:</span><br><span class="line">          url: https://oapi.dingtalk.com/robot/send?<span class="attr">access_token</span>=<span class="number">8</span>cd8f7502c148fa63a7ad9e424731f83022841eab80c81d476e8000f36d5143a</span><br><span class="line">  webhook_legacy:</span><br><span class="line">          url: https://oapi.dingtalk.com/robot/send?<span class="attr">access_token</span>=<span class="number">8</span>cd8f7502c148fa63a7ad9e424731f83022841eab80c81d476e8000f36d5143a</span><br><span class="line">  bigdta_webhook:</span><br><span class="line">          url: https://oapi.dingtalk.com/robot/send?<span class="attr">access_token</span>=<span class="number">8</span>cd8f7502c148fa63a7ad9e424731f83022841eab80c81d476e8000f36d5143a</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Prometheus-安装配置&quot;&gt;&lt;a href=&quot;#Prometheus-安装配置&quot; class=&quot;headerlink&quot; title=&quot;Prometheus-安装配置&quot;&gt;&lt;/a&gt;Prometheus-安装配置&lt;/h2&gt;&lt;h3 id=&quot;supervisor安装&quot;</summary>
      
    
    
    
    <category term="监控" scheme="https://biglovewheat.gihub.io/categories/%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="prometheus" scheme="https://biglovewheat.gihub.io/tags/prometheus/"/>
    
  </entry>
  
  <entry>
    <title>Linux-Centos7-升级内核</title>
    <link href="https://biglovewheat.gihub.io/2023/08/07/linux-centos7-%E5%8D%87%E7%BA%A7%E5%86%85%E6%A0%B8/"/>
    <id>https://biglovewheat.gihub.io/2023/08/07/linux-centos7-%E5%8D%87%E7%BA%A7%E5%86%85%E6%A0%B8/</id>
    <published>2023-08-06T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Linux-Centos7-升级内核"><a href="#Linux-Centos7-升级内核" class="headerlink" title="Linux-Centos7-升级内核"></a>Linux-Centos7-升级内核</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 查看当前内核</span></span><br><span class="line"><span class="built_in">uname</span> -r</span><br><span class="line"></span><br><span class="line"><span class="comment">## 安装epel仓库</span></span><br><span class="line">yum install https://www.elrepo.org/elrepo-release-7.el7.elrepo.noarch.rpm -y</span><br><span class="line"></span><br><span class="line"><span class="comment">## 安装最新长期支持内核</span></span><br><span class="line">yum --enablerepo=elrepo-kernel install kernel-lt-devel kernel-lt -y</span><br><span class="line"></span><br><span class="line"><span class="comment">## 设置默认启动内核</span></span><br><span class="line">awk -F\<span class="string">&#x27; &#x27;</span><span class="variable">$1</span>==<span class="string">&quot;menuentry &quot;</span> &#123;<span class="built_in">print</span> i++ <span class="string">&quot; &quot;</span><span class="variable">$2</span>&#125;<span class="string">&#x27; /etc/grub2.cfg</span></span><br><span class="line"><span class="string">grub2-set-default 0</span></span><br><span class="line"><span class="string">grub2-mkconfig -o /boot/grub2/grub.cfg</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## 重启操作系统</span></span><br><span class="line"><span class="string">reboot</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## 再次查看内核</span></span><br><span class="line"><span class="string">uname -r</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Linux-Centos7-升级内核&quot;&gt;&lt;a href=&quot;#Linux-Centos7-升级内核&quot; class=&quot;headerlink&quot; title=&quot;Linux-Centos7-升级内核&quot;&gt;&lt;/a&gt;Linux-Centos7-升级内核&lt;/h2&gt;&lt;figure c</summary>
      
    
    
    
    <category term="linux" scheme="https://biglovewheat.gihub.io/categories/linux/"/>
    
    
    <category term="linux" scheme="https://biglovewheat.gihub.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>Linux-sed替换</title>
    <link href="https://biglovewheat.gihub.io/2023/08/07/linux-sed%E6%9B%BF%E6%8D%A2/"/>
    <id>https://biglovewheat.gihub.io/2023/08/07/linux-sed%E6%9B%BF%E6%8D%A2/</id>
    <published>2023-08-06T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Linux-sed替换"><a href="#Linux-sed替换" class="headerlink" title="Linux-sed替换"></a>Linux-sed替换</h2><h3 id="使用竖线方式替换包含特殊字符的文本"><a href="#使用竖线方式替换包含特殊字符的文本" class="headerlink" title="使用竖线方式替换包含特殊字符的文本"></a>使用竖线方式替换包含特殊字符的文本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s|161.189.150.102:9876|mq.farmbgy.net:9876|g&#x27;</span> *</span><br><span class="line">sed -i <span class="string">&#x27;s|172.31.40.27:9876|mq.farmbgy.net:9876|g&#x27;</span> *</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Linux-sed替换&quot;&gt;&lt;a href=&quot;#Linux-sed替换&quot; class=&quot;headerlink&quot; title=&quot;Linux-sed替换&quot;&gt;&lt;/a&gt;Linux-sed替换&lt;/h2&gt;&lt;h3 id=&quot;使用竖线方式替换包含特殊字符的文本&quot;&gt;&lt;a href=&quot;#</summary>
      
    
    
    
    <category term="linux" scheme="https://biglovewheat.gihub.io/categories/linux/"/>
    
    
    <category term="linux" scheme="https://biglovewheat.gihub.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>Keepalived-出现双ip问题</title>
    <link href="https://biglovewheat.gihub.io/2023/08/07/lvs-keepalived-%E5%87%BA%E7%8E%B0%E5%8F%8Cip%E9%97%AE%E9%A2%98/"/>
    <id>https://biglovewheat.gihub.io/2023/08/07/lvs-keepalived-%E5%87%BA%E7%8E%B0%E5%8F%8Cip%E9%97%AE%E9%A2%98/</id>
    <published>2023-08-06T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Keepalived-出现双ip问题"><a href="#Keepalived-出现双ip问题" class="headerlink" title="Keepalived-出现双ip问题"></a>Keepalived-出现双ip问题</h2><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>可能是上联交换机禁用了arp的广播限制，造成keepalive无法通过广播通信，两台服务器抢占vip，出现同时都有vip的情况</p><h3 id="解决过程"><a href="#解决过程" class="headerlink" title="解决过程"></a>解决过程</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 主机，发现向224.0.0.18发送消息</span></span><br><span class="line">tcpdump -i eth0 vrrp -n</span><br><span class="line"></span><br><span class="line"><span class="comment">## 备机，也在向224.0.0.18发送消息，正常情况下，备节点如果收到主节点的心跳消息时，优先级高于自己，就不会主动对外发送消息</span></span><br><span class="line">tcpdump -i eth0 vrrp -n</span><br><span class="line"></span><br><span class="line"><span class="comment">## 原因：上联交换机禁用了arp的广播限制，造成keepalive无法通过广播通信，两台服务器抢占vip，出现同时都有vip的情况</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 解决办法：多播改为单播，重启keepalived</span></span><br></pre></td></tr></table></figure><h3 id="主机配置"><a href="#主机配置" class="headerlink" title="主机配置"></a>主机配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">! Configuration File <span class="keyword">for</span> keepalived</span><br><span class="line"></span><br><span class="line">global_defs &#123;</span><br><span class="line">  router_id NGINX</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">    state MASTER</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 17</span><br><span class="line"><span class="comment">#多播    mcast_src_ip 10.77.114.150</span></span><br><span class="line">    unicast_src_ip 10.77.114.150</span><br><span class="line">    unicast_peer &#123;</span><br><span class="line">    10.77.114.151 <span class="comment">#指向对方主机IP 如果有多个keepalived,再下面加其它节点的IP</span></span><br><span class="line">    &#125;</span><br><span class="line">    priority 150</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass hykj</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        10.77.114.130</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="备机配置"><a href="#备机配置" class="headerlink" title="备机配置"></a>备机配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">! Configuration File <span class="keyword">for</span> keepalived</span><br><span class="line"></span><br><span class="line">global_defs &#123;</span><br><span class="line">   router_id NGINX</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">    state BACKUP</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 17</span><br><span class="line"><span class="comment">#多播    mcast_src_ip 10.77.114.151</span></span><br><span class="line">    unicast_src_ip 10.77.114.151</span><br><span class="line">    unicast_peer &#123;</span><br><span class="line">        10.77.114.150</span><br><span class="line">    &#125;</span><br><span class="line">    priority 99</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass hykj</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        10.77.114.130</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="keepalived-安装"><a href="#keepalived-安装" class="headerlink" title="keepalived 安装"></a>keepalived 安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y keepalived</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Keepalived-出现双ip问题&quot;&gt;&lt;a href=&quot;#Keepalived-出现双ip问题&quot; class=&quot;headerlink&quot; title=&quot;Keepalived-出现双ip问题&quot;&gt;&lt;/a&gt;Keepalived-出现双ip问题&lt;/h2&gt;&lt;h3 id=&quot;问</summary>
      
    
    
    
    <category term="linux" scheme="https://biglovewheat.gihub.io/categories/linux/"/>
    
    
    <category term="linux" scheme="https://biglovewheat.gihub.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>GitLab-修改IP</title>
    <link href="https://biglovewheat.gihub.io/2023/06/28/gitlab-%E4%BF%AE%E6%94%B9IP/"/>
    <id>https://biglovewheat.gihub.io/2023/06/28/gitlab-%E4%BF%AE%E6%94%B9IP/</id>
    <published>2023-06-27T16:00:00.000Z</published>
    <updated>2023-10-11T13:31:38.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="GitLab-修改IP"><a href="#GitLab-修改IP" class="headerlink" title="GitLab-修改IP"></a>GitLab-修改IP</h2><p><em>机器IP变了，需要重新修改IP</em></p><h3 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 停止gitlab</span></span><br><span class="line">gitlab-ctl stop</span><br><span class="line"></span><br><span class="line">vi /etc/gitlab/gitlab.rb</span><br><span class="line"><span class="comment">## 修改为正确的IP、域名、或端口 ##</span></span><br><span class="line">external_url <span class="string">&#x27;http://10.77.114.100:8690&#x27;</span></span><br><span class="line">nginx[<span class="string">&#x27;listen_port&#x27;</span>] = 8690</span><br><span class="line"></span><br><span class="line"><span class="comment">## 重新配置并启动gitlab</span></span><br><span class="line">gitlab-ctl reconfigure</span><br><span class="line">gitlab-ctl start</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;GitLab-修改IP&quot;&gt;&lt;a href=&quot;#GitLab-修改IP&quot; class=&quot;headerlink&quot; title=&quot;GitLab-修改IP&quot;&gt;&lt;/a&gt;GitLab-修改IP&lt;/h2&gt;&lt;p&gt;&lt;em&gt;机器IP变了，需要重新修改IP&lt;/em&gt;&lt;/p&gt;
&lt;h3 i</summary>
      
    
    
    
    <category term="devops" scheme="https://biglovewheat.gihub.io/categories/devops/"/>
    
    
    <category term="devops" scheme="https://biglovewheat.gihub.io/tags/devops/"/>
    
    <category term="git" scheme="https://biglovewheat.gihub.io/tags/git/"/>
    
  </entry>
  
</feed>
